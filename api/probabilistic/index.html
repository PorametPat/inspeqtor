
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../predefined/">
      
      
        <link rel="next" href="../visualization/">
      
      
      <link rel="icon" href="../../assets/inspeqtor_logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>probabilistic - inspeqtor</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#src.inspeqtor.experimental.probabilistic" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="inspeqtor" class="md-header__button md-logo" aria-label="inspeqtor" data-md-component="logo">
      
  <img src="../../assets/inspeqtor_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            inspeqtor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              probabilistic
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/PorametPat/inspeqtor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="inspeqtor" class="md-nav__button md-logo" aria-label="inspeqtor" data-md-component="logo">
      
  <img src="../../assets/inspeqtor_logo.svg" alt="logo">

    </a>
    inspeqtor
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PorametPat/inspeqtor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/overviews/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overviews
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tutorial_0001_dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataset Creating
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tutorial_0003_cc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Characterization and Calibration using Graybox
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tutorial_0002_control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control Action
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design Decisions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    How-To Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            How-To Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/generate-dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generate dataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/working_memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working memory example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/dnn_to_bnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to convert DNN into BNN
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nnx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nnx
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    constant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    optimize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../physics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    physics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../predefined/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    predefined
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    probabilistic
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    probabilistic
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;probabilistic
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" probabilistic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.LearningModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LearningModel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_probabilistic_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_probabilistic_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.get_args_of_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_args_of_distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.construct_normal_priors" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;construct_normal_priors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.construct_normal_prior_from_samples" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;construct_normal_prior_from_samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_normal_posterior_dist_fn_from_svi_result" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_normal_posterior_dist_fn_from_svi_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_pdf" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_pdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.safe_kl_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;safe_kl_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.kl_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;kl_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.safe_jensenshannon_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;safe_jensenshannon_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.jensenshannon_divergence_from_pmf" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;jensenshannon_divergence_from_pmf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.jensenshannon_divergence_from_sample" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;jensenshannon_divergence_from_sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.batched_matmul" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;batched_matmul
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.get_trace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.default_priors_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;default_priors_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.dense_layer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;dense_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.init_default" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;init_default
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.dense_deterministic_layer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;dense_deterministic_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_posteriors_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_posteriors_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.auto_diagonal_normal_guide" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.auto_diagonal_normal_guide_v2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_predictive_fn_v2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_fn_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_predictive_SGM_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_SGM_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_predictive_MCDGM_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_MCDGM_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_predictive_resampling_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_resampling_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_probabilistic_graybox_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_probabilistic_graybox_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.auto_diagonal_normal_guide_v3" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_posterior_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_posterior_fn
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    visualization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;probabilistic
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" probabilistic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.LearningModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LearningModel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_probabilistic_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_probabilistic_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.get_args_of_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_args_of_distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.construct_normal_priors" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;construct_normal_priors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.construct_normal_prior_from_samples" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;construct_normal_prior_from_samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_normal_posterior_dist_fn_from_svi_result" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_normal_posterior_dist_fn_from_svi_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_pdf" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_pdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.safe_kl_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;safe_kl_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.kl_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;kl_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.safe_jensenshannon_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;safe_jensenshannon_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.jensenshannon_divergence_from_pmf" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;jensenshannon_divergence_from_pmf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.jensenshannon_divergence_from_sample" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;jensenshannon_divergence_from_sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.batched_matmul" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;batched_matmul
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.get_trace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.default_priors_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;default_priors_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.dense_layer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;dense_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.init_default" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;init_default
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.dense_deterministic_layer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;dense_deterministic_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_posteriors_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_posteriors_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.auto_diagonal_normal_guide" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.auto_diagonal_normal_guide_v2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_predictive_fn_v2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_fn_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_predictive_SGM_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_SGM_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_predictive_MCDGM_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_MCDGM_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_predictive_resampling_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_resampling_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_probabilistic_graybox_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_probabilistic_graybox_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.auto_diagonal_normal_guide_v3" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.experimental.probabilistic.make_posterior_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_posterior_fn
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>probabilistic</h1>

<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.experimental.probabilistic" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.experimental.probabilistic</span>


</h2>

    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.experimental.probabilistic.LearningModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">LearningModel</span>


</h3>


    <div class="doc doc-contents ">


        <p>The learning model.</p>







              <details class="quote">
                <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LearningModel</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The learning model.&quot;&quot;&quot;</span>

    <span class="n">TruncatedNormal</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">BernoulliProbs</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_probabilistic_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_probabilistic_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_probabilistic_model</span><span class="p">(</span><span class="n">predictive_model</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n">shots</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">block_graybox</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">separate_observables</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">log_expectation_values</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make probabilistic model from the Statistical model with priors</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>base_model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The statistical based model, currently only support flax.linen module</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_prediction_to_expvals_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to convert output from model to expectation values array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bnn_prior</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="numpyro.distributions.Distribution">Distribution</span>] | <span title="numpyro.distributions.Distribution">Distribution</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The priors of BNN. Defaults to dist.Normal(0.0, 1.0).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shots</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shots forcing PGM to sample. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>block_graybox</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, the latent variables in Graybox model will be hidden, i.e. not traced by <code>numpyro</code>. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enable_bnn</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, the statistical model will be convert to probabilistic model. Defaults to True.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>separate_observables</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, the observable will be separate into dict form. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable: Probabilistic Graybox Model</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">predictive_model</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">block_graybox</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">separate_observables</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">log_expectation_values</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make probabilistic model from the Statistical model with priors</span>

<span class="sd">    Args:</span>
<span class="sd">        base_model (nn.Module): The statistical based model, currently only support flax.linen module</span>
<span class="sd">        model_prediction_to_expvals_fn (typing.Callable[..., jnp.ndarray]): Function to convert output from model to expectation values array</span>
<span class="sd">        bnn_prior (dict[str, dist.Distribution] | dist.Distribution, optional): The priors of BNN. Defaults to dist.Normal(0.0, 1.0).</span>
<span class="sd">        shots (int, optional): The number of shots forcing PGM to sample. Defaults to 1.</span>
<span class="sd">        block_graybox (bool, optional): If true, the latent variables in Graybox model will be hidden, i.e. not traced by `numpyro`. Defaults to False.</span>
<span class="sd">        enable_bnn (bool, optional): If true, the statistical model will be convert to probabilistic model. Defaults to True.</span>
<span class="sd">        separate_observables (bool, optional): If true, the observable will be separate into dict form. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable: Probabilistic Graybox Model</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">block_graybox_fn</span><span class="p">(</span>
        <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">prng_key</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">handlers</span><span class="o">.</span><span class="n">block</span><span class="p">(),</span> <span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rng_seed</span><span class="o">=</span><span class="n">key</span><span class="p">):</span>
            <span class="n">expvals</span> <span class="o">=</span> <span class="n">predictive_model</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">expvals</span>

    <span class="n">graybox_fn</span> <span class="o">=</span> <span class="n">block_graybox_fn</span> <span class="k">if</span> <span class="n">block_graybox</span> <span class="k">else</span> <span class="n">predictive_model</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bernoulli_model</span><span class="p">(</span>
        <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">observables</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">expvals</span> <span class="o">=</span> <span class="n">graybox_fn</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">log_expectation_values</span><span class="p">:</span>
            <span class="n">numpyro</span><span class="o">.</span><span class="n">deterministic</span><span class="p">(</span><span class="s2">&quot;expectation_values&quot;</span><span class="p">,</span> <span class="n">expvals</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">observables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sizes</span> <span class="o">=</span> <span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">18</span><span class="p">,)</span>
            <span class="k">if</span> <span class="n">shots</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sizes</span> <span class="o">=</span> <span class="p">(</span><span class="n">shots</span><span class="p">,)</span> <span class="o">+</span> <span class="n">sizes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sizes</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">shape</span>

        <span class="c1"># The plate is for the shots prediction to work properly</span>
        <span class="k">with</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">optional</span><span class="p">(</span>
            <span class="n">shots</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">plate_stack</span><span class="p">(</span><span class="s2">&quot;plate&quot;</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sizes</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">separate_observables</span><span class="p">:</span>
                <span class="n">expvals_samples</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">default_expectation_values_order</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;obs/</span><span class="si">{</span><span class="n">exp</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">exp</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">dist</span><span class="o">.</span><span class="n">BernoulliProbs</span><span class="p">(</span>
                            <span class="n">probs</span><span class="o">=</span><span class="n">expectation_value_to_prob_minus</span><span class="p">(</span>
                                <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">expvals</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
                            <span class="p">)</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">to_event</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                        <span class="n">obs</span><span class="o">=</span><span class="p">(</span>
                            <span class="n">observables</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="k">if</span> <span class="n">observables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
                        <span class="p">),</span>
                    <span class="p">)</span>

                    <span class="n">expvals_samples</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;obs/</span><span class="si">{</span><span class="n">exp</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">exp</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">expvals_samples</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                    <span class="s2">&quot;obs&quot;</span><span class="p">,</span>
                    <span class="n">dist</span><span class="o">.</span><span class="n">BernoulliProbs</span><span class="p">(</span>
                        <span class="n">probs</span><span class="o">=</span><span class="n">expectation_value_to_prob_minus</span><span class="p">(</span><span class="n">expvals</span><span class="p">)</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">to_event</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">obs</span><span class="o">=</span><span class="n">observables</span><span class="p">,</span>
                    <span class="n">infer</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;enumerate&quot;</span><span class="p">:</span> <span class="s2">&quot;parallel&quot;</span><span class="p">},</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">expvals_samples</span>

    <span class="k">return</span> <span class="n">bernoulli_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.get_args_of_distribution" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_args_of_distribution</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_args_of_distribution</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the arguments used to construct Distribution, if the provided parameter is not Distribution, return it.
So that the function can be used with <code>jax.tree.map</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maybe Distribution</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: Argument of Distribution if Distribution is provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_args_of_distribution</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the arguments used to construct Distribution, if the provided parameter is not Distribution, return it.</span>
<span class="sd">    So that the function can be used with `jax.tree.map`.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (typing.Any): Maybe Distribution</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: Argument of Distribution if Distribution is provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">get_args</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.construct_normal_priors" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">construct_normal_priors</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">construct_normal_priors</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct a dict of Normal Distributions with posterior</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>posterior</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of Normal distribution arguments</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: dict of Normal distributions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span>
<span class="k">def</span><span class="w"> </span><span class="nf">construct_normal_priors</span><span class="p">(</span><span class="n">posterior</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a dict of Normal Distributions with posterior</span>

<span class="sd">    Args:</span>
<span class="sd">        posterior (typing.Any): Dict of Normal distribution arguments</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: dict of Normal distributions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">posterior_distributions</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posterior</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">posterior</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="n">posterior_distributions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
    <span class="k">return</span> <span class="n">posterior_distributions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.construct_normal_prior_from_samples" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">construct_normal_prior_from_samples</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">construct_normal_prior_from_samples</span><span class="p">(</span><span class="n">posterior_samples</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="numpyro.distributions.Distribution">Distribution</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct a dict of Normal Distributions with posterior sample</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>posterior_samples</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Posterior sample</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="numpyro.distributions.Distribution">Distribution</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, dist.Distribution]: dict of Normal Distributions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">construct_normal_prior_from_samples</span><span class="p">(</span>
    <span class="n">posterior_samples</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a dict of Normal Distributions with posterior sample</span>

<span class="sd">    Args:</span>
<span class="sd">        posterior_samples (dict[str, jnp.ndarray]): Posterior sample</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, dist.Distribution]: dict of Normal Distributions</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">posterior_mean</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">posterior_samples</span><span class="p">)</span>
    <span class="n">posterior_std</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">posterior_samples</span><span class="p">)</span>

    <span class="n">prior</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">mean</span> <span class="ow">in</span> <span class="n">posterior_mean</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">prior</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">posterior_std</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">prior</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_normal_posterior_dist_fn_from_svi_result" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_normal_posterior_dist_fn_from_svi_result</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_normal_posterior_dist_fn_from_svi_result</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">guide</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n">num_samples</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n"><span title="numpyro.distributions.Distribution">Distribution</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This function create a get posterior function to be used with <code>numpyro.contrib.module</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>guide</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The guide (variational distribution)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The variational parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_samples</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of sample for approxiatation the posterior distributions</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;graybox&quot;</span>
<span class="n">prior_fn</span> <span class="o">=</span> <span class="n">make_normal_posterior_dist_fn_from_svi_result</span><span class="p">(</span>
    <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">guide</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">,</span> <span class="n">prefix</span>
<span class="p">)</span>
<span class="n">graybox_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_flax_probabilistic_graybox_model</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
    <span class="n">base_model</span><span class="o">=</span><span class="n">base_model</span><span class="p">,</span>
    <span class="n">adapter_fn</span><span class="o">=</span><span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">observable_to_expvals</span><span class="p">,</span>
    <span class="n">prior</span><span class="o">=</span><span class="n">prior_fn</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">posterior_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">predictive_model</span><span class="o">=</span><span class="n">graybox_model</span><span class="p">,</span> <span class="n">log_expectation_values</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="int">int</span>, ...]], <span title="numpyro.distributions.Distribution">Distribution</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable[[str, tuple[int, ...]], dist.Distribution]: The function that return posterior distribution</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_normal_posterior_dist_fn_from_svi_result</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">guide</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function create a get posterior function to be used with `numpyro.contrib.module`.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (jnp.ndarray): The random key</span>
<span class="sd">        guide (typing.Callable): The guide (variational distribution)</span>
<span class="sd">        params (dict[str, jnp.ndarray]): The variational parameters</span>
<span class="sd">        num_samples (int): The number of sample for approxiatation the posterior distributions</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        prefix = &quot;graybox&quot;</span>
<span class="sd">        prior_fn = make_normal_posterior_dist_fn_from_svi_result(</span>
<span class="sd">            jax.random.key(0), guide, result.params, 10_000, prefix</span>
<span class="sd">        )</span>
<span class="sd">        graybox_model = sq.probabilistic.make_flax_probabilistic_graybox_model(</span>
<span class="sd">            name=prefix,</span>
<span class="sd">            base_model=base_model,</span>
<span class="sd">            adapter_fn=sq.probabilistic.observable_to_expvals,</span>
<span class="sd">            prior=prior_fn,</span>
<span class="sd">        )</span>
<span class="sd">        posterior_model = sq.probabilistic.make_probabilistic_model(</span>
<span class="sd">            predictive_model=graybox_model, log_expectation_values=True</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable[[str, tuple[int, ...]], dist.Distribution]: The function that return posterior distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">posterior_samples</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">)(</span>
        <span class="n">key</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_dist_fn</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span><span class="p">:</span>
        <span class="n">site_name</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">name</span>
        <span class="k">return</span> <span class="n">construct_normal_prior_from_samples</span><span class="p">(</span><span class="n">posterior_samples</span><span class="p">)[</span><span class="n">site_name</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">posterior_dist_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_predictive_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_predictive_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_predictive_fn</span><span class="p">(</span><span class="n">posterior_model</span><span class="p">,</span> <span class="n">learning_model</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            LearningModel (src.inspeqtor.experimental.probabilistic.LearningModel)" href="#src.inspeqtor.experimental.probabilistic.LearningModel">LearningModel</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct predictive model from the probabilsitic model.
This function does not relied on guide and the variational parameters</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="n">characterized_result</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">SVIResult</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span>
    <span class="n">PGM_model_path</span> <span class="o">/</span> <span class="s2">&quot;model.json&quot;</span>
<span class="p">)</span>

<span class="n">base_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">linen</span><span class="o">.</span><span class="n">WoModel</span><span class="p">(</span>
    <span class="n">hidden_sizes_1</span><span class="o">=</span><span class="n">characterized_result</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;model_config&quot;</span><span class="p">][</span><span class="s2">&quot;hidden_sizes&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">hidden_sizes_2</span><span class="o">=</span><span class="n">characterized_result</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;model_config&quot;</span><span class="p">][</span><span class="s2">&quot;hidden_sizes&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">graybox_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_flax_probabilistic_graybox_model</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;graybox&quot;</span><span class="p">,</span>
    <span class="n">base_model</span><span class="o">=</span><span class="n">base_model</span><span class="p">,</span>
    <span class="n">adapter_fn</span><span class="o">=</span><span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">observable_to_expvals</span><span class="p">,</span>
    <span class="n">prior</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">graybox_probabilistic_model</span><span class="o">=</span><span class="n">graybox_model</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># initialize guide</span>
<span class="n">guide</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">auto_diagonal_normal_guide</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">ml</span><span class="o">.</span><span class="n">custom_feature_map</span><span class="p">(</span><span class="n">loaded_data</span><span class="o">.</span><span class="n">control_parameters</span><span class="p">),</span>
    <span class="n">loaded_data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">,</span>
    <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">shots</span><span class="p">,</span> <span class="n">loaded_data</span><span class="o">.</span><span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">18</span><span class="p">)),</span>
<span class="p">)</span>
<span class="n">priors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">k</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;graybox/&quot;</span><span class="p">):</span> <span class="n">v</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">make_prior_from_params</span><span class="p">(</span><span class="n">guide</span><span class="p">,</span> <span class="n">characterized_result</span><span class="o">.</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="p">}</span>
<span class="n">graybox_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_flax_probabilistic_graybox_model</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;graybox&quot;</span><span class="p">,</span>
    <span class="n">base_model</span><span class="o">=</span><span class="n">base_model</span><span class="p">,</span>
    <span class="n">adapter_fn</span><span class="o">=</span><span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">observable_to_expvals</span><span class="p">,</span>
    <span class="n">prior</span><span class="o">=</span><span class="n">priors</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">posterior_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">graybox_probabilistic_model</span><span class="o">=</span><span class="n">graybox_model</span><span class="p">,</span>
    <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span>
    <span class="n">block_graybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">log_expectation_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">predicetive_fn</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_predictive_fn</span><span class="p">(</span>
    <span class="n">posterior_model</span><span class="p">,</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">LearningModel</span><span class="o">.</span><span class="n">BernoulliProbs</span>
<span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>posterior_model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>probabilsitic model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>learning_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            LearningModel (src.inspeqtor.experimental.probabilistic.LearningModel)" href="#src.inspeqtor.experimental.probabilistic.LearningModel">LearningModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_predictive_fn</span><span class="p">(</span>
    <span class="n">posterior_model</span><span class="p">,</span>
    <span class="n">learning_model</span><span class="p">:</span> <span class="n">LearningModel</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct predictive model from the probabilsitic model.</span>
<span class="sd">    This function does not relied on guide and the variational parameters</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        characterized_result = sq.probabilistic.SVIResult.from_file(</span>
<span class="sd">            PGM_model_path / &quot;model.json&quot;</span>
<span class="sd">        )</span>

<span class="sd">        base_model = sq.models.linen.WoModel(</span>
<span class="sd">            hidden_sizes_1=characterized_result.config[&quot;model_config&quot;][&quot;hidden_sizes&quot;][0],</span>
<span class="sd">            hidden_sizes_2=characterized_result.config[&quot;model_config&quot;][&quot;hidden_sizes&quot;][1],</span>
<span class="sd">        )</span>
<span class="sd">        graybox_model = sq.probabilistic.make_flax_probabilistic_graybox_model(</span>
<span class="sd">            name=&quot;graybox&quot;,</span>
<span class="sd">            base_model=base_model,</span>
<span class="sd">            adapter_fn=sq.probabilistic.observable_to_expvals,</span>
<span class="sd">            prior=dist.Normal(0, 1),</span>
<span class="sd">        )</span>
<span class="sd">        model = sq.probabilistic.make_probabilistic_model(</span>
<span class="sd">            graybox_probabilistic_model=graybox_model,</span>
<span class="sd">        )</span>
<span class="sd">        # initialize guide</span>
<span class="sd">        guide = sq.probabilistic.auto_diagonal_normal_guide(</span>
<span class="sd">            model,</span>
<span class="sd">            ml.custom_feature_map(loaded_data.control_parameters),</span>
<span class="sd">            loaded_data.unitaries,</span>
<span class="sd">            jnp.zeros(shape=(shots, loaded_data.control_parameters.shape[0], 18)),</span>
<span class="sd">        )</span>
<span class="sd">        priors = {</span>
<span class="sd">            k.strip(&quot;graybox/&quot;): v</span>
<span class="sd">            for k, v in make_prior_from_params(guide, characterized_result.params).items()</span>
<span class="sd">        }</span>
<span class="sd">        graybox_model = sq.probabilistic.make_flax_probabilistic_graybox_model(</span>
<span class="sd">            name=&quot;graybox&quot;,</span>
<span class="sd">            base_model=base_model,</span>
<span class="sd">            adapter_fn=sq.probabilistic.observable_to_expvals,</span>
<span class="sd">            prior=priors,</span>
<span class="sd">        )</span>
<span class="sd">        posterior_model = sq.probabilistic.make_probabilistic_model(</span>
<span class="sd">            graybox_probabilistic_model=graybox_model,</span>
<span class="sd">            shots=shots,</span>
<span class="sd">            block_graybox=True,</span>
<span class="sd">            log_expectation_values=True,</span>
<span class="sd">        )</span>
<span class="sd">        predicetive_fn = sq.probabilistic.make_predictive_fn(</span>
<span class="sd">            posterior_model, sq.probabilistic.LearningModel.BernoulliProbs</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        posterior_model (typing.Any): probabilsitic model</span>
<span class="sd">        learning_model (LearningModel): _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">binary_predict_expectation_values</span><span class="p">(</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">control_params</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitary</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
            <span class="n">binary_to_eigenvalue</span><span class="p">(</span>
                <span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">posterior_model</span><span class="p">,</span> <span class="n">key</span><span class="p">)(</span>  <span class="c1"># type: ignore</span>
                    <span class="n">control_params</span><span class="p">,</span> <span class="n">unitary</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">normal_predict_expectation_values</span><span class="p">(</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">control_params</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitary</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">posterior_model</span><span class="p">,</span> <span class="n">key</span><span class="p">)(</span>  <span class="c1"># type: ignore</span>
            <span class="n">control_params</span><span class="p">,</span> <span class="n">unitary</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">binary_predict_expectation_values</span>
        <span class="k">if</span> <span class="n">learning_model</span> <span class="o">==</span> <span class="n">LearningModel</span><span class="o">.</span><span class="n">BernoulliProbs</span>
        <span class="k">else</span> <span class="n">normal_predict_expectation_values</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_pdf" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_pdf</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_pdf</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">bins</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make the numberical PDF from given sample using histogram method</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sample</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample to make PDF.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bins</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of interval bin.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>srange</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The range of the pdf. Defaults to (-1, 1).</p>
              </div>
            </td>
            <td>
                  <code>(-1, 1)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: The approximated numerical PDF</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_pdf</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">bins</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make the numberical PDF from given sample using histogram method</span>

<span class="sd">    Args:</span>
<span class="sd">        sample (jnp.ndarray): Sample to make PDF.</span>
<span class="sd">        bins (int): The number of interval bin.</span>
<span class="sd">        srange (tuple, optional): The range of the pdf. Defaults to (-1, 1).</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: The approximated numerical PDF</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">density</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">srange</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">density</span> <span class="o">*</span> <span class="n">dx</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.safe_kl_divergence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">safe_kl_divergence</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">safe_kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the KL divergence where the infinity is converted to zero.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The left PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The right PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The KL divergence</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">safe_kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the KL divergence where the infinity is converted to zero.</span>

<span class="sd">    Args:</span>
<span class="sd">        p (jnp.ndarray): The left PDF</span>
<span class="sd">        q (jnp.ndarray): The right PDF</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The KL divergence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">rel_entr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="n">posinf</span><span class="o">=</span><span class="mf">0.0</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.kl_divergence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">kl_divergence</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the KL divergence</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The left PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The right PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray:  The KL divergence</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the KL divergence</span>

<span class="sd">    Args:</span>
<span class="sd">        p (jnp.ndarray): The left PDF</span>
<span class="sd">        q (jnp.ndarray): The right PDF</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray:  The KL divergence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">rel_entr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.safe_jensenshannon_divergence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">safe_jensenshannon_divergence</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">safe_jensenshannon_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate Jensen-Shannon Divergnece using KL divergence.
Implement following: https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.jensenshannon.html</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The left PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The right PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">safe_jensenshannon_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate Jensen-Shannon Divergnece using KL divergence.</span>
<span class="sd">    Implement following: https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.jensenshannon.html</span>

<span class="sd">    Args:</span>
<span class="sd">        p (jnp.ndarray): The left PDF</span>
<span class="sd">        q (jnp.ndarray): The right PDF</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute pointwise mean of p and q</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">safe_kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">safe_kl_divergence</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.jensenshannon_divergence_from_pmf" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">jensenshannon_divergence_from_pmf</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">jensenshannon_divergence_from_pmf</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the Jensen-Shannon Divergence from PMF</p>
<p>Example
<div class="highlight"><pre><span></span><code><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">key_1</span><span class="p">,</span> <span class="n">key_2</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="n">sample_1</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key_1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="p">))</span>
<span class="n">sample_2</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key_2</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="p">))</span>

<span class="c1"># Determine srange from sample</span>
<span class="n">merged_sample</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">sample_2</span><span class="p">])</span>
<span class="n">srange</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">merged_sample</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">merged_sample</span><span class="p">)</span>

<span class="c1"># https://stats.stackexchange.com/questions/510699/discrete-kl-divergence-with-decreasing-bin-width</span>
<span class="c1"># Recommend this book: https://catalog.lib.uchicago.edu/vufind/Record/6093380/TOC</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sample_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="c1"># bins = 10</span>
<span class="n">dis_1</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_pdf</span><span class="p">(</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="n">srange</span><span class="p">)</span>
<span class="n">dis_2</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_pdf</span><span class="p">(</span><span class="n">sample_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="n">srange</span><span class="p">)</span>

<span class="n">jsd</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">jensenshannon_divergence_from_pdf</span><span class="p">(</span><span class="n">dis_1</span><span class="p">,</span> <span class="n">dis_2</span><span class="p">)</span>
</code></pre></div></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 1st probability mass function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 1st probability mass function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The Jensen-Shannon Divergence of p and q</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">jensenshannon_divergence_from_pmf</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the Jensen-Shannon Divergence from PMF</span>

<span class="sd">    Example</span>
<span class="sd">    ```python</span>
<span class="sd">    key = jax.random.key(0)</span>
<span class="sd">    key_1, key_2 = jax.random.split(key)</span>
<span class="sd">    sample_1 = jax.random.normal(key_1, shape=(10000, ))</span>
<span class="sd">    sample_2 = jax.random.normal(key_2, shape=(10000, ))</span>

<span class="sd">    # Determine srange from sample</span>
<span class="sd">    merged_sample = jnp.concat([sample_1, sample_2])</span>
<span class="sd">    srange = jnp.min(merged_sample), jnp.max(merged_sample)</span>

<span class="sd">    # https://stats.stackexchange.com/questions/510699/discrete-kl-divergence-with-decreasing-bin-width</span>
<span class="sd">    # Recommend this book: https://catalog.lib.uchicago.edu/vufind/Record/6093380/TOC</span>
<span class="sd">    bins = int(2 * (sample_2.shape[0]) ** (1/3))</span>
<span class="sd">    # bins = 10</span>
<span class="sd">    dis_1 = sq.probabilistic.make_pdf(sample_1, bins=bins, srange=srange)</span>
<span class="sd">    dis_2 = sq.probabilistic.make_pdf(sample_2, bins=bins, srange=srange)</span>

<span class="sd">    jsd = sq.probabilistic.jensenshannon_divergence_from_pdf(dis_1, dis_2)</span>

<span class="sd">    ```</span>

<span class="sd">    Args:</span>
<span class="sd">        p (jnp.ndarray): The 1st probability mass function</span>
<span class="sd">        q (jnp.ndarray): The 1st probability mass function</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The Jensen-Shannon Divergence of p and q</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Note for JSD: https://medium.com/data-science/how-to-understand-and-use-jensen-shannon-divergence-b10e11b03fd6</span>
    <span class="c1"># Implement following: https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.jensenshannon.html</span>
    <span class="c1"># Compute pointwise mean of p and q</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">kl_divergence</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.jensenshannon_divergence_from_sample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">jensenshannon_divergence_from_sample</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">jensenshannon_divergence_from_sample</span><span class="p">(</span><span class="n">sample_1</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">sample_2</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the Jensen-Shannon Divergence from sample</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sample_1</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The left PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_2</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The right PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The Jensen-Shannon Divergence of p and q</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">jensenshannon_divergence_from_sample</span><span class="p">(</span>
    <span class="n">sample_1</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">sample_2</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the Jensen-Shannon Divergence from sample</span>

<span class="sd">    Args:</span>
<span class="sd">        sample_1 (jnp.ndarray): The left PDF</span>
<span class="sd">        sample_2 (jnp.ndarray): The right PDF</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The Jensen-Shannon Divergence of p and q</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">merged_sample</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">sample_2</span><span class="p">])</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sample_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">srange</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">merged_sample</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">merged_sample</span><span class="p">)</span>

    <span class="n">dis_1</span> <span class="o">=</span> <span class="n">make_pdf</span><span class="p">(</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="n">srange</span><span class="p">)</span>
    <span class="n">dis_2</span> <span class="o">=</span> <span class="n">make_pdf</span><span class="p">(</span><span class="n">sample_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="n">srange</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jensenshannon_divergence_from_pmf</span><span class="p">(</span><span class="n">dis_1</span><span class="p">,</span> <span class="n">dis_2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.batched_matmul" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">batched_matmul</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">batched_matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A specialized batched matrix multiplication of weight and input x, then add the bias.
This function is intended to be used in <code>dense_layer</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input x</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weight to multiply to x</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The bias</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Output of the operations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">batched_matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A specialized batched matrix multiplication of weight and input x, then add the bias.</span>
<span class="sd">    This function is intended to be used in `dense_layer`</span>

<span class="sd">    Args:</span>
<span class="sd">        x (jnp.ndarray): The input x</span>
<span class="sd">        w (jnp.ndarray): The weight to multiply to x</span>
<span class="sd">        b (jnp.ndarray): The bias</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Output of the operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">w</span><span class="p">,</span> <span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">b</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.get_trace" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_trace</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_trace</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n"><span title="jax.random.key">key</span></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convinent function to get a trace of the probabilistic model in numpyro.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fn</code>
            </td>
            <td>
                  <code><span title="function">function</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probabilistic model in numpyro.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random key. Defaults to jax.random.key(0).</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.random.key">key</span>(0)</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_trace</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convinent function to get a trace of the probabilistic model in numpyro.</span>

<span class="sd">    Args:</span>
<span class="sd">        fn (function): The probabilistic model in numpyro.</span>
<span class="sd">        key (jnp.ndarray, optional): The random key. Defaults to jax.random.key(0).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">inner</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.default_priors_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">default_priors_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">default_priors_fn</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="numpyro.distributions.Distribution">Distribution</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This is a default prior function for the <code>dense_layer</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The site name of the parameters, if end with <code>sigma</code> will return Log Normal distribution,
              otherwise, return Normal distribution</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpyro.distributions.Distribution">Distribution</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">default_priors_fn</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is a default prior function for the `dense_layer`</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): The site name of the parameters, if end with `sigma` will return Log Normal distribution,</span>
<span class="sd">                          otherwise, return Normal distribution</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;bias&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.dense_layer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">dense_layer</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">dense_layer</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">in_features</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n">out_features</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n">priors_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n"><span title="numpyro.distributions.Distribution">Distribution</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            default_priors_fn (src.inspeqtor.experimental.probabilistic.default_priors_fn)" href="#src.inspeqtor.experimental.probabilistic.default_priors_fn">default_priors_fn</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A custom probabilistic dense layer for neural network model.
This function intended to be used with <code>numpyro</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input x</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Site name of the layer</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>in_features</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the feature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out_features</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired size of the output feature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>priors_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="str">str</span>], <span title="numpyro.distributions.Distribution">Distribution</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prior function to be used for initializing prior distribution. Defaults to default_priors_fn.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            default_priors_fn (src.inspeqtor.experimental.probabilistic.default_priors_fn)" href="#src.inspeqtor.experimental.probabilistic.default_priors_fn">default_priors_fn</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: Output of the layer given x.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dense_layer</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">in_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">out_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">priors_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span>
        <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">default_priors_fn</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A custom probabilistic dense layer for neural network model.</span>
<span class="sd">    This function intended to be used with `numpyro`</span>

<span class="sd">    Args:</span>
<span class="sd">        x (jnp.ndarray): The input x</span>
<span class="sd">        name (str): Site name of the layer</span>
<span class="sd">        in_features (int): The size of the feature.</span>
<span class="sd">        out_features (int): The desired size of the output feature.</span>
<span class="sd">        priors_fn (typing.Callable[[str], dist.Distribution], optional): The prior function to be used for initializing prior distribution. Defaults to default_priors_fn.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: Output of the layer given x.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">w_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.kernel&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="n">w_name</span><span class="p">,</span>
        <span class="n">priors_fn</span><span class="p">(</span><span class="n">w_name</span><span class="p">,</span> <span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">))</span><span class="o">.</span><span class="n">to_event</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
    <span class="p">)</span>
    <span class="n">b_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.bias&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="n">b_name</span><span class="p">,</span>
        <span class="n">priors_fn</span><span class="p">(</span><span class="n">b_name</span><span class="p">,</span> <span class="p">(</span><span class="n">out_features</span><span class="p">,))</span><span class="o">.</span><span class="n">to_event</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">batched_matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.init_default" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">init_default</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">init_default</span><span class="p">(</span><span class="n">params_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The initialization function for deterministic dense layer</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The site name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unsupport site name</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: The function to be used for parameters init given site name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">init_default</span><span class="p">(</span><span class="n">params_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The initialization function for deterministic dense layer</span>

<span class="sd">    Args:</span>
<span class="sd">        params_name (str): The site name</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Unsupport site name</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: The function to be used for parameters init given site name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">params_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;kernel&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span>
    <span class="k">elif</span> <span class="n">params_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;bias&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupport param name&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.dense_deterministic_layer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">dense_deterministic_layer</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">dense_deterministic_layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">in_features</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n">out_features</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n">batch_shape</span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span> <span class="n">init_fn</span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            init_default (src.inspeqtor.experimental.probabilistic.init_default)" href="#src.inspeqtor.experimental.probabilistic.init_default">init_default</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The deterministic dense layer, to be used with SVI optimizer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input feature</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The site name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>in_features</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the input features</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out_features</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired size of the output features.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The batch size of the x. Defaults to ().</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initilization function of the model parameters. Defaults to init_default.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            init_default (src.inspeqtor.experimental.probabilistic.init_default)" href="#src.inspeqtor.experimental.probabilistic.init_default">init_default</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: The output of the layer given x.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dense_deterministic_layer</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">in_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">out_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">batch_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">init_fn</span><span class="o">=</span><span class="n">init_default</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The deterministic dense layer, to be used with SVI optimizer.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (typing.Any): The input feature</span>
<span class="sd">        name (str): The site name</span>
<span class="sd">        in_features (int): The size of the input features</span>
<span class="sd">        out_features (int): The desired size of the output features.</span>
<span class="sd">        batch_shape (tuple[int, ...], optional): The batch size of the x. Defaults to ().</span>
<span class="sd">        init_fn (typing.Any, optional): Initilization function of the model parameters. Defaults to init_default.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: The output of the layer given x.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Sample weights - shape (in_features, out_features)</span>
    <span class="n">weight_shape</span> <span class="o">=</span> <span class="n">batch_shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">)</span>
    <span class="n">W_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.kernel&quot;</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
        <span class="n">W_name</span><span class="p">,</span>
        <span class="n">init_fn</span><span class="p">(</span><span class="n">W_name</span><span class="p">)(</span><span class="n">shape</span><span class="o">=</span><span class="n">weight_shape</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
    <span class="p">)</span>

    <span class="c1"># Sample bias - shape (out_features,)</span>
    <span class="n">bias_shape</span> <span class="o">=</span> <span class="n">batch_shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">out_features</span><span class="p">,)</span>
    <span class="n">b_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.bias&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">b_name</span><span class="p">,</span> <span class="n">init_fn</span><span class="p">(</span><span class="n">b_name</span><span class="p">)(</span><span class="n">shape</span><span class="o">=</span><span class="n">bias_shape</span><span class="p">))</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">batched_matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_posteriors_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_posteriors_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_posteriors_fn</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make the posterior distribution function that will
return the posterior of parameter of the given name, from guide and parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>guide</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The guide function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The parameters of the guide</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_samples</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sample size. Defaults to 10000.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: A function of parameter name that return the sample from the posterior distribution of the parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_posteriors_fn</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make the posterior distribution function that will</span>
<span class="sd">    return the posterior of parameter of the given name, from guide and parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        guide (typing.Any): The guide function</span>
<span class="sd">        params (typing.Any): The parameters of the guide</span>
<span class="sd">        num_samples (int, optional): The sample size. Defaults to 10000.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: A function of parameter name that return the sample from the posterior distribution of the parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">posterior_distribution</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span>
    <span class="p">)(</span><span class="n">key</span><span class="p">)</span>

    <span class="n">posterior_dict</span> <span class="o">=</span> <span class="n">construct_normal_prior_from_samples</span><span class="p">(</span><span class="n">posterior_distribution</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posteriors_fn</span><span class="p">(</span><span class="n">param_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">posterior_dict</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">posteriors_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.auto_diagonal_normal_guide" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">auto_diagonal_normal_guide</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">auto_diagonal_normal_guide</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">block_sample</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">init_loc_fn</span><span class="o">=</span><span class="n"><span title="jax.numpy.zeros">zeros</span></span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="n"><span title="jax.random.key">key</span></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Automatically generate guide from given model. Expected to be initialized with the example input of the model.
The given input should also including the observed site.
The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.
This is the avoid site name duplication, while allows for model to use newly sample from the guide.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probabilistic model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>block_sample</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to block the sample site. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_loc_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initialization of guide parameters function. Defaults to jnp.zeros.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.zeros">zeros</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">auto_diagonal_normal_guide</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">block_sample</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">init_loc_fn</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatically generate guide from given model. Expected to be initialized with the example input of the model.</span>
<span class="sd">    The given input should also including the observed site.</span>
<span class="sd">    The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.</span>
<span class="sd">    This is the avoid site name duplication, while allows for model to use newly sample from the guide.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Any): The probabilistic model.</span>
<span class="sd">        block_sample (bool, optional): Flag to block the sample site. Defaults to False.</span>
<span class="sd">        init_loc_fn (typing.Any, optional): Initialization of guide parameters function. Defaults to jnp.zeros.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="c1"># get the trace of the model</span>
    <span class="c1"># Then get only the sample site with observed equal to false</span>
    <span class="n">sample_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model_trace</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sample&quot;</span><span class="p">]</span>
    <span class="n">non_observed_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sample_sites</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;is_observed&quot;</span><span class="p">]]</span>
    <span class="n">params_sites</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">}</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">non_observed_sites</span>
    <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">guide</span><span class="p">(</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">params_loc</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_loc&quot;</span><span class="p">,</span> <span class="n">init_loc_fn</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="n">params_scale</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_scale&quot;</span><span class="p">,</span>
                <span class="mf">0.1</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">]),</span>
                <span class="n">constraint</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">softplus_positive</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="n">samples</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">block_sample</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">handlers</span><span class="o">.</span><span class="n">block</span><span class="p">():</span>
                <span class="c1"># Sample from Normal distribution</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">k_loc</span><span class="p">,</span> <span class="n">v_loc</span><span class="p">),</span> <span class="p">(</span><span class="n">k_scale</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">params_loc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">params_scale</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">):</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                        <span class="n">k_loc</span><span class="p">,</span>
                        <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">v_loc</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span><span class="o">.</span><span class="n">to_event</span><span class="p">(),</span>  <span class="c1"># type: ignore</span>
                    <span class="p">)</span>
                    <span class="n">samples</span><span class="p">[</span><span class="n">k_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Sample from Normal distribution</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">k_loc</span><span class="p">,</span> <span class="n">v_loc</span><span class="p">),</span> <span class="p">(</span><span class="n">k_scale</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">params_loc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">params_scale</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">):</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                    <span class="n">k_loc</span><span class="p">,</span>
                    <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">v_loc</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span><span class="o">.</span><span class="n">to_event</span><span class="p">(),</span>  <span class="c1"># type: ignore</span>
                <span class="p">)</span>
                <span class="n">samples</span><span class="p">[</span><span class="n">k_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">return</span> <span class="n">guide</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.auto_diagonal_normal_guide_v2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">auto_diagonal_normal_guide_v2</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">auto_diagonal_normal_guide_v2</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">init_dist_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.experimental.probabilistic.init_normal_dist_fn">init_normal_dist_fn</span></span><span class="p">,</span> <span class="n">init_params_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.experimental.probabilistic.init_params_fn">init_params_fn</span></span><span class="p">,</span> <span class="n">block_sample</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="n"><span title="jax.random.key">key</span></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Automatically generate guide from given model. Expected to be initialized with the example input of the model.
The given input should also including the observed site.
The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.
This is the avoid site name duplication, while allows for model to use newly sample from the guide.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probabilistic model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>block_sample</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to block the sample site. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_loc_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initialization of guide parameters function. Defaults to jnp.zeros.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">auto_diagonal_normal_guide_v2</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">init_dist_fn</span><span class="o">=</span><span class="n">init_normal_dist_fn</span><span class="p">,</span>
    <span class="n">init_params_fn</span><span class="o">=</span><span class="n">init_params_fn</span><span class="p">,</span>
    <span class="n">block_sample</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatically generate guide from given model. Expected to be initialized with the example input of the model.</span>
<span class="sd">    The given input should also including the observed site.</span>
<span class="sd">    The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.</span>
<span class="sd">    This is the avoid site name duplication, while allows for model to use newly sample from the guide.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Any): The probabilistic model.</span>
<span class="sd">        block_sample (bool, optional): Flag to block the sample site. Defaults to False.</span>
<span class="sd">        init_loc_fn (typing.Any, optional): Initialization of guide parameters function. Defaults to jnp.zeros.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the trace of the model</span>
    <span class="n">model_trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="c1"># Then get only the sample site with observed equal to false</span>
    <span class="n">sample_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model_trace</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sample&quot;</span><span class="p">]</span>
    <span class="n">non_observed_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sample_sites</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;is_observed&quot;</span><span class="p">]]</span>
    <span class="n">params_sites</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">}</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">non_observed_sites</span>
    <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_fn</span><span class="p">(</span>
        <span class="n">params_loc</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">params_scale</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Sample from Normal distribution</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k_loc</span><span class="p">,</span> <span class="n">v_loc</span><span class="p">),</span> <span class="p">(</span><span class="n">k_scale</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">params_loc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">params_scale</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                <span class="n">k_loc</span><span class="p">,</span>
                <span class="n">init_dist_fn</span><span class="p">(</span><span class="n">k_loc</span><span class="p">)(</span><span class="n">v_loc</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span><span class="o">.</span><span class="n">to_event</span><span class="p">(),</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
            <span class="n">samples</span><span class="p">[</span><span class="n">k_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">guide</span><span class="p">(</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">params_loc</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">init_params_fn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_loc&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="n">params_scale</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">init_params_fn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_scale&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">block_sample</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">handlers</span><span class="o">.</span><span class="n">block</span><span class="p">():</span>
                <span class="n">samples</span> <span class="o">=</span> <span class="n">sample_fn</span><span class="p">(</span><span class="n">params_loc</span><span class="p">,</span> <span class="n">params_scale</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="n">sample_fn</span><span class="p">(</span><span class="n">params_loc</span><span class="p">,</span> <span class="n">params_scale</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">return</span> <span class="n">guide</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_predictive_fn_v2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_predictive_fn_v2</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_predictive_fn_v2</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">shots</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make a postirior predictive model function from model, guide, SVI parameters, and the number of shots.
This version relied explicitly on the guide and variational parameters. It might be slow than the first version.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Probabilistic model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>guide</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Gudie corresponded to the model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SVI parameters of the guide</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shots</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shots</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: The posterior predictive model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_predictive_fn_v2</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">guide</span><span class="p">,</span>
    <span class="n">params</span><span class="p">,</span>
    <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a postirior predictive model function from model, guide, SVI parameters, and the number of shots.</span>
<span class="sd">    This version relied explicitly on the guide and variational parameters. It might be slow than the first version.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Any): Probabilistic model.</span>
<span class="sd">        guide (typing.Any): Gudie corresponded to the model</span>
<span class="sd">        params (typing.Any): SVI parameters of the guide</span>
<span class="sd">        shots (int): The number of shots</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: The posterior predictive model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">predictive</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">guide</span><span class="o">=</span><span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">return_sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predictive_fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">predictive</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">predictive_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_predictive_SGM_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_predictive_SGM_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_predictive_SGM_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n"><span title="flax.linen.Module">Module</span></span><span class="p">,</span> <span class="n">model_params</span><span class="p">,</span> <span class="n">output_to_expectation_values_fn</span><span class="p">,</span> <span class="n">shots</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make a predictive model from given SGM model, the model parameters, and number of shots.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flax model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_params</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shots</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shots.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_predictive_SGM_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">model_params</span><span class="p">,</span> <span class="n">output_to_expectation_values_fn</span><span class="p">,</span> <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a predictive model from given SGM model, the model parameters, and number of shots.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (nn.Module): Flax model</span>
<span class="sd">        model_params (typing.Any): The model parameters.</span>
<span class="sd">        shots (int): The number of shots.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predictive_model</span><span class="p">(</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">control_param</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">control_param</span><span class="p">)</span>
        <span class="n">predicted_expvals</span> <span class="o">=</span> <span class="n">output_to_expectation_values_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">binary_to_eigenvalue</span><span class="p">(</span>
            <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))(</span>
                <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shots</span><span class="p">),</span>
                <span class="n">expectation_value_to_prob_minus</span><span class="p">(</span><span class="n">predicted_expvals</span><span class="p">),</span>
            <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictive_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_predictive_MCDGM_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_predictive_MCDGM_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_predictive_MCDGM_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n"><span title="flax.linen.Module">Module</span></span><span class="p">,</span> <span class="n">model_params</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make a predictive model from given Monte-Carlo Dropout Graybox model, and the model parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Monte-Carlo Dropout Graybox model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_params</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_predictive_MCDGM_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">model_params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a predictive model from given Monte-Carlo Dropout Graybox model, and the model parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (nn.Module): Monte-Carlo Dropout Graybox model</span>
<span class="sd">        model_params (typing.Any): The model parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predictive_model</span><span class="p">(</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">control_param</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">):</span>
        <span class="n">wo_params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="n">model_params</span><span class="p">,</span>
            <span class="n">control_param</span><span class="p">,</span>
            <span class="n">rngs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;dropout&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">},</span>
        <span class="p">)</span>

        <span class="n">predicted_expvals</span> <span class="o">=</span> <span class="n">get_predict_expectation_value</span><span class="p">(</span>
            <span class="n">wo_params</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
            <span class="n">unitaries</span><span class="p">,</span>
            <span class="n">default_expectation_values_order</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">predicted_expvals</span>

    <span class="k">return</span> <span class="n">predictive_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_predictive_resampling_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_predictive_resampling_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_predictive_resampling_model</span><span class="p">(</span><span class="n">predictive_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n">shots</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make a binary predictive model from given SGM model, the model parameters, and number of shots.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predictive_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The predictive_fn embeded with the SGM model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shots</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shots.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable[[jnp.ndarray, jnp.ndarray, jnp.ndarray], jnp.ndarray]: Binary predictive model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_predictive_resampling_model</span><span class="p">(</span>
    <span class="n">predictive_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a binary predictive model from given SGM model, the model parameters, and number of shots.</span>

<span class="sd">    Args:</span>
<span class="sd">        predictive_fn (typing.Callable[[jnp.ndarray, jnp.ndarray], jnp.ndarray]): The predictive_fn embeded with the SGM model.</span>
<span class="sd">        shots (int): The number of shots.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable[[jnp.ndarray, jnp.ndarray, jnp.ndarray], jnp.ndarray]: Binary predictive model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predictive_model</span><span class="p">(</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">):</span>
        <span class="n">predicted_expvals</span> <span class="o">=</span> <span class="n">predictive_fn</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">binary_to_eigenvalue</span><span class="p">(</span>
            <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))(</span>
                <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shots</span><span class="p">),</span>
                <span class="n">expectation_value_to_prob_minus</span><span class="p">(</span><span class="n">predicted_expvals</span><span class="p">),</span>
            <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictive_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_probabilistic_graybox_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_probabilistic_graybox_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_probabilistic_graybox_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">adapter_fn</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This function make a probabilistic graybox model using custom numpyro BNN model</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="_type_">_type_</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>adapter_fn</code>
            </td>
            <td>
                  <code><span title="_type_">_type_</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_probabilistic_graybox_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">adapter_fn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function make a probabilistic graybox model using custom numpyro BNN model</span>

<span class="sd">    Args:</span>
<span class="sd">        model (_type_): _description_</span>
<span class="sd">        adapter_fn (_type_): _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">probabilistic_graybox_model</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">):</span>
        <span class="n">samples_shape</span> <span class="o">=</span> <span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">unitaries</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">unitaries</span><span class="p">,</span> <span class="n">samples_shape</span> <span class="o">+</span> <span class="n">unitaries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span>

        <span class="c1"># Predict from control parameters</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">)</span>

        <span class="n">numpyro</span><span class="o">.</span><span class="n">deterministic</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

        <span class="c1"># With unitary and Wo, calculate expectation values</span>
        <span class="n">expvals</span> <span class="o">=</span> <span class="n">adapter_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">expvals</span>

    <span class="k">return</span> <span class="n">probabilistic_graybox_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.auto_diagonal_normal_guide_v3" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">auto_diagonal_normal_guide_v3</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">auto_diagonal_normal_guide_v3</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">init_dist_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.experimental.probabilistic.bnn_init_dist_fn">bnn_init_dist_fn</span></span><span class="p">,</span> <span class="n">init_params_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.experimental.probabilistic.bnn_init_params_fn">bnn_init_params_fn</span></span><span class="p">,</span> <span class="n">dist_transform_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.experimental.probabilistic.default_transform_dist_fn">default_transform_dist_fn</span></span><span class="p">,</span> <span class="n">block_sample</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="n"><span title="jax.random.key">key</span></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Automatically generate guide from given model. Expected to be initialized with the example input of the model.
The given input should also including the observed site.
The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.
This is the avoid site name duplication, while allows for model to use newly sample from the guide.</p>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This version enable even more flexible initialization strategy.
This function intended to be able to be compatible with auto marginal guide.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probabilistic model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>block_sample</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to block the sample site. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_loc_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initialization of guide parameters function. Defaults to jnp.zeros.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">auto_diagonal_normal_guide_v3</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">init_dist_fn</span><span class="o">=</span><span class="n">bnn_init_dist_fn</span><span class="p">,</span>
    <span class="n">init_params_fn</span><span class="o">=</span><span class="n">bnn_init_params_fn</span><span class="p">,</span>
    <span class="n">dist_transform_fn</span><span class="o">=</span><span class="n">default_transform_dist_fn</span><span class="p">,</span>
    <span class="n">block_sample</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatically generate guide from given model. Expected to be initialized with the example input of the model.</span>
<span class="sd">    The given input should also including the observed site.</span>
<span class="sd">    The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.</span>
<span class="sd">    This is the avoid site name duplication, while allows for model to use newly sample from the guide.</span>

<span class="sd">    Notes:</span>
<span class="sd">        This version enable even more flexible initialization strategy.</span>
<span class="sd">        This function intended to be able to be compatible with auto marginal guide.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Any): The probabilistic model.</span>
<span class="sd">        block_sample (bool, optional): Flag to block the sample site. Defaults to False.</span>
<span class="sd">        init_loc_fn (typing.Any, optional): Initialization of guide parameters function. Defaults to jnp.zeros.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the trace of the model</span>
    <span class="n">model_trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="c1"># Then get only the sample site with observed equal to false</span>
    <span class="n">sample_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model_trace</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sample&quot;</span><span class="p">]</span>
    <span class="n">non_observed_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sample_sites</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;is_observed&quot;</span><span class="p">]]</span>
    <span class="n">params_sites</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">}</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">non_observed_sites</span>
    <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_fn</span><span class="p">(</span>
        <span class="n">params_loc</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">params_scale</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Sample from Normal distribution</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k_loc</span><span class="p">,</span> <span class="n">v_loc</span><span class="p">),</span> <span class="p">(</span><span class="n">k_scale</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">params_loc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">params_scale</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                <span class="n">k_loc</span><span class="p">,</span>
                <span class="n">dist_transform_fn</span><span class="p">(</span><span class="n">k_loc</span><span class="p">,</span> <span class="n">init_dist_fn</span><span class="p">(</span><span class="n">k_loc</span><span class="p">)(</span><span class="n">v_loc</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)),</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
            <span class="n">samples</span><span class="p">[</span><span class="n">k_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">guide</span><span class="p">(</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">params_loc</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">init_params_fn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_loc&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="n">params_scale</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">init_params_fn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_scale&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="k">with</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">optional</span><span class="p">(</span><span class="n">block_sample</span><span class="p">,</span> <span class="n">handlers</span><span class="o">.</span><span class="n">block</span><span class="p">()):</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="n">sample_fn</span><span class="p">(</span><span class="n">params_loc</span><span class="p">,</span> <span class="n">params_scale</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">return</span> <span class="n">guide</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.experimental.probabilistic.make_posterior_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_posterior_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_posterior_fn</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">get_dist_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="str">str</span></span><span class="p">],</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This function create a posterior function to make a posterior predictive model</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="n">posterior_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">predictive_model</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span>
            <span class="n">probabilistic_graybox_model</span><span class="p">,</span>
            <span class="n">priors_fn</span><span class="o">=</span><span class="n">make_posterior_fn</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">init_bnn_dist_fn</span><span class="p">),</span>
        <span class="p">),</span>
    <span class="n">log_expectation_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="_type_">_type_</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The variational parameters from SVI</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>get_dist_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="str">str</span>], <span title="numpyro.distributions.Distribution">Distribution</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function that return function given name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/inspeqtor/experimental/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_posterior_fn</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">get_dist_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function create a posterior function to make a posterior predictive model</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        posterior_model = sq.probabilistic.make_probabilistic_model(</span>
<span class="sd">            predictive_model=partial(</span>
<span class="sd">                    probabilistic_graybox_model,</span>
<span class="sd">                    priors_fn=make_posterior_fn(result.params, init_bnn_dist_fn),</span>
<span class="sd">                ),</span>
<span class="sd">            log_expectation_values=True,</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        params (_type_): The variational parameters from SVI</span>
<span class="sd">        get_dist_fn (typing.Callable[[str], dist.Distribution]): The function that return function given name</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_fn</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]):</span>
        <span class="k">return</span> <span class="n">get_dist_fn</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">params</span><span class="p">[</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_loc&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_scale&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">posterior_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>