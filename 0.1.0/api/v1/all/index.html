
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Data-Efficient Framework for Characterizing and Calibrating That Squeezes Every Bit of Information from Quantum Devices.">
      
      
        <meta name="author" content="Poramet Pathumsoot">
      
      
        <link rel="canonical" href="https://porametpat.github.io/inspeqtor/0.1.0/api/v1/all/">
      
      
        <link rel="prev" href="../../stable/boed/">
      
      
        <link rel="next" href="../../v2/all/">
      
      
      <link rel="icon" href="../../../assets/inspeqtor_logo_square.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>v1 - Inspeqtor</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="v1 - Inspeqtor" >
      
        <meta  property="og:description"  content="A Data-Efficient Framework for Characterizing and Calibrating That Squeezes Every Bit of Information from Quantum Devices." >
      
        <meta  property="og:image"  content="https://porametpat.github.io/inspeqtor/0.1.0/assets/images/social/api/v1/all.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://porametpat.github.io/inspeqtor/0.1.0/api/v1/all/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="v1 - Inspeqtor" >
      
        <meta  name="twitter:description"  content="A Data-Efficient Framework for Characterizing and Calibrating That Squeezes Every Bit of Information from Quantum Devices." >
      
        <meta  name="twitter:image"  content="https://porametpat.github.io/inspeqtor/0.1.0/assets/images/social/api/v1/all.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#v1-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Inspeqtor" class="md-header__button md-logo" aria-label="Inspeqtor" data-md-component="logo">
      
  <img src="../../../assets/inspeqtor_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Inspeqtor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              v1
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/PorametPat/inspeqtor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Inspeqtor" class="md-nav__button md-logo" aria-label="Inspeqtor" data-md-component="logo">
      
  <img src="../../../assets/inspeqtor_logo.svg" alt="logo">

    </a>
    Inspeqtor
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PorametPat/inspeqtor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/overviews/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overviews
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/tutorial_0001_dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataset Creating
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/tutorial_0002_control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control Action
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/tutorial_0003_cc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Characterization and Calibration using Graybox
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/tutorial_0004_t1_characterization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    T1 Characterization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/tutorial_0005_ramsey_experiment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ramsey Experiment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Legacy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Legacy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/legacy/tutorial_0001_dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataset Creating
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/legacy/tutorial_0003_cc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Characterization and Calibration using Graybox
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design Decisions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    How-To Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            How-To Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/dnn_to_bnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to convert DNN into BNN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/bayesian_optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bayesian Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/working_memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working memory example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Legacy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Legacy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/legacy/dnn_to_bnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to convert DNN into BNN
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    stable
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            stable
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3" id="__nav_5_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3">
            <span class="md-nav__icon md-icon"></span>
            models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/models-shared/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    shared
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/models-adapter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    adapter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_3" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3_3" id="__nav_5_2_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    library
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            library
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/models-library-linen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/models-library-nnx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nnx
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/models-probabilistic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    probabilistic
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/optimize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    optimize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/physics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    physics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stable/boed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    boed
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    v1
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    v1
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#boed" class="md-nav__link">
    <span class="md-ellipsis">
      BOED
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;boed
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" boed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.AuxEntry" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AuxEntry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.safe_shape" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;safe_shape
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.report_shape" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;report_shape
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.lexpand" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;lexpand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.random_split_index" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;random_split_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.marginal_loss" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;marginal_loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.vnmc_eig_loss" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;vnmc_eig_loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.init_params_from_guide" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;init_params_from_guide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.opt_eig_ape_loss" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;opt_eig_ape_loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.estimate_eig" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;estimate_eig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.vectorized_for_eig" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;vectorized_for_eig
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constant" class="md-nav__link">
    <span class="md-ellipsis">
      Constant
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.constant" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;constant
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control" class="md-nav__link">
    <span class="md-ellipsis">
      Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;control
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.BaseControl" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseControl
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BaseControl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.BaseControl.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.BaseControl.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ControlSequenceProtocol
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ControlSequenceProtocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.get_structure" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.sample_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.get_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.get_envelope" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_envelope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.to_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ControlSequence
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ControlSequence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.sample_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.get_envelope" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_envelope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.get_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.get_parameter_names" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_parameter_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.to_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.sample_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sample_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.array_to_list_of_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;array_to_list_of_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.list_of_params_to_array" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;list_of_params_to_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.get_param_array_converter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_param_array_converter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.construct_control_sequence_reader" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;construct_control_sequence_reader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.get_envelope_transformer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_envelope_transformer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    <span class="md-ellipsis">
      Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;data
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.Operator" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Operator
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Operator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.Operator.from_label" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.Operator.to_qutrit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_qutrit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.State" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;State
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" State">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.State.from_label" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.State.to_qutrit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_qutrit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.QubitInformation" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;QubitInformation
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" QubitInformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.QubitInformation.convert_unit_to_ghz" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;convert_unit_to_ghz
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExpectationValue" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ExpectationValue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentConfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ExperimentConfiguration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ExperimentData
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ExperimentData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.validate_preprocess_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;validate_preprocess_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.validate_postprocess_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;validate_postprocess_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.transform_preprocess_data_to_postprocess_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;transform_preprocess_data_to_postprocess_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.get_parameters_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_parameters_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.get_expectation_values" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_expectation_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.get_parameters_dict_list" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_parameters_dict_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.save_to_folder" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_to_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.from_folder" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_folder
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.add_hilbert_level" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_hilbert_level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.flatten_parameter_name_with_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;flatten_parameter_name_with_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.transform_parameter_name" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;transform_parameter_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.get_parameters_dict_list" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_parameters_dict_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.save_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;save_to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.read_from_json" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;read_from_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.load_pytree_from_json" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_pytree_from_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.save_pytree_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;save_pytree_to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.from_long_to_wide" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;from_long_to_wide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.from_wide_to_long_simple" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;from_wide_to_long_simple
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linen" class="md-nav__link">
    <span class="md-ellipsis">
      Linen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;linen
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" linen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.loss_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;loss_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.wo_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;wo_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.noisy_unitary_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;noisy_unitary_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.toggling_unitary_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toggling_unitary_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.make_loss_fn_old" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn_old
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.make_loss_fn_oldv2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn_oldv2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.make_loss_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.create_step" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.train_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;train_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nnx" class="md-nav__link">
    <span class="md-ellipsis">
      NNX
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;nnx
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" nnx">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.Blackbox" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Blackbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.WoModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;WoModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" WoModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.WoModel.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.UnitaryModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;UnitaryModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" UnitaryModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.UnitaryModel.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.UnitarySPAMModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;UnitarySPAMModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" UnitarySPAMModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.UnitarySPAMModel.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.wo_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;wo_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.noisy_unitary_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;noisy_unitary_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.toggling_unitary_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toggling_unitary_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.toggling_unitary_with_spam_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toggling_unitary_with_spam_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.make_loss_fn_old" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn_old
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.make_loss_fn_oldv2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn_oldv2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.make_loss_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.create_step" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.reconstruct_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;reconstruct_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.train_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;train_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimize" class="md-nav__link">
    <span class="md-ellipsis">
      Optimize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.optimize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;optimize
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" optimize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.optimize.get_default_optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_default_optimizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.optimize.minimize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;minimize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.optimize.stochastic_minimize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;stochastic_minimize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physics" class="md-nav__link">
    <span class="md-ellipsis">
      Physics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;physics
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" physics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.normalizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;normalizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.solver" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solver
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.auto_rotating_frame_hamiltonian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_rotating_frame_hamiltonian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.explicit_auto_rotating_frame_hamiltonian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;explicit_auto_rotating_frame_hamiltonian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.a" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;a
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.a_dag" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;a_dag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.N" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;N
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.gen_hamiltonian_from" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;gen_hamiltonian_from
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.hamiltonian_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;hamiltonian_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.signal_func_v3" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;signal_func_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.signal_func_v4" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;signal_func_v4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.make_signal_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_signal_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.gate_fidelity" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;gate_fidelity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.check_valid_density_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;check_valid_density_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.check_hermitian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;check_hermitian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.direct_AFG_estimation" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;direct_AFG_estimation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.direct_AFG_estimation_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;direct_AFG_estimation_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.calculate_exp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;calculate_exp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.unitaries_prod" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;unitaries_prod
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.make_trotterization_solver" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_trotterization_solver
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.lindblad_solver" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;lindblad_solver
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#predefined" class="md-nav__link">
    <span class="md-ellipsis">
      Predefined
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;predefined
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" predefined">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.HamiltonianSpec" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HamiltonianSpec
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" HamiltonianSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.HamiltonianSpec.get_solver" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_solver
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.rotating_transmon_hamiltonian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;rotating_transmon_hamiltonian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.transmon_hamiltonian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;transmon_hamiltonian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.get_gaussian_control_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_gaussian_control_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.get_two_axis_gaussian_control_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_two_axis_gaussian_control_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.get_drag_pulse_v2_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_drag_pulse_v2_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.generate_experimental_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generate_experimental_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.get_single_qubit_whitebox" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_single_qubit_whitebox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.load_data_from_path" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_data_from_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.save_data_to_path" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;save_data_to_path
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#probabilistic" class="md-nav__link">
    <span class="md-ellipsis">
      Probabilistic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;probabilistic
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" probabilistic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.LearningModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LearningModel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_probabilistic_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_probabilistic_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.get_args_of_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_args_of_distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.construct_normal_priors" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;construct_normal_priors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.construct_normal_prior_from_samples" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;construct_normal_prior_from_samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_normal_posterior_dist_fn_from_svi_result" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_normal_posterior_dist_fn_from_svi_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_pdf" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_pdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.safe_kl_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;safe_kl_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.kl_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;kl_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.safe_jensenshannon_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;safe_jensenshannon_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.jensenshannon_divergence_from_pmf" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;jensenshannon_divergence_from_pmf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.jensenshannon_divergence_from_sample" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;jensenshannon_divergence_from_sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.batched_matmul" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;batched_matmul
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.get_trace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.default_priors_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;default_priors_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.dense_layer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;dense_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.init_default" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;init_default
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.dense_deterministic_layer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;dense_deterministic_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_posteriors_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_posteriors_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.auto_diagonal_normal_guide" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.auto_diagonal_normal_guide_v2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_predictive_fn_v2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_fn_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_predictive_SGM_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_SGM_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_predictive_MCDGM_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_MCDGM_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_predictive_resampling_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_resampling_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_probabilistic_graybox_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_probabilistic_graybox_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.auto_diagonal_normal_guide_v3" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_posterior_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_posterior_fn
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilities" class="md-nav__link">
    <span class="md-ellipsis">
      Utilities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.center_location" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;center_location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.drag_envelope_v2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;drag_envelope_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.detune_hamiltonian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;detune_hamiltonian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.prepare_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.random_split" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;random_split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.expectation_value_to_prob_plus" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;expectation_value_to_prob_plus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.expectation_value_to_prob_minus" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;expectation_value_to_prob_minus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.expectation_value_to_eigenvalue" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;expectation_value_to_eigenvalue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.eigenvalue_to_binary" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;eigenvalue_to_binary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.binary_to_eigenvalue" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;binary_to_eigenvalue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.recursive_vmap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;recursive_vmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.calculate_shots_expectation_value" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;calculate_shots_expectation_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.shot_quantum_device" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;shot_quantum_device
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Visualization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.visualization" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;visualization
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" visualization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.visualization.format_expectation_values" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;format_expectation_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.visualization.plot_loss_with_moving_average" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_loss_with_moving_average
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.visualization.assert_list_of_axes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;assert_list_of_axes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.visualization.set_fontsize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_fontsize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../v2/all/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    v2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Note
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer/note_tempfile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Temporary directory for documentation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#boed" class="md-nav__link">
    <span class="md-ellipsis">
      BOED
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;boed
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" boed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.AuxEntry" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AuxEntry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.safe_shape" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;safe_shape
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.report_shape" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;report_shape
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.lexpand" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;lexpand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.random_split_index" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;random_split_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.marginal_loss" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;marginal_loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.vnmc_eig_loss" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;vnmc_eig_loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.init_params_from_guide" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;init_params_from_guide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.opt_eig_ape_loss" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;opt_eig_ape_loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.estimate_eig" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;estimate_eig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.boed.vectorized_for_eig" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;vectorized_for_eig
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constant" class="md-nav__link">
    <span class="md-ellipsis">
      Constant
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.constant" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;constant
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control" class="md-nav__link">
    <span class="md-ellipsis">
      Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;control
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" control">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.BaseControl" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseControl
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BaseControl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.BaseControl.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.BaseControl.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ControlSequenceProtocol
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ControlSequenceProtocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.get_structure" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.sample_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.get_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.get_envelope" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_envelope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.to_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequenceProtocol.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ControlSequence
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ControlSequence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.sample_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.get_envelope" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_envelope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.get_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.get_parameter_names" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_parameter_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.to_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.ControlSequence.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.sample_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sample_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.array_to_list_of_params" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;array_to_list_of_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.list_of_params_to_array" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;list_of_params_to_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.get_param_array_converter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_param_array_converter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.construct_control_sequence_reader" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;construct_control_sequence_reader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.control.get_envelope_transformer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_envelope_transformer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    <span class="md-ellipsis">
      Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;data
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.Operator" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Operator
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Operator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.Operator.from_label" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.Operator.to_qutrit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_qutrit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.State" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;State
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" State">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.State.from_label" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.State.to_qutrit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_qutrit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.QubitInformation" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;QubitInformation
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" QubitInformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.QubitInformation.convert_unit_to_ghz" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;convert_unit_to_ghz
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExpectationValue" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ExpectationValue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentConfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ExperimentConfiguration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ExperimentData
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ExperimentData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.validate_preprocess_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;validate_preprocess_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.validate_postprocess_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;validate_postprocess_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.transform_preprocess_data_to_postprocess_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;transform_preprocess_data_to_postprocess_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.get_parameters_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_parameters_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.get_expectation_values" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_expectation_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.get_parameters_dict_list" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_parameters_dict_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.save_to_folder" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_to_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.ExperimentData.from_folder" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_folder
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.add_hilbert_level" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_hilbert_level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.flatten_parameter_name_with_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;flatten_parameter_name_with_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.transform_parameter_name" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;transform_parameter_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.get_parameters_dict_list" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_parameters_dict_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.save_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;save_to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.read_from_json" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;read_from_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.load_pytree_from_json" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_pytree_from_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.save_pytree_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;save_pytree_to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.from_long_to_wide" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;from_long_to_wide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.data.from_wide_to_long_simple" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;from_wide_to_long_simple
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linen" class="md-nav__link">
    <span class="md-ellipsis">
      Linen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;linen
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" linen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.loss_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;loss_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.wo_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;wo_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.noisy_unitary_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;noisy_unitary_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.toggling_unitary_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toggling_unitary_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.make_loss_fn_old" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn_old
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.make_loss_fn_oldv2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn_oldv2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.make_loss_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.create_step" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.linen.train_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;train_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nnx" class="md-nav__link">
    <span class="md-ellipsis">
      NNX
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;nnx
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" nnx">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.Blackbox" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Blackbox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.WoModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;WoModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" WoModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.WoModel.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.UnitaryModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;UnitaryModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" UnitaryModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.UnitaryModel.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.UnitarySPAMModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;UnitarySPAMModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" UnitarySPAMModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.UnitarySPAMModel.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.wo_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;wo_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.noisy_unitary_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;noisy_unitary_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.toggling_unitary_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toggling_unitary_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.toggling_unitary_with_spam_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;toggling_unitary_with_spam_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.make_loss_fn_old" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn_old
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.make_loss_fn_oldv2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn_oldv2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.make_loss_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_loss_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.create_step" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.reconstruct_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;reconstruct_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.models.nnx.train_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;train_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimize" class="md-nav__link">
    <span class="md-ellipsis">
      Optimize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.optimize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;optimize
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" optimize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.optimize.get_default_optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_default_optimizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.optimize.minimize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;minimize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.optimize.stochastic_minimize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;stochastic_minimize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physics" class="md-nav__link">
    <span class="md-ellipsis">
      Physics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;physics
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" physics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.normalizer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;normalizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.solver" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solver
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.auto_rotating_frame_hamiltonian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_rotating_frame_hamiltonian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.explicit_auto_rotating_frame_hamiltonian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;explicit_auto_rotating_frame_hamiltonian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.a" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;a
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.a_dag" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;a_dag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.N" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;N
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.gen_hamiltonian_from" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;gen_hamiltonian_from
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.hamiltonian_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;hamiltonian_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.signal_func_v3" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;signal_func_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.signal_func_v4" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;signal_func_v4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.make_signal_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_signal_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.gate_fidelity" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;gate_fidelity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.check_valid_density_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;check_valid_density_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.check_hermitian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;check_hermitian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.direct_AFG_estimation" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;direct_AFG_estimation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.direct_AFG_estimation_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;direct_AFG_estimation_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.calculate_exp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;calculate_exp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.unitaries_prod" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;unitaries_prod
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.make_trotterization_solver" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_trotterization_solver
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.physics.lindblad_solver" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;lindblad_solver
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#predefined" class="md-nav__link">
    <span class="md-ellipsis">
      Predefined
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;predefined
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" predefined">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.HamiltonianSpec" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HamiltonianSpec
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" HamiltonianSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.HamiltonianSpec.get_solver" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_solver
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.rotating_transmon_hamiltonian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;rotating_transmon_hamiltonian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.transmon_hamiltonian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;transmon_hamiltonian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.get_gaussian_control_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_gaussian_control_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.get_two_axis_gaussian_control_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_two_axis_gaussian_control_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.get_drag_pulse_v2_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_drag_pulse_v2_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.generate_experimental_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generate_experimental_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.get_single_qubit_whitebox" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_single_qubit_whitebox
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.load_data_from_path" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_data_from_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.predefined.save_data_to_path" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;save_data_to_path
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#probabilistic" class="md-nav__link">
    <span class="md-ellipsis">
      Probabilistic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;probabilistic
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" probabilistic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.LearningModel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LearningModel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_probabilistic_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_probabilistic_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.get_args_of_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_args_of_distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.construct_normal_priors" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;construct_normal_priors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.construct_normal_prior_from_samples" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;construct_normal_prior_from_samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_normal_posterior_dist_fn_from_svi_result" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_normal_posterior_dist_fn_from_svi_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_predictive_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_pdf" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_pdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.safe_kl_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;safe_kl_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.kl_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;kl_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.safe_jensenshannon_divergence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;safe_jensenshannon_divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.jensenshannon_divergence_from_pmf" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;jensenshannon_divergence_from_pmf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.jensenshannon_divergence_from_sample" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;jensenshannon_divergence_from_sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.batched_matmul" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;batched_matmul
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.get_trace" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.default_priors_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;default_priors_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.dense_layer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;dense_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.init_default" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;init_default
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.dense_deterministic_layer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;dense_deterministic_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_posteriors_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_posteriors_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.auto_diagonal_normal_guide" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.auto_diagonal_normal_guide_v2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_predictive_fn_v2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_fn_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_predictive_SGM_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_SGM_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_predictive_MCDGM_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_MCDGM_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_predictive_resampling_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_predictive_resampling_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_probabilistic_graybox_model" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_probabilistic_graybox_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.auto_diagonal_normal_guide_v3" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;auto_diagonal_normal_guide_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.probabilistic.make_posterior_fn" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;make_posterior_fn
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilities" class="md-nav__link">
    <span class="md-ellipsis">
      Utilities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.center_location" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;center_location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.drag_envelope_v2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;drag_envelope_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.detune_hamiltonian" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;detune_hamiltonian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.prepare_data" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.random_split" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;random_split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.expectation_value_to_prob_plus" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;expectation_value_to_prob_plus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.expectation_value_to_prob_minus" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;expectation_value_to_prob_minus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.expectation_value_to_eigenvalue" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;expectation_value_to_eigenvalue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.eigenvalue_to_binary" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;eigenvalue_to_binary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.binary_to_eigenvalue" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;binary_to_eigenvalue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.recursive_vmap" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;recursive_vmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.calculate_shots_expectation_value" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;calculate_shots_expectation_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.utils.shot_quantum_device" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;shot_quantum_device
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Visualization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.visualization" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;visualization
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" visualization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.visualization.format_expectation_values" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;format_expectation_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.visualization.plot_loss_with_moving_average" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;plot_loss_with_moving_average
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.visualization.assert_list_of_axes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;assert_list_of_axes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.inspeqtor.v1.visualization.set_fontsize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_fontsize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="v1-api"><code>v1</code> API</h1>
<h2 id="boed">BOED</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.boed" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.boed</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.boed.AuxEntry" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">AuxEntry</span>


</h3>


    <div class="doc doc-contents ">



        <p>The auxillary entry returned by loss function</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AuxEntry</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The auxillary entry returned by loss function&quot;&quot;&quot;</span>

    <span class="n">terms</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">eig</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.boed.safe_shape" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">safe_shape</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">safe_shape</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Safely get the shape of the object</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>a</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expect the object to be jnp.ndarray</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, ...] | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[int, ...] | str: Either return the shape of <code>a</code></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, ...] | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>or string representation of the type</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">safe_shape</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Safely get the shape of the object</span>

<span class="sd">    Args:</span>
<span class="sd">        a (typing.Any): Expect the object to be jnp.ndarray</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[int, ...] | str: Either return the shape of `a`</span>
<span class="sd">        or string representation of the type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.boed.report_shape" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">report_shape</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">report_shape</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n"><span title="jaxtyping.PyTree">PyTree</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jaxtyping.PyTree">PyTree</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Report the shape of pytree</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>a</code>
            </td>
            <td>
                  <code><span title="jaxtyping.PyTree">PyTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pytree to be report.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jaxtyping.PyTree">PyTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jaxtyping.PyTree: The shape of pytree.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report_shape</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">PyTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">PyTree</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Report the shape of pytree</span>

<span class="sd">    Args:</span>
<span class="sd">        a (jaxtyping.PyTree): The pytree to be report.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jaxtyping.PyTree: The shape of pytree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">safe_shape</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.boed.lexpand" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">lexpand</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lexpand</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="o">*</span><span class="n">dimensions</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Expand tensor, adding new dimensions on left.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>a</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>expand the dimension on the left with given dimension arguments.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: New array with shape (*dimension + a.shape)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lexpand</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">*</span><span class="n">dimensions</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Expand tensor, adding new dimensions on left.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (jnp.ndarray): expand the dimension on the left with given dimension arguments.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: New array with shape (*dimension + a.shape)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dimensions</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.boed.random_split_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">random_split_index</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">random_split_index</span><span class="p">(</span>
    <span class="n">rng_key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n">test_size</span><span class="p">:</span> <span class="n"><span title="int">int</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create the randomly spilt of indice to two set, with one of test_size and another as the rest.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rng_key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_samples</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of total sample size</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of test set</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[jnp.ndarray, jnp.ndarray]: Array of train indice and array of test indice.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">random_split_index</span><span class="p">(</span>
    <span class="n">rng_key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">test_size</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the randomly spilt of indice to two set, with one of test_size and another as the rest.</span>

<span class="sd">    Args:</span>
<span class="sd">        rng_key (jnp.ndarray): The random key</span>
<span class="sd">        num_samples (int): The size of total sample size</span>
<span class="sd">        test_size (int): The size of test set</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[jnp.ndarray, jnp.ndarray]: Array of train indice and array of test indice.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_samples</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">idx</span><span class="p">[</span><span class="n">test_size</span><span class="p">:],</span> <span class="n">idx</span><span class="p">[:</span><span class="n">test_size</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.boed.marginal_loss" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">marginal_loss</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">marginal_loss</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">marginal_guide</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">design</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">observation_labels</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">],</span>
    <span class="n">target_labels</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">],</span>
    <span class="n">num_particles</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">evaluation</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
    <span class="p">[</span><span class="n"><span title="chex.ArrayTree">ArrayTree</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="            AuxEntry (src.inspeqtor.v1.boed.AuxEntry)" href="#src.inspeqtor.v1.boed.AuxEntry">AuxEntry</a></span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The marginal loss implemented following
https://docs.pyro.ai/en/dev/contrib.oed.html#pyro.contrib.oed.eig.marginal_eig</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probabilistic model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>marginal_guide</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The custom guide</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>design</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Possible designs of the experiment</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>observation_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of string of observations</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target latent parameters to be optimized for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_particles</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of independent trials</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evaluation</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True for actual evalution of the EIG. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="chex.ArrayTree">ArrayTree</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="tuple">tuple</span>[<span title="jax.numpy.ndarray">ndarray</span>, <a class="autorefs autorefs-internal" title="            AuxEntry (src.inspeqtor.v1.boed.AuxEntry)" href="#src.inspeqtor.v1.boed.AuxEntry">AuxEntry</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable[ [chex.ArrayTree, jnp.ndarray], tuple[jnp.ndarray, AuxEntry] ]: Loss function that return tuple of (1) Total loss, (2.1) Each terms without the average, (2.2) The EIG</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">marginal_loss</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">marginal_guide</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">design</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">observation_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">target_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">num_particles</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">evaluation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">AuxEntry</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The marginal loss implemented following</span>
<span class="sd">    https://docs.pyro.ai/en/dev/contrib.oed.html#pyro.contrib.oed.eig.marginal_eig</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Callable): The probabilistic model</span>
<span class="sd">        marginal_guide (typing.Callable): The custom guide</span>
<span class="sd">        design (jnp.ndarray): Possible designs of the experiment</span>
<span class="sd">        observation_labels (list[str]): The list of string of observations</span>
<span class="sd">        target_labels (list[str]): The target latent parameters to be optimized for</span>
<span class="sd">        num_particles (int): The number of independent trials</span>
<span class="sd">        evaluation (bool, optional): True for actual evalution of the EIG. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable[ [chex.ArrayTree, jnp.ndarray], tuple[jnp.ndarray, AuxEntry] ]: Loss function that return tuple of (1) Total loss, (2.1) Each terms without the average, (2.2) The EIG</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Marginal loss</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">AuxEntry</span><span class="p">]:</span>
        <span class="n">expanded_design</span> <span class="o">=</span> <span class="n">lexpand</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="n">num_particles</span><span class="p">)</span>
        <span class="c1"># vectorized(model, num_particles)</span>
        <span class="c1"># Sample from p(y | d)</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">subkey</span><span class="p">))</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span>
            <span class="n">expanded_design</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">y_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">observation_label</span><span class="p">:</span> <span class="n">trace</span><span class="p">[</span><span class="n">observation_label</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">observation_label</span> <span class="ow">in</span> <span class="n">observation_labels</span>
        <span class="p">}</span>

        <span class="c1"># Run through q(y | d)</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">conditioned_marginal_guide</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">marginal_guide</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">y_dict</span><span class="p">)</span>
        <span class="n">cond_trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span>
            <span class="n">handlers</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span>
                <span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">conditioned_marginal_guide</span><span class="p">,</span> <span class="n">subkey</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">param</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span>
            <span class="n">expanded_design</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="n">observation_labels</span><span class="o">=</span><span class="n">observation_labels</span><span class="p">,</span>
            <span class="n">target_labels</span><span class="o">=</span><span class="n">target_labels</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># Compute the log prob of observing the data</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">cond_trace</span><span class="p">[</span><span class="n">observation_label</span><span class="p">][</span><span class="s2">&quot;fn&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span>
                    <span class="n">cond_trace</span><span class="p">[</span><span class="n">observation_label</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">observation_label</span> <span class="ow">in</span> <span class="n">observation_labels</span>
            <span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">evaluation</span><span class="p">:</span>
            <span class="n">terms</span> <span class="o">+=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">trace</span><span class="p">[</span><span class="n">observation_label</span><span class="p">][</span><span class="s2">&quot;fn&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span>
                        <span class="n">trace</span><span class="p">[</span><span class="n">observation_label</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">observation_label</span> <span class="ow">in</span> <span class="n">observation_labels</span>
                <span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">agg_loss</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">_safe_mean_terms_v2</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">agg_loss</span><span class="p">,</span> <span class="n">AuxEntry</span><span class="p">(</span><span class="n">terms</span><span class="o">=</span><span class="n">terms</span><span class="p">,</span> <span class="n">eig</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">loss_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.boed.vnmc_eig_loss" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">vnmc_eig_loss</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">vnmc_eig_loss</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">marginal_guide</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">design</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">observation_labels</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">],</span>
    <span class="n">target_labels</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">],</span>
    <span class="n">num_particles</span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n"><span title="int">int</span></span><span class="p">],</span>
    <span class="n">evaluation</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
    <span class="p">[</span><span class="n"><span title="chex.ArrayTree">ArrayTree</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="            AuxEntry (src.inspeqtor.v1.boed.AuxEntry)" href="#src.inspeqtor.v1.boed.AuxEntry">AuxEntry</a></span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The VNMC loss implemented following
https://docs.pyro.ai/en/dev/_modules/pyro/contrib/oed/eig.html#vnmc_eig</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probabilistic model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>marginal_guide</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The custom guide</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>design</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Possible designs of the experiment</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>observation_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of string of observations</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target latent parameters to be optimized for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_particles</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of independent trials</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evaluation</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True for actual evalution of the EIG. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="chex.ArrayTree">ArrayTree</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="tuple">tuple</span>[<span title="jax.numpy.ndarray">ndarray</span>, <a class="autorefs autorefs-internal" title="            AuxEntry (src.inspeqtor.v1.boed.AuxEntry)" href="#src.inspeqtor.v1.boed.AuxEntry">AuxEntry</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable[ [chex.ArrayTree, jnp.ndarray], tuple[jnp.ndarray, AuxEntry] ]: Loss function that return tuple of (1) Total loss, (2.1) Each terms without the average, (2.2) The EIG</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@warn_not_tested_function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">vnmc_eig_loss</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">marginal_guide</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">design</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">observation_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">target_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">num_particles</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="n">evaluation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">AuxEntry</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The VNMC loss implemented following</span>
<span class="sd">    https://docs.pyro.ai/en/dev/_modules/pyro/contrib/oed/eig.html#vnmc_eig</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Callable): The probabilistic model</span>
<span class="sd">        marginal_guide (typing.Callable): The custom guide</span>
<span class="sd">        design (jnp.ndarray): Possible designs of the experiment</span>
<span class="sd">        observation_labels (list[str]): The list of string of observations</span>
<span class="sd">        target_labels (list[str]): The target latent parameters to be optimized for</span>
<span class="sd">        num_particles (int): The number of independent trials</span>
<span class="sd">        evaluation (bool, optional): True for actual evalution of the EIG. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable[ [chex.ArrayTree, jnp.ndarray], tuple[jnp.ndarray, AuxEntry] ]: Loss function that return tuple of (1) Total loss, (2.1) Each terms without the average, (2.2) The EIG</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Marginal loss</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">AuxEntry</span><span class="p">]:</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">num_particles</span>

        <span class="n">expanded_design</span> <span class="o">=</span> <span class="n">lexpand</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

        <span class="c1"># Sample from p(y, theta | d)</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">subkey</span><span class="p">))</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span>
            <span class="n">expanded_design</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">y_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">observation_label</span><span class="p">:</span> <span class="n">trace</span><span class="p">[</span><span class="n">observation_label</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">observation_label</span> <span class="ow">in</span> <span class="n">observation_labels</span>
        <span class="p">}</span>

        <span class="c1"># Sample M times from q(theta | y, d) for each y</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">reexpanded_design</span> <span class="o">=</span> <span class="n">lexpand</span><span class="p">(</span><span class="n">expanded_design</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
        <span class="n">conditioned_marginal_guide</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">marginal_guide</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">y_dict</span><span class="p">)</span>
        <span class="n">cond_trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span>
            <span class="n">handlers</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span>
                <span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">conditioned_marginal_guide</span><span class="p">,</span> <span class="n">subkey</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">param</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span>
            <span class="n">reexpanded_design</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="n">observation_labels</span><span class="o">=</span><span class="n">observation_labels</span><span class="p">,</span>
            <span class="n">target_labels</span><span class="o">=</span><span class="n">target_labels</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">theta_y_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">target_label</span><span class="p">:</span> <span class="n">cond_trace</span><span class="p">[</span><span class="n">target_label</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">target_label</span> <span class="ow">in</span> <span class="n">target_labels</span>
        <span class="p">}</span>
        <span class="n">theta_y_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">y_dict</span><span class="p">)</span>

        <span class="c1"># Re-run that through the model to compute the joint</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">conditioned_model</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">theta_y_dict</span><span class="p">)</span>
        <span class="n">conditioned_model_trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span>
            <span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">conditioned_model</span><span class="p">,</span> <span class="n">subkey</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span>
            <span class="n">reexpanded_design</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Compute the log prob of observing the data</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">cond_trace</span><span class="p">[</span><span class="n">target_label</span><span class="p">][</span><span class="s2">&quot;fn&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span>
                    <span class="n">cond_trace</span><span class="p">[</span><span class="n">target_label</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">target_label</span> <span class="ow">in</span> <span class="n">target_labels</span>
            <span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">terms</span> <span class="o">+=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">conditioned_model_trace</span><span class="p">[</span><span class="n">target_label</span><span class="p">][</span><span class="s2">&quot;fn&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span>
                    <span class="n">conditioned_model_trace</span><span class="p">[</span><span class="n">target_label</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">target_label</span> <span class="ow">in</span> <span class="n">target_labels</span>
            <span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">terms</span> <span class="o">+=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">conditioned_model_trace</span><span class="p">[</span><span class="n">observation_label</span><span class="p">][</span><span class="s2">&quot;fn&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span>
                    <span class="n">conditioned_model_trace</span><span class="p">[</span><span class="n">observation_label</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">observation_label</span> <span class="ow">in</span> <span class="n">observation_labels</span>
            <span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">terms</span> <span class="o">=</span> <span class="o">-</span><span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">logsumexp</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">evaluation</span><span class="p">:</span>
            <span class="n">terms</span> <span class="o">+=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">trace</span><span class="p">[</span><span class="n">observation_label</span><span class="p">][</span><span class="s2">&quot;fn&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span>
                        <span class="n">trace</span><span class="p">[</span><span class="n">observation_label</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">observation_label</span> <span class="ow">in</span> <span class="n">observation_labels</span>
                <span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">agg_loss</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">_safe_mean_terms_v2</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">agg_loss</span><span class="p">,</span> <span class="n">AuxEntry</span><span class="p">(</span><span class="n">terms</span><span class="o">=</span><span class="n">terms</span><span class="p">,</span> <span class="n">eig</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">loss_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.boed.init_params_from_guide" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">init_params_from_guide</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">init_params_from_guide</span><span class="p">(</span>
    <span class="n">marginal_guide</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">design</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="chex.ArrayTree">ArrayTree</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initlalize parameters of marginal guide.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>marginal_guide</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Marginal guide to be used with marginal eig</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random Key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>design</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Example of the designs of the experiment</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="chex.ArrayTree">ArrayTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>chex.ArrayTree: Random parameters for marginal guide to be optimized.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">init_params_from_guide</span><span class="p">(</span>
    <span class="n">marginal_guide</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">design</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initlalize parameters of marginal guide.</span>

<span class="sd">    Args:</span>
<span class="sd">        marginal_guide (typing.Callable): Marginal guide to be used with marginal eig</span>
<span class="sd">        key (jnp.ndarray): Random Key</span>
<span class="sd">        design (jnp.ndarray): Example of the designs of the experiment</span>

<span class="sd">    Returns:</span>
<span class="sd">        chex.ArrayTree: Random parameters for marginal guide to be optimized.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="c1"># expanded_design = lexpand(design, num_particles)</span>
    <span class="n">marginal_guide_trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span>
        <span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">marginal_guide</span><span class="p">,</span> <span class="n">subkey</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">observation_labels</span><span class="o">=</span><span class="p">[],</span> <span class="n">target_labels</span><span class="o">=</span><span class="p">[])</span>

    <span class="c1"># Get only nodes that are parameters</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">node</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">marginal_guide_trace</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;param&quot;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.boed.opt_eig_ape_loss" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">opt_eig_ape_loss</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">opt_eig_ape_loss</span><span class="p">(</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[</span><span class="n"><span title="chex.ArrayTree">ArrayTree</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="            AuxEntry (src.inspeqtor.v1.boed.AuxEntry)" href="#src.inspeqtor.v1.boed.AuxEntry">AuxEntry</a></span><span class="p">]</span>
    <span class="p">],</span>
    <span class="n">params</span><span class="p">:</span> <span class="n"><span title="chex.ArrayTree">ArrayTree</span></span><span class="p">,</span>
    <span class="n">num_steps</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">optim</span><span class="p">:</span> <span class="n"><span title="optax.GradientTransformation">GradientTransformation</span></span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="chex.ArrayTree">ArrayTree</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Optimize the EIG loss function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="chex.ArrayTree">ArrayTree</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="tuple">tuple</span>[<span title="jax.numpy.ndarray">ndarray</span>, <a class="autorefs autorefs-internal" title="            AuxEntry (src.inspeqtor.v1.boed.AuxEntry)" href="#src.inspeqtor.v1.boed.AuxEntry">AuxEntry</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loss function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="chex.ArrayTree">ArrayTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial parameter</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of optimization step</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optim</code>
            </td>
            <td>
                  <code><span title="optax.GradientTransformation">GradientTransformation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optax Optimizer</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="chex.ArrayTree">ArrayTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[chex.ArrayTree, list[typing.Any]]: Optimized parameters, and optimization history.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">opt_eig_ape_loss</span><span class="p">(</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span>
        <span class="p">[</span><span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">AuxEntry</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span><span class="p">,</span>
    <span class="n">num_steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">optim</span><span class="p">:</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformation</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optimize the EIG loss function.</span>

<span class="sd">    Args:</span>
<span class="sd">        loss_fn (typing.Callable[[chex.ArrayTree, jnp.ndarray], tuple[jnp.ndarray, AuxEntry]]): Loss function</span>
<span class="sd">        params (chex.ArrayTree): Initial parameter</span>
<span class="sd">        num_steps (int): Number of optimization step</span>
<span class="sd">        optim (optax.GradientTransformation): Optax Optimizer</span>
<span class="sd">        key (jnp.ndarray): Random key</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[chex.ArrayTree, list[typing.Any]]: Optimized parameters, and optimization history.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize the optimizer</span>
    <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="c1"># jit the loss function</span>
    <span class="n">loss_fn</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="c1"># Compute the loss and its gradient</span>
        <span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">aux</span><span class="p">),</span> <span class="n">grad</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">value_and_grad</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">has_aux</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">params</span><span class="p">,</span> <span class="n">subkey</span><span class="p">)</span>
        <span class="c1"># Update the optimizer and params</span>
        <span class="n">updates</span><span class="p">,</span> <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">grad</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">apply_updates</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">updates</span><span class="p">)</span>

        <span class="c1"># entry = (step, loss, aux)</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">HistoryEntry</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">aux</span><span class="o">=</span><span class="n">aux</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
            <span class="n">callback</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.boed.estimate_eig" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">estimate_eig</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">estimate_eig</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">marginal_guide</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">design</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n"><span title="optax.GradientTransformation">GradientTransformation</span></span><span class="p">,</span>
    <span class="n">num_optimization_steps</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">observation_labels</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">],</span>
    <span class="n">target_labels</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">],</span>
    <span class="n">num_particles</span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n"><span title="int">int</span></span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">final_num_particles</span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n"><span title="int">int</span></span><span class="p">]</span>
    <span class="o">|</span> <span class="n"><span title="int">int</span></span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            marginal_loss (src.inspeqtor.v1.boed.marginal_loss)" href="#src.inspeqtor.v1.boed.marginal_loss">marginal_loss</a></span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Optimize for marginal EIG</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Probabilistic model of the experiment</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>marginal_guide</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The marginal guide of the experiment</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>design</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Possible designs of the experiment</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
                  <code><span title="optax.GradientTransformation">GradientTransformation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optax optimizer</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_optimization_steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of the optimization step</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>observation_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of string of observations</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target latent parameters to be optimized for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_particles</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of independent trials</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>final_num_particles</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Final independent trials to calculate marginal EIG. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="jax.numpy.ndarray">ndarray</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[jnp.ndarray, dict[str, typing.Any]]: EIG, and tuple of optimized parameters and optimization history.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">estimate_eig</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">marginal_guide</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">design</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformation</span><span class="p">,</span>
    <span class="n">num_optimization_steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">observation_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">target_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">num_particles</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">final_num_particles</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span> <span class="o">=</span> <span class="n">marginal_loss</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optimize for marginal EIG</span>

<span class="sd">    Args:</span>
<span class="sd">        key (jnp.ndarray): Random key</span>
<span class="sd">        model (typing.Callable): Probabilistic model of the experiment</span>
<span class="sd">        marginal_guide (typing.Callable): The marginal guide of the experiment</span>
<span class="sd">        design (jnp.ndarray): Possible designs of the experiment</span>
<span class="sd">        optimizer (optax.GradientTransformation): Optax optimizer</span>
<span class="sd">        num_optimization_steps (int): Number of the optimization step</span>
<span class="sd">        observation_labels (list[str]): The list of string of observations</span>
<span class="sd">        target_labels (list[str]): The target latent parameters to be optimized for</span>
<span class="sd">        num_particles (int): The number of independent trials</span>
<span class="sd">        final_num_particles (int | None, optional): Final independent trials to calculate marginal EIG. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[jnp.ndarray, dict[str, typing.Any]]: EIG, and tuple of optimized parameters and optimization history.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># NOTE: In final evalution, if final_num_particles != num_particles,</span>
    <span class="c1"># the code will error because we train params with num_particles</span>
    <span class="c1"># the shape will mismatch</span>
    <span class="c1"># final_num_particles = final_num_particles or num_particles</span>

    <span class="c1"># Initialize the parameters by using trace from the marginal_guide</span>
    <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">init_params_from_guide</span><span class="p">(</span>
        <span class="n">marginal_guide</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="n">subkey</span><span class="p">,</span>
        <span class="n">design</span><span class="o">=</span><span class="n">design</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Optimize the loss function first to get the optimal parameters</span>
    <span class="c1"># for marginal guide</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">opt_eig_ape_loss</span><span class="p">(</span>
        <span class="n">loss_fn</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="n">marginal_guide</span><span class="p">,</span>
            <span class="n">design</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="n">observation_labels</span><span class="o">=</span><span class="n">observation_labels</span><span class="p">,</span>
            <span class="n">target_labels</span><span class="o">=</span><span class="n">target_labels</span><span class="p">,</span>
            <span class="n">num_particles</span><span class="o">=</span><span class="n">num_particles</span><span class="p">,</span>
            <span class="n">evaluation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_optimization_steps</span><span class="p">,</span>
        <span class="n">optim</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="n">subkey</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="c1"># Evaluate the loss</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">aux</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="n">marginal_guide</span><span class="p">,</span>
        <span class="n">design</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="n">observation_labels</span><span class="o">=</span><span class="n">observation_labels</span><span class="p">,</span>
        <span class="n">target_labels</span><span class="o">=</span><span class="n">target_labels</span><span class="p">,</span>
        <span class="n">num_particles</span><span class="o">=</span><span class="n">final_num_particles</span><span class="p">,</span>
        <span class="n">evaluation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)(</span><span class="n">params</span><span class="p">,</span> <span class="n">subkey</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">aux</span><span class="o">.</span><span class="n">eig</span><span class="p">,</span> <span class="p">{</span>
        <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.boed.vectorized_for_eig" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">vectorized_for_eig</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">vectorized_for_eig</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Vectorization function for the EIG function</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Probabilistic model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/boed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">vectorized_for_eig</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Vectorization function for the EIG function</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Any): Probabilistic model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span>
        <span class="n">design</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># This wrapper has the same call signature as the probabilistic graybox model</span>
        <span class="c1"># Expect the design to has shape == (extra, design, feature)</span>
        <span class="k">with</span> <span class="n">plate_stack</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;vectorized_plate&quot;</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">design</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]]):</span>
            <span class="k">return</span> <span class="n">model</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="constant">Constant</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.constant" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.constant</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="control">Control</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.control" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.control</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.control.BaseControl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BaseControl</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">










              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BaseControl</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="c1"># duration: int</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.t_eval = jnp.arange(0, self.duration, 1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Validate that all attributes are json serializable</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot serialize </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> to json&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">()</span>
        <span class="c1"># Validate that the sampling function is working</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">sample_params</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
        <span class="c1"># waveform = self.get_waveform(params)</span>

        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">()]),</span> <span class="p">(</span>
            <span class="s2">&quot;All key of params dict must be string&quot;</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span> <span class="ow">or</span> <span class="nb">all</span><span class="p">(</span>
            <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="p">),</span> <span class="s2">&quot;All value of params dict must be float&quot;</span>
        <span class="c1"># assert isinstance(waveform, jax.Array), &quot;Waveform must be jax.Array&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_bounds</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwarg</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">,</span> <span class="n">ParametersDictType</span><span class="p">]:</span> <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">ParametersDictType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;get_envelopes method is not implemented&quot;</span><span class="p">)</span>

    <span class="c1"># def get_waveform(self, params: ParametersDictType) -&gt; jnp.ndarray:</span>
    <span class="c1">#     &quot;&quot;&quot;Get the discrete waveform of the pulse</span>

    <span class="c1">#     Args:</span>
    <span class="c1">#         params (ParametersDictType): Control parameter</span>

    <span class="c1">#     Returns:</span>
    <span class="c1">#         jnp.ndarray: Waveform of the control.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     return jax.vmap(self.get_envelope(params), in_axes=(0,))((self.t_eval))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the control configuration to dictionary</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[str, typing.Union[int, float, str]]: Configuration of the control</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct the control instace from the dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (dict): Dictionary for construction of the control instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The instance of the control.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.BaseControl.to_dict" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_dict</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_dict</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n"><span title="float">float</span></span><span class="p">,</span> <span class="n"><span title="str">str</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the control configuration to dictionary</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="float">float</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, typing.Union[int, float, str]]: Configuration of the control</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the control configuration to dictionary</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, typing.Union[int, float, str]]: Configuration of the control</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.BaseControl.from_dict" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_dict</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct the control instace from the dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary for construction of the control instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The instance of the control.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the control instace from the dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict): Dictionary for construction of the control instance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The instance of the control.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.control.ControlSequenceProtocol" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ControlSequenceProtocol</span>


</h3>


    <div class="doc doc-contents ">



        <p>Protocol defining the interface for control sequences.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ControlSequenceProtocol</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Protocol defining the interface for control sequences.&quot;&quot;&quot;</span>

    <span class="c1"># Attributes</span>
    <span class="n">controls</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BaseControl</span><span class="p">]</span>
    <span class="n">total_dt</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the structure/order of control parameters.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ParametersDictType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample control parameters using a random key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key: Random key for sampling</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of sampled control parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_bounds</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ParametersDictType</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ParametersDictType</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the bounds of the controls.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of lower and upper bounds dictionaries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_envelope</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">params_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ParametersDictType</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create envelope function with given control parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            params_dict: Control parameters to be used</span>

<span class="sd">        Returns:</span>
<span class="sd">            Envelope function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the control sequence to a dictionary representation.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]],</span>
        <span class="n">controls</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a control sequence from dictionary data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: Dictionary containing control sequence data</span>
<span class="sd">            controls: Dictionary mapping control names to control classes</span>

<span class="sd">        Returns:</span>
<span class="sd">            New control sequence instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save configuration to file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to save the sequence configuration</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">controls</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load control sequence from file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to load the sequence configuration from</span>
<span class="sd">            controls: Dictionary mapping control names to control classes</span>

<span class="sd">        Returns:</span>
<span class="sd">            New control sequence instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequenceProtocol.get_structure" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_structure</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_structure</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="str">str</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the structure/order of control parameters.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the structure/order of control parameters.&quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequenceProtocol.sample_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">sample_params</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample_params</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.Array">Array</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample control parameters using a random key.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key for sampling</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of sampled control parameters</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ParametersDictType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sample control parameters using a random key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key: Random key for sampling</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of sampled control parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequenceProtocol.get_bounds" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_bounds</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_bounds</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span>
    <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">],</span>
    <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the bounds of the controls.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>], <span title="dict">dict</span>[<span title="str">str</span>, <span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of lower and upper bounds dictionaries</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_bounds</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ParametersDictType</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ParametersDictType</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the bounds of the controls.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of lower and upper bounds dictionaries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequenceProtocol.get_envelope" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_envelope</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_envelope</span><span class="p">(</span>
    <span class="n">params_dict</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create envelope function with given control parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control parameters to be used</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Envelope function</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_envelope</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">params_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ParametersDictType</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create envelope function with given control parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        params_dict: Control parameters to be used</span>

<span class="sd">    Returns:</span>
<span class="sd">        Envelope function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequenceProtocol.to_dict" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_dict</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_dict</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the control sequence to a dictionary representation.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the control sequence to a dictionary representation.&quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequenceProtocol.from_dict" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_dict</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_dict</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span><span class="p">]],</span>
    <span class="n">controls</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            BaseControl


  
      dataclass
   (src.inspeqtor.v1.control.BaseControl)" href="#src.inspeqtor.v1.control.BaseControl">BaseControl</a></span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Self">Self</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a control sequence from dictionary data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span> | <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing control sequence data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>controls</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="type">type</span>[<a class="autorefs autorefs-internal" title="            BaseControl


  
      dataclass
   (src.inspeqtor.v1.control.BaseControl)" href="#src.inspeqtor.v1.control.BaseControl">BaseControl</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping control names to control classes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New control sequence instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">controls</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a control sequence from dictionary data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Dictionary containing control sequence data</span>
<span class="sd">        controls: Dictionary mapping control names to control classes</span>

<span class="sd">    Returns:</span>
<span class="sd">        New control sequence instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequenceProtocol.to_file" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_file</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Save configuration to file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the sequence configuration</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save configuration to file.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to save the sequence configuration</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequenceProtocol.from_file" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_file</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">,</span> <span class="n">controls</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            BaseControl


  
      dataclass
   (src.inspeqtor.v1.control.BaseControl)" href="#src.inspeqtor.v1.control.BaseControl">BaseControl</a></span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Self">Self</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load control sequence from file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to load the sequence configuration from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>controls</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="type">type</span>[<a class="autorefs autorefs-internal" title="            BaseControl


  
      dataclass
   (src.inspeqtor.v1.control.BaseControl)" href="#src.inspeqtor.v1.control.BaseControl">BaseControl</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping control names to control classes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New control sequence instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">controls</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load control sequence from file.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to load the sequence configuration from</span>
<span class="sd">        controls: Dictionary mapping control names to control classes</span>

<span class="sd">    Returns:</span>
<span class="sd">        New control sequence instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.control.ControlSequence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ControlSequence</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Control sequence, expect to be sum of atomic control.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ControlSequence</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Control sequence, expect to be sum of atomic control.&quot;&quot;&quot;</span>

    <span class="n">controls</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]</span>
    <span class="n">total_dt</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># validate that each pulse have len of total_dt</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Must check that the sum of the pulse lengths is equal to the total length of the pulse sequence</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">subkeys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">pulse_key</span><span class="p">,</span> <span class="n">pulse</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subkeys</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">):</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">sample_params</span><span class="p">(</span><span class="n">pulse_key</span><span class="p">,</span> <span class="o">*</span><span class="n">pulse</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">())</span>
            <span class="c1"># waveform = pulse.get_waveform(params)</span>
            <span class="c1"># assert isinstance(waveform, jax.Array)</span>
            <span class="c1"># Assert the waveform is of the correct length</span>
            <span class="c1"># assert waveform.shape == (self.total_dt,)</span>
            <span class="c1"># Assert that all key of params dict is string and all value is jax.Array</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">()]),</span> <span class="p">(</span>
                <span class="s2">&quot;All key of params dict must be string&quot;</span>
            <span class="p">)</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
                <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
            <span class="p">),</span> <span class="s2">&quot;All value of params dict must be float or jax.Array&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_params</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="c1"># Assert that the bounds have the same pytree structure as the parameters</span>
        <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">()</span>

        <span class="k">assert</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span> <span class="o">==</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span> <span class="o">==</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample control parameter</span>

<span class="sd">        Args:</span>
<span class="sd">            key (jax.Array): Random key</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[ParametersDictType]: control parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Split key for each pulse</span>
        <span class="n">subkeys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">))</span>

        <span class="n">params_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pulse_key</span><span class="p">,</span> <span class="n">pulse</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subkeys</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">):</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">sample_params</span><span class="p">(</span><span class="n">pulse_key</span><span class="p">,</span> <span class="o">*</span><span class="n">pulse</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">())</span>
            <span class="n">params_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">params_list</span>

    <span class="c1"># def get_waveform(self, params_list: list[ParametersDictType]) -&gt; jnp.ndarray:</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Samples the pulse sequence by generating random parameters for each pulse and computing the total waveform.</span>

    <span class="c1">#     Parameters:</span>
    <span class="c1">#         key (Key): The random key used for generating the parameters.</span>

    <span class="c1">#     Returns:</span>
    <span class="c1">#         tuple[list[ParametersDictType], Complex[Array, &quot;time&quot;]]: A tuple containing a list of parameter dictionaries for each pulse and the total waveform.</span>

    <span class="c1">#     Example:</span>
    <span class="c1">#         key = jax.random.PRNGKey(0)</span>
    <span class="c1">#         params_list, total_waveform = sample(key)</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     # Create base waveform</span>
    <span class="c1">#     total_waveform = jnp.zeros(self.total_dt, dtype=jnp.complex64)</span>

    <span class="c1">#     for _params, _pulse in zip(params_list, self.controls):</span>
    <span class="c1">#         waveform = _pulse.get_waveform(_params)</span>
    <span class="c1">#         total_waveform += waveform</span>

    <span class="c1">#     return total_waveform</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create envelope function with given control parameters</span>

<span class="sd">        Args:</span>
<span class="sd">            params_list (list[ParametersDictType]): control parameter to be used</span>

<span class="sd">        Returns:</span>
<span class="sd">            typing.Callable: Envelope function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">callables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_params</span><span class="p">,</span> <span class="n">_pulse</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">params_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">):</span>
            <span class="n">callables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_pulse</span><span class="o">.</span><span class="n">get_envelope</span><span class="p">(</span><span class="n">_params</span><span class="p">))</span>

        <span class="c1"># Create a function that returns the sum of the envelopes</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">envelope</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">callables</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">envelope</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the bounds of the controls</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[list[ParametersDictType], list[ParametersDictType]]: tuple of list of lower and upper bounds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lower_bounds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">upper_bounds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pulse</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">:</span>
            <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">pulse</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">()</span>
            <span class="n">lower_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
            <span class="n">upper_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_parameter_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of the control parameters in the control sequence.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[list[str]]: Structured name of control parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Sample the pulse sequence to get the parameter names</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">params_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_params</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="c1"># Get the parameter names for each pulse</span>
        <span class="n">parameter_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">params_list</span><span class="p">:</span>
            <span class="n">parameter_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

        <span class="k">return</span> <span class="n">parameter_names</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert control sequence to dictionary.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[str, typing.Any]: Control sequence configuration dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="o">**</span><span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="s2">&quot;controls&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="o">**</span><span class="n">pulse</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="s2">&quot;_name&quot;</span><span class="p">:</span> <span class="n">pulse</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">}</span>
                <span class="k">for</span> <span class="n">pulse</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span>
            <span class="p">],</span>
        <span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">controls</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ControlSequence&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct the control sequence from dict.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (dict[str, typing.Any]): Dict contain information for sequence construction</span>
<span class="sd">            control (typing.Sequence[type[BasePulse]]): Constructor of the controls</span>

<span class="sd">        Returns:</span>
<span class="sd">            ControlSequence: Instance of the control sequence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">pulse</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;controls&quot;</span><span class="p">],</span> <span class="n">controls</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Expected dict, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="c1"># remove the _name key</span>
            <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;_name&quot;</span><span class="p">)</span>
            <span class="n">parsed_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pulse</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>

        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;controls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_data</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;validate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save configuration of the pulse to file given folder path.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (typing.Union[str, pathlib.Path]): Path to the folder to save sequence, will be created if not existed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;control_sequence.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
        <span class="n">controls</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ControlSequence&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct control seqence from path</span>

<span class="sd">        Args:</span>
<span class="sd">            path (typing.Union[str, pathlib.Path]): Path to configuration of control sequence.</span>
<span class="sd">            controls (typing.Sequence[type[BasePulse]]): Constructor of the control in the sequence.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ControlSequence: Control sequence instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;control_sequence.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">dict_control_sequence</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dict_control_sequence</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="n">controls</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequence.sample_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">sample_params</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample_params</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.Array">Array</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample control parameter</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[ParametersDictType]: control parameters</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sample control parameter</span>

<span class="sd">    Args:</span>
<span class="sd">        key (jax.Array): Random key</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[ParametersDictType]: control parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Split key for each pulse</span>
    <span class="n">subkeys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">))</span>

    <span class="n">params_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pulse_key</span><span class="p">,</span> <span class="n">pulse</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subkeys</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">):</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">sample_params</span><span class="p">(</span><span class="n">pulse_key</span><span class="p">,</span> <span class="o">*</span><span class="n">pulse</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">())</span>
        <span class="n">params_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">params_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequence.get_envelope" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_envelope</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_envelope</span><span class="p">(</span>
    <span class="n">params_list</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create envelope function with given control parameters</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>control parameter to be used</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable: Envelope function</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create envelope function with given control parameters</span>

<span class="sd">    Args:</span>
<span class="sd">        params_list (list[ParametersDictType]): control parameter to be used</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable: Envelope function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">callables</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_params</span><span class="p">,</span> <span class="n">_pulse</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">params_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">):</span>
        <span class="n">callables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_pulse</span><span class="o">.</span><span class="n">get_envelope</span><span class="p">(</span><span class="n">_params</span><span class="p">))</span>

    <span class="c1"># Create a function that returns the sum of the envelopes</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">envelope</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">callables</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">envelope</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequence.get_bounds" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_bounds</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_bounds</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span>
    <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">],</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the bounds of the controls</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>], <span title="list">list</span>[<span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[list[ParametersDictType], list[ParametersDictType]]: tuple of list of lower and upper bounds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the bounds of the controls</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[list[ParametersDictType], list[ParametersDictType]]: tuple of list of lower and upper bounds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lower_bounds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">upper_bounds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pulse</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">:</span>
        <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">pulse</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">()</span>
        <span class="n">lower_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
        <span class="n">upper_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequence.get_parameter_names" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_parameter_names</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_parameter_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the name of the control parameters in the control sequence.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[list[str]]: Structured name of control parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_parameter_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the name of the control parameters in the control sequence.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[list[str]]: Structured name of control parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Sample the pulse sequence to get the parameter names</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">params_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_params</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="c1"># Get the parameter names for each pulse</span>
    <span class="n">parameter_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">params_list</span><span class="p">:</span>
        <span class="n">parameter_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

    <span class="k">return</span> <span class="n">parameter_names</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequence.to_dict" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_dict</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_dict</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert control sequence to dictionary.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, typing.Any]: Control sequence configuration dict.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert control sequence to dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, typing.Any]: Control sequence configuration dict.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="o">**</span><span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
        <span class="s2">&quot;controls&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="o">**</span><span class="n">pulse</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="s2">&quot;_name&quot;</span><span class="p">:</span> <span class="n">pulse</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">pulse</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controls</span>
        <span class="p">],</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequence.from_dict" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_dict</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_dict</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">],</span>
    <span class="n">controls</span><span class="p">:</span> <span class="n"><span title="typing.Sequence">Sequence</span></span><span class="p">[</span><span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            BaseControl


  
      dataclass
   (src.inspeqtor.v1.control.BaseControl)" href="#src.inspeqtor.v1.control.BaseControl">BaseControl</a></span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct the control sequence from dict.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict contain information for sequence construction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="type">type</span>[<span title="BasePulse">BasePulse</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Constructor of the controls</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ControlSequence</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance of the control sequence.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">controls</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ControlSequence&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the control sequence from dict.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict[str, typing.Any]): Dict contain information for sequence construction</span>
<span class="sd">        control (typing.Sequence[type[BasePulse]]): Constructor of the controls</span>

<span class="sd">    Returns:</span>
<span class="sd">        ControlSequence: Instance of the control sequence.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parsed_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">pulse</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;controls&quot;</span><span class="p">],</span> <span class="n">controls</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Expected dict, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># remove the _name key</span>
        <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;_name&quot;</span><span class="p">)</span>
        <span class="n">parsed_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pulse</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>

    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;controls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_data</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;validate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequence.to_file" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_file</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Save configuration of the pulse to file given folder path.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the folder to save sequence, will be created if not existed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save configuration of the pulse to file given folder path.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (typing.Union[str, pathlib.Path]): Path to the folder to save sequence, will be created if not existed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;control_sequence.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.control.ControlSequence.from_file" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_file</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">],</span>
    <span class="n">controls</span><span class="p">:</span> <span class="n"><span title="typing.Sequence">Sequence</span></span><span class="p">[</span><span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            BaseControl


  
      dataclass
   (src.inspeqtor.v1.control.BaseControl)" href="#src.inspeqtor.v1.control.BaseControl">BaseControl</a></span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct control seqence from path</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to configuration of control sequence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>controls</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="type">type</span>[<span title="BasePulse">BasePulse</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Constructor of the control in the sequence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ControlSequence</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control sequence instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="n">controls</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ControlSequence&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct control seqence from path</span>

<span class="sd">    Args:</span>
<span class="sd">        path (typing.Union[str, pathlib.Path]): Path to configuration of control sequence.</span>
<span class="sd">        controls (typing.Sequence[type[BasePulse]]): Constructor of the control in the sequence.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ControlSequence: Control sequence instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;control_sequence.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">dict_control_sequence</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dict_control_sequence</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="n">controls</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.control.sample_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">sample_params</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample_params</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">lower</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">,</span>
    <span class="n">upper</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample parameters with the same shape with given lower and upper bounds</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lower</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bound</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upper</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bound</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ParametersDictType</code></td>            <td>
                  <code><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of the sampled parameters</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample_params</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">lower</span><span class="p">:</span> <span class="n">ParametersDictType</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="n">ParametersDictType</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParametersDictType</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sample parameters with the same shape with given lower and upper bounds</span>

<span class="sd">    Args:</span>
<span class="sd">        key (jnp.ndarray): Random key</span>
<span class="sd">        lower (ParametersDictType): Lower bound</span>
<span class="sd">        upper (ParametersDictType): Upper bound</span>

<span class="sd">    Returns:</span>
<span class="sd">        ParametersDictType: Dict of the sampled parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This function is general because it is depend only on lower and upper structure</span>
    <span class="n">param</span><span class="p">:</span> <span class="n">ParametersDictType</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">param_names</span> <span class="o">=</span> <span class="n">lower</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">param_names</span><span class="p">:</span>
        <span class="n">sample_key</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">param</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
            <span class="n">sample_key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">minval</span><span class="o">=</span><span class="n">lower</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">maxval</span><span class="o">=</span><span class="n">upper</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="c1"># return jax.tree.map(float, param)</span>
    <span class="k">return</span> <span class="n">param</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.control.array_to_list_of_params" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">array_to_list_of_params</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">array_to_list_of_params</span><span class="p">(</span>
    <span class="n">array</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">parameter_structure</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the array of control parameter to the list form</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control parameter array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parameter_structure</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The structure of the control sequence</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[ParametersDictType]: Control parameter in the list form.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">array_to_list_of_params</span><span class="p">(</span>
    <span class="n">array</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">parameter_structure</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the array of control parameter to the list form</span>

<span class="sd">    Args:</span>
<span class="sd">        array (jnp.ndarray): Control parameter array</span>
<span class="sd">        parameter_structure (list[list[str]]): The structure of the control sequence</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[ParametersDictType]: Control parameter in the list form.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">temp</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">sub_pulse</span> <span class="ow">in</span> <span class="n">parameter_structure</span><span class="p">:</span>
        <span class="n">temp_dict</span><span class="p">:</span> <span class="n">ParametersDictType</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">sub_pulse</span><span class="p">:</span>
            <span class="n">temp_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dict</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">temp</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.control.list_of_params_to_array" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">list_of_params_to_array</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_of_params_to_array</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">],</span>
    <span class="n">parameter_structure</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the control parameter in the list form to flatten array form</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control parameter in the list form</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parameter_structure</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The structure of the control sequence</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Control parameters array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_of_params_to_array</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">],</span> <span class="n">parameter_structure</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the control parameter in the list form to flatten array form</span>

<span class="sd">    Args:</span>
<span class="sd">        params (list[ParametersDictType]): Control parameter in the list form</span>
<span class="sd">        parameter_structure (list[list[str]]): The structure of the control sequence</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Control parameters array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">subp_idx</span><span class="p">,</span> <span class="n">sub_pulse</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parameter_structure</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">sub_pulse</span><span class="p">:</span>
            <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">subp_idx</span><span class="p">][</span><span class="n">param</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.control.get_param_array_converter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_param_array_converter</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_param_array_converter</span><span class="p">(</span>
    <span class="n">control_sequence</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This function returns two functions that can convert between a list of parameter dictionaries and a flat array.</p>
<blockquote>
<blockquote>
<blockquote>
<p>array_to_list_of_params_fn, list_of_params_to_array_fn = get_param_array_converter(control_sequence)</p>
</blockquote>
</blockquote>
</blockquote>
<div class="highlight"><pre><span></span><code>Args:
control_sequence (ControlSequence): The pulse sequence object.
</code></pre></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: A tuple containing two functions. The first function converts an array to a list of parameter dictionaries, and the second function converts a list of parameter dictionaries to an array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_param_array_converter</span><span class="p">(</span><span class="n">control_sequence</span><span class="p">:</span> <span class="n">ControlSequence</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function returns two functions that can convert between a list of parameter dictionaries and a flat array.</span>

<span class="sd">    &gt;&gt;&gt; array_to_list_of_params_fn, list_of_params_to_array_fn = get_param_array_converter(control_sequence)</span>

<span class="sd">        Args:</span>
<span class="sd">        control_sequence (ControlSequence): The pulse sequence object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: A tuple containing two functions. The first function converts an array to a list of parameter dictionaries, and the second function converts a list of parameter dictionaries to an array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="n">control_sequence</span><span class="o">.</span><span class="n">get_parameter_names</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">array_to_list_of_params_fn</span><span class="p">(</span>
        <span class="n">array</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">array_to_list_of_params</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">structure</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_of_params_to_array_fn</span><span class="p">(</span>
        <span class="n">params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">list_of_params_to_array</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">structure</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">array_to_list_of_params_fn</span><span class="p">,</span> <span class="n">list_of_params_to_array_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.control.construct_control_sequence_reader" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">construct_control_sequence_reader</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">construct_control_sequence_reader</span><span class="p">(</span>
    <span class="n">controls</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            BaseControl


  
      dataclass
   (src.inspeqtor.v1.control.BaseControl)" href="#src.inspeqtor.v1.control.BaseControl">BaseControl</a></span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">]],</span> <span class="n"><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct the control sequence reader</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>controls</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="type">type</span>[<span title="BasePulse">BasePulse</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of control constructor. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]], <a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable[[typing.Union[str, pathlib.Path]], controlsequence]: Control sequence reader that will automatically contruct control sequence from path.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">construct_control_sequence_reader</span><span class="p">(</span>
    <span class="n">controls</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]],</span> <span class="n">ControlSequence</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the control sequence reader</span>

<span class="sd">    Args:</span>
<span class="sd">        controls (list[type[BasePulse]], optional): List of control constructor. Defaults to [].</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable[[typing.Union[str, pathlib.Path]], controlsequence]: Control sequence reader that will automatically contruct control sequence from path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default_controls</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">BaseControl</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Merge the default controls with the provided controls</span>
    <span class="n">controls_list</span> <span class="o">=</span> <span class="n">default_controls</span> <span class="o">+</span> <span class="n">controls</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">control_sequence_reader</span><span class="p">(</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ControlSequence</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct control sequence from path</span>

<span class="sd">        Args:</span>
<span class="sd">            path (typing.Union[str, pathlib.Path]): Path of the saved control sequence configuration.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ControlSeqence: Control sequence instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;control_sequence.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">control_sequence_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="n">parsed_controls</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">pulse_dict</span> <span class="ow">in</span> <span class="n">control_sequence_dict</span><span class="p">[</span><span class="s2">&quot;controls&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">control_class</span> <span class="ow">in</span> <span class="n">controls_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pulse_dict</span><span class="p">[</span><span class="s2">&quot;_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">control_class</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
                    <span class="n">parsed_controls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">control_class</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ControlSequence</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
            <span class="n">control_sequence_dict</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="n">parsed_controls</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">control_sequence_reader</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.control.get_envelope_transformer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_envelope_transformer</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_envelope_transformer</span><span class="p">(</span><span class="n">control_sequence</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate get_envelope function with control parameter array as an input instead of list form</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>control_sequence</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control seqence instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable[[jnp.ndarray], typing.Any]: Transformed get envelope function</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/control.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_envelope_transformer</span><span class="p">(</span><span class="n">control_sequence</span><span class="p">:</span> <span class="n">ControlSequence</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate get_envelope function with control parameter array as an input instead of list form</span>

<span class="sd">    Args:</span>
<span class="sd">        control_sequence (ControlSequence): Control seqence instance</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable[[jnp.ndarray], typing.Any]: Transformed get envelope function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="n">control_sequence</span><span class="o">.</span><span class="n">get_parameter_names</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">array_to_list_of_params_fn</span><span class="p">(</span><span class="n">array</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">array_to_list_of_params</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">structure</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_envelope</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">control_sequence</span><span class="o">.</span><span class="n">get_envelope</span><span class="p">(</span><span class="n">array_to_list_of_params_fn</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">get_envelope</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="data">Data</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.data</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.data.Operator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Operator</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Dataclass for accessing qubit operators. Support X, Y, Z, Hadamard, S, Sdg, and I gate.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Provided operator is not supperted</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Operator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataclass for accessing qubit operators. Support X, Y, Z, Hadamard, S, Sdg, and I gate.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Provided operator is not supperted</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_pauli_x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="n">_pauli_y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="n">_pauli_z</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="n">_hadamard</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">_s_gate</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="n">_sdg_gate</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="n">_identity</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the operator from the label</span>

<span class="sd">        Args:</span>
<span class="sd">            op (str): The label of the operator</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Operator not supported</span>

<span class="sd">        Returns:</span>
<span class="sd">            jnp.ndarray: The operator</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_pauli_x</span>
        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;Y&quot;</span><span class="p">:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_pauli_y</span>
        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;Z&quot;</span><span class="p">:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_pauli_z</span>
        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_hadamard</span>
        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;S&quot;</span><span class="p">:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_s_gate</span>
        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;Sdg&quot;</span><span class="p">:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_sdg_gate</span>
        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;I&quot;</span><span class="p">:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_identity</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Operator </span><span class="si">{</span><span class="n">op</span><span class="si">}</span><span class="s2"> is not supported&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">operator</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_qutrit</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add extra dimension to the operator</span>

<span class="sd">        Args:</span>
<span class="sd">            op (jnp.ndarray): Qubit operator</span>
<span class="sd">            value (float, optional): Value to be add at the extra dimension diagonal entry. Defaults to 1.0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            jnp.ndarray: New operator for qutrit space.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">add_hilbert_level</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">value</span><span class="p">]))</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.Operator.from_label" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_label</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_label</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the operator from the label</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>op</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The label of the operator</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Operator not supported</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The operator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the operator from the label</span>

<span class="sd">    Args:</span>
<span class="sd">        op (str): The label of the operator</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Operator not supported</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The operator</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_pauli_x</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;Y&quot;</span><span class="p">:</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_pauli_y</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;Z&quot;</span><span class="p">:</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_pauli_z</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_hadamard</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;S&quot;</span><span class="p">:</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_s_gate</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;Sdg&quot;</span><span class="p">:</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_sdg_gate</span>
    <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;I&quot;</span><span class="p">:</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_identity</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Operator </span><span class="si">{</span><span class="n">op</span><span class="si">}</span><span class="s2"> is not supported&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">operator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.Operator.to_qutrit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_qutrit</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_qutrit</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add extra dimension to the operator</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>op</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qubit operator</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to be add at the extra dimension diagonal entry. Defaults to 1.0.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: New operator for qutrit space.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">to_qutrit</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add extra dimension to the operator</span>

<span class="sd">    Args:</span>
<span class="sd">        op (jnp.ndarray): Qubit operator</span>
<span class="sd">        value (float, optional): Value to be add at the extra dimension diagonal entry. Defaults to 1.0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: New operator for qutrit space.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">add_hilbert_level</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">value</span><span class="p">]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.data.State" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">State</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Dataclass for accessing eigenvector corresponded to eigenvalue of Pauli operator X, Y, and Z.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Provided state is not supported</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Provided state is not qubit</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">State</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataclass for accessing eigenvector corresponded to eigenvalue of Pauli operator X, Y, and Z.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Provided state is not supported</span>
<span class="sd">        ValueError: Provided state is not qubit</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_zero</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="n">_one</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="n">_plus</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">_minus</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">_right</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">_left</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the state from the label</span>

<span class="sd">        Args:</span>
<span class="sd">            state (str): The label of the state</span>
<span class="sd">            dm (bool, optional): Initialized as statevector or density matrix. Defaults to False.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: State not supported</span>

<span class="sd">        Returns:</span>
<span class="sd">            jnp.ndarray: The state</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Z+&quot;</span><span class="p">]:</span>
            <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_zero</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;Z-&quot;</span><span class="p">]:</span>
            <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_one</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;X+&quot;</span><span class="p">]:</span>
            <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_plus</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;X-&quot;</span><span class="p">]:</span>
            <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_minus</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;Y+&quot;</span><span class="p">]:</span>
            <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_right</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;Y-&quot;</span><span class="p">]:</span>
            <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_left</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2"> is not supported&quot;</span><span class="p">)</span>

        <span class="n">state_vec</span> <span class="o">=</span> <span class="n">state_vec</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">state_vec</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">dm</span> <span class="k">else</span> <span class="n">jnp</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">state_vec</span><span class="p">,</span> <span class="n">state_vec</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_qutrit</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Promote qubit state to qutrit with zero probability</span>

<span class="sd">        Args:</span>
<span class="sd">            state (jnp.ndarray): Density matrix of 2 x 2 qubit state.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Provided state is not qubit</span>

<span class="sd">        Returns:</span>
<span class="sd">            jnp.ndarray: Qutrit density matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Shape of the state is not as expected, expect (2, 2)&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">add_hilbert_level</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]))</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.State.from_label" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_label</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_label</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">dm</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the state from the label</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The label of the state</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dm</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initialized as statevector or density matrix. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>State not supported</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The state</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_label</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the state from the label</span>

<span class="sd">    Args:</span>
<span class="sd">        state (str): The label of the state</span>
<span class="sd">        dm (bool, optional): Initialized as statevector or density matrix. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: State not supported</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The state</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Z+&quot;</span><span class="p">]:</span>
        <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_zero</span>
    <span class="k">elif</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;Z-&quot;</span><span class="p">]:</span>
        <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_one</span>
    <span class="k">elif</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;X+&quot;</span><span class="p">]:</span>
        <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_plus</span>
    <span class="k">elif</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;X-&quot;</span><span class="p">]:</span>
        <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_minus</span>
    <span class="k">elif</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;Y+&quot;</span><span class="p">]:</span>
        <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_right</span>
    <span class="k">elif</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;Y-&quot;</span><span class="p">]:</span>
        <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_left</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2"> is not supported&quot;</span><span class="p">)</span>

    <span class="n">state_vec</span> <span class="o">=</span> <span class="n">state_vec</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">state_vec</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">dm</span> <span class="k">else</span> <span class="n">jnp</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">state_vec</span><span class="p">,</span> <span class="n">state_vec</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.State.to_qutrit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_qutrit</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_qutrit</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Promote qubit state to qutrit with zero probability</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Density matrix of 2 x 2 qubit state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Provided state is not qubit</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Qutrit density matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">to_qutrit</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Promote qubit state to qutrit with zero probability</span>

<span class="sd">    Args:</span>
<span class="sd">        state (jnp.ndarray): Density matrix of 2 x 2 qubit state.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Provided state is not qubit</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Qutrit density matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Shape of the state is not as expected, expect (2, 2)&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">add_hilbert_level</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.data.QubitInformation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">QubitInformation</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Dataclass to store qubit information</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string representation of unit, currently support "GHz", "2piGHz", "2piHz", or "Hz".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qubit_idx</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the index of the qubit.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>anharmonicity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Anhamonicity of the qubit, kept for the sake of completeness.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frequency</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qubit frequency.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drive_strength</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Drive strength of qubit, might be specific for IBMQ platform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fail to convert unit to GHz</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">QubitInformation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataclass to store qubit information</span>

<span class="sd">    Args:</span>
<span class="sd">        unit (str): The string representation of unit, currently support &quot;GHz&quot;, &quot;2piGHz&quot;, &quot;2piHz&quot;, or &quot;Hz&quot;.</span>
<span class="sd">        qubit_idx (int): the index of the qubit.</span>
<span class="sd">        anharmonicity (float): Anhamonicity of the qubit, kept for the sake of completeness.</span>
<span class="sd">        frequency (float): Qubit frequency.</span>
<span class="sd">        drive_strength (float): Drive strength of qubit, might be specific for IBMQ platform.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Fail to convert unit to GHz</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">qubit_idx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">anharmonicity</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">frequency</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">drive_strength</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_unit_to_ghz</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_unit_to_ghz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the unit of data stored in self to unit of GHz</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Data stored in the unsupported unit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GHz&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;Hz&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">*</span> <span class="mf">1e-9</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">*</span> <span class="mf">1e-9</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">*</span> <span class="mf">1e-9</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;2piGHz&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;2piHz&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unit must be GHz, 2piGHz, 2piHz, or Hz&quot;</span><span class="p">)</span>

        <span class="c1"># Set unit to GHz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;GHz&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dict_qubit_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">dict_qubit_info</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.QubitInformation.convert_unit_to_ghz" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">convert_unit_to_ghz</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">convert_unit_to_ghz</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert the unit of data stored in self to unit of GHz</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data stored in the unsupported unit</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_unit_to_ghz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the unit of data stored in self to unit of GHz</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Data stored in the unsupported unit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GHz&quot;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;Hz&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">*</span> <span class="mf">1e-9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">*</span> <span class="mf">1e-9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">*</span> <span class="mf">1e-9</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;2piGHz&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;2piHz&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unit must be GHz, 2piGHz, 2piHz, or Hz&quot;</span><span class="p">)</span>

    <span class="c1"># Set unit to GHz</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;GHz&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.data.ExpectationValue" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ExpectationValue</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Dataclass to store expectation value information</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>initial_state</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String representation of inital state. Currently support "+", "-", "r", "l", "0", "1".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>observable</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String representation of quantum observable.  Currently support "X", "Y", "Z".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expectation_value</code>
            </td>
            <td>
                  <code>None | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the expectation value. Default to None</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not support initial state</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not support observable</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not support initial state</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not support observable</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExpectationValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataclass to store expectation value information</span>

<span class="sd">    Args:</span>
<span class="sd">        initial_state (str): String representation of inital state. Currently support &quot;+&quot;, &quot;-&quot;, &quot;r&quot;, &quot;l&quot;, &quot;0&quot;, &quot;1&quot;.</span>
<span class="sd">        observable (str): String representation of quantum observable.  Currently support &quot;X&quot;, &quot;Y&quot;, &quot;Z&quot;.</span>
<span class="sd">        expectation_value (None | float): the expectation value. Default to None</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Not support initial state</span>
<span class="sd">        ValueError: Not support observable</span>
<span class="sd">        ValueError: Not support initial state</span>
<span class="sd">        ValueError: Not support observable</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">initial_state</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">observable</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">expectation_value</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Not serialized</span>
    <span class="n">initial_statevector</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">initial_density_matrix</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">observable_matrix</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial state </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2"> is not supported&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observable</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Observable </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2"> is not supported&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initial_statevector</span> <span class="o">=</span> <span class="n">State</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_density_matrix</span> <span class="o">=</span> <span class="n">State</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">dm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observable_matrix</span> <span class="o">=</span> <span class="n">Operator</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">observable</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;initial_state&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="p">,</span>
            <span class="s2">&quot;observable&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">observable</span><span class="p">,</span>
            <span class="s2">&quot;expectation_value&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__value</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">__value</span><span class="p">,</span> <span class="n">ExpectationValue</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span> <span class="o">==</span> <span class="n">__value</span><span class="o">.</span><span class="n">initial_state</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">observable</span> <span class="o">==</span> <span class="n">__value</span><span class="o">.</span><span class="n">observable</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">expectation_value</span> <span class="o">==</span> <span class="n">__value</span><span class="o">.</span><span class="n">expectation_value</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expectation_value</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Overwrite the __repr__ method of the class</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">(initial_state=&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s1">&quot;, observable=&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s1">&quot;, expectation_value=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expectation_value</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.data.ExperimentConfiguration" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ExperimentConfiguration</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Experiment configuration dataclass</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExperimentConfiguration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Experiment configuration dataclass&quot;&quot;&quot;</span>

    <span class="n">qubits</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">QubitInformation</span><span class="p">]</span>
    <span class="n">expectation_values_order</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">ExpectationValue</span><span class="p">]</span>
    <span class="n">parameter_names</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span>
        <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">]</span>  <span class="c1"># Get from the pulse sequence .get_parameter_names()</span>
    <span class="n">backend_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">EXPERIMENT_IDENTIFIER</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">EXPERIMENT_TAGS</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">device_cycle_time_ns</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">sequence_duration_dt</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">instance</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
    <span class="n">additional_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="o">**</span><span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="s2">&quot;qubits&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">qubit</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">],</span>
            <span class="s2">&quot;expectation_values_order&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">exp</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expectation_values_order</span>
            <span class="p">],</span>
        <span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dict_experiment_config</span><span class="p">):</span>
        <span class="n">dict_experiment_config</span><span class="p">[</span><span class="s2">&quot;qubits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">QubitInformation</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">qubit</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="n">dict_experiment_config</span><span class="p">[</span><span class="s2">&quot;qubits&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="n">dict_experiment_config</span><span class="p">[</span><span class="s2">&quot;expectation_values_order&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ExpectationValue</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">dict_experiment_config</span><span class="p">[</span><span class="s2">&quot;expectation_values_order&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">dict_experiment_config</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># os.makedirs(path, exist_ok=True)</span>
        <span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;config.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;config.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">dict_experiment_config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dict_experiment_config</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.data.ExperimentData" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ExperimentData</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Dataclass for processing of the characterization dataset.
A difference between preprocess and postprocess dataset is that postprocess group
expectation values same control parameter id within single row instead of multiple rows.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>experiment_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ExperimentConfiguration


  
      dataclass
   (src.inspeqtor.v1.data.ExperimentConfiguration)" href="#src.inspeqtor.v1.data.ExperimentConfiguration">ExperimentConfiguration</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Experiment configuration</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>preprocess_data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas dataframe containing the preprocess dataset</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>_postprocessed_data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(pd.DataFrame): Provide this optional argument to skip dataset postprocessing.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>keep_decimal</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the precision of floating point to keep.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExperimentData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataclass for processing of the characterization dataset.</span>
<span class="sd">    A difference between preprocess and postprocess dataset is that postprocess group</span>
<span class="sd">    expectation values same control parameter id within single row instead of multiple rows.</span>

<span class="sd">    Args:</span>
<span class="sd">        experiment_config (ExperimentConfiguration): Experiment configuration</span>
<span class="sd">        preprocess_data (pd.DataFrame): Pandas dataframe containing the preprocess dataset</span>
<span class="sd">        _postprocessed_data: (pd.DataFrame): Provide this optional argument to skip dataset postprocessing.</span>
<span class="sd">        keep_decimal (int): the precision of floating point to keep.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">experiment_config</span><span class="p">:</span> <span class="n">ExperimentConfiguration</span>
    <span class="n">preprocess_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
    <span class="c1"># optional</span>
    <span class="n">_postprocessed_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Setting</span>
    <span class="n">keep_decimal</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="c1"># Postprocessing</span>
    <span class="n">postprocessed_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">parameter_columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keep_decimal</span><span class="p">)</span>

        <span class="c1"># Validate that self.preprocess_data have all the required columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_preprocess_data</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Preprocess data validated&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_postprocessed_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_postprocessed_data</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Postprocess data set&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">post_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_preprocess_data_to_postprocess_data</span><span class="p">()</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Preprocess data transformed to postprocess data&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span> <span class="o">=</span> <span class="n">post_data</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keep_decimal</span><span class="p">)</span>

        <span class="c1"># Validate the data with schema</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_postprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Postprocess data validated&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parameter_columns</span> <span class="o">=</span> <span class="n">flatten_parameter_name_with_prefix</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span>
        <span class="p">)</span>
        <span class="n">num_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">num_controls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">temp_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_columns</span><span class="p">]</span>
                <span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
                <span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">num_controls</span><span class="p">,</span> <span class="n">num_features</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Could not reshape parameters with shape (sample_size, num_controls, num_features), automatically reshaping to (sample_size, -1)&quot;</span>
            <span class="p">)</span>
            <span class="n">temp_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_columns</span><span class="p">]</span>
                <span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
                <span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">sample_size</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameters reshaped to </span><span class="si">{</span><span class="n">temp_params</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">temp_params</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parameters converted to numpy array&quot;</span><span class="p">)</span>

        <span class="k">assert</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_columns</span><span class="p">]</span>
            <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="o">.</span><span class="n">equals</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_columns</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">),</span> <span class="p">(</span>
            <span class="s2">&quot;The preprocess_data and postprocessed_data does not have the same parameters.&quot;</span>
        <span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Preprocess data and postprocess data have the same parameters&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__value</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">__value</span><span class="p">,</span> <span class="n">ExperimentData</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span> <span class="o">==</span> <span class="n">__value</span><span class="o">.</span><span class="n">experiment_config</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">__value</span><span class="o">.</span><span class="n">preprocess_data</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_preprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate that the preprocess_data have all the required columns.</span>

<span class="sd">        Required columns:</span>
<span class="sd">            - EXPECTATION_VALUE</span>
<span class="sd">            - INITIAL_STATE</span>
<span class="sd">            - OBSERVABLE</span>
<span class="sd">            - PARAMETERS_ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">REQUIRED_COLUMNS</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is required but not found in the preprocess_data.&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Validate that the preprocess_data have all expected parameters columns</span>
        <span class="n">required_parameters_columns</span> <span class="o">=</span> <span class="n">flatten_parameter_name_with_prefix</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">_col</span> <span class="ow">in</span> <span class="n">required_parameters_columns</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">_col</span><span class="si">}</span><span class="s2"> is required but not found in the preprocess_data.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_postprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">post_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate postprocess dataset, by check the requirements given by `PredefinedCol` instance of each column</span>
<span class="sd">        that required in the postprocessed dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            post_data (pd.DataFrame): Postprocessed dataset to be validated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Validating postprocess data&quot;</span><span class="p">)</span>
        <span class="c1"># Validate that the postprocess_data have all the required columns</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">REQUIRED_COLUMNS</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">post_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is required but not found in the postprocess_data.&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Validate the check functions</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">REQUIRED_COLUMNS</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">check</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">post_data</span><span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">]]),</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> failed the check function </span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Validate that the postprocess_data have all expected parameters columns</span>
        <span class="n">required_parameters_columns</span> <span class="o">=</span> <span class="n">flatten_parameter_name_with_prefix</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">_col</span> <span class="ow">in</span> <span class="n">required_parameters_columns</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">_col</span> <span class="ow">in</span> <span class="n">post_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">_col</span><span class="si">}</span><span class="s2"> is required but not found in the postprocess_data.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">transform_preprocess_data_to_postprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal method to post process the dataset.</span>

<span class="sd">        Todo:</span>
<span class="sd">            Use new experimental implementation from_long to wide dataframe</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: There is duplicate entry of the expectation value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Postprocessed experiment dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Postprocess the data squeezing the data into the expectation values</span>
        <span class="c1"># Required columns: PARAMETERS_ID, OBSERVABLE, INITIAL_STATE, EXPECTATION_VALUE, + experiment_config.parameter_names</span>
        <span class="n">post_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">params_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">sample_size</span><span class="p">):</span>
            <span class="c1"># NOTE: Assume that parameters_id starts from 0 and is continuous to sample_size - 1</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="p">[</span><span class="n">PARAMETERS_ID</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">params_id</span>
            <span class="p">]</span>

            <span class="n">expectation_values</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">exp_order</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">expectation_values_order</span>
            <span class="p">):</span>
                <span class="n">expectation_value</span> <span class="o">=</span> <span class="n">rows</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                    <span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="n">OBSERVABLE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">exp_order</span><span class="o">.</span><span class="n">observable</span><span class="p">)</span>
                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="n">INITIAL_STATE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">exp_order</span><span class="o">.</span><span class="n">initial_state</span><span class="p">)</span>
                <span class="p">][</span><span class="n">EXPECTATION_VALUE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                <span class="k">if</span> <span class="n">expectation_value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Expectation value for params_id </span><span class="si">{</span><span class="n">params_id</span><span class="si">}</span><span class="s2">, initial_state </span><span class="si">{</span><span class="n">exp_order</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">, observable </span><span class="si">{</span><span class="n">exp_order</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2"> is not unique. The length is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">expectation_value</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>

                <span class="n">expectation_values</span><span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">EXPECTATION_VALUE</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">exp_order</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">exp_order</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">]</span> <span class="o">=</span> <span class="n">expectation_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">drop_duplicates_row</span> <span class="o">=</span> <span class="n">rows</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                <span class="n">subset</span><span class="o">=</span><span class="n">flatten_parameter_name_with_prefix</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="c1"># Assert that only one row is returned</span>
            <span class="k">assert</span> <span class="n">drop_duplicates_row</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">pulse_parameters</span> <span class="o">=</span> <span class="n">drop_duplicates_row</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">new_row</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">PARAMETERS_ID</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">params_id</span><span class="p">,</span>
                <span class="o">**</span><span class="n">expectation_values</span><span class="p">,</span>
                <span class="o">**</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pulse_parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="p">}</span>

            <span class="n">post_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">post_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_parameters_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get dataframe with only the columns of control parameters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Dataframe with only the columns of control parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_columns</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_expectation_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the expectation value of the shape (sample_size, num_expectation_value)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: expectation value of the shape (sample_size, num_expectation_value)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expectation_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span>
            <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;expectation_value/</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">expectation_values_order</span>
            <span class="p">]</span>
        <span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">expectation_value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_parameters_dict_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list, where each element is list of dict of the control parameters of the dataset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[list[ParametersDictType]]: The list of list of dict of parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_columns</span><span class="p">]</span>

        <span class="n">_params_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">get_parameters_dict_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">_temp</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">_params_list</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_to_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the experiment data to given folder</span>

<span class="sd">        Args:</span>
<span class="sd">            path (typing.Union[Path, str]): Path of the folder for experiment data to be saved.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># os.makedirs(path, exist_ok=True)</span>
        <span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;preprocess_data.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;postprocessed_data.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_folder</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExperimentData&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read the experiment data from path</span>

<span class="sd">        Args:</span>
<span class="sd">            path (typing.Union[Path, str]): path to the folder contain experiment data. Expected to be used with `self.save_to_folder` method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ExperimentData: Intance of `ExperimentData` read from path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="n">experiment_config</span> <span class="o">=</span> <span class="n">ExperimentConfiguration</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">preprocess_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;preprocess_data.csv&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Check if postprocessed_data exists</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;postprocessed_data.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="c1"># if not os.path.exists(path / &quot;postprocessed_data.csv&quot;):</span>
            <span class="n">postprocessed_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">postprocessed_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                <span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;postprocessed_data.csv&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">experiment_config</span><span class="o">=</span><span class="n">experiment_config</span><span class="p">,</span>
            <span class="n">preprocess_data</span><span class="o">=</span><span class="n">preprocess_data</span><span class="p">,</span>
            <span class="n">_postprocessed_data</span><span class="o">=</span><span class="n">postprocessed_data</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analysis_sum_of_expectation_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">paulis</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">]</span>
        <span class="n">initial_states</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">)]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">pauli</span> <span class="ow">in</span> <span class="n">paulis</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">initial_state</span> <span class="ow">in</span> <span class="n">initial_states</span><span class="p">:</span>
                <span class="n">_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pauli</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">initial_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">initial_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="n">res</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span>
                        <span class="sa">f</span><span class="s2">&quot;expectation_value/</span><span class="si">{</span><span class="n">initial_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">pauli</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">]</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span>
                        <span class="sa">f</span><span class="s2">&quot;expectation_value/</span><span class="si">{</span><span class="n">initial_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">pauli</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">]</span>
                <span class="p">)</span>

                <span class="n">data</span><span class="p">[</span><span class="n">_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.ExperimentData.validate_preprocess_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">validate_preprocess_data</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_preprocess_data</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate that the preprocess_data have all the required columns.</p>


<details class="required-columns" open>
  <summary>Required columns</summary>
  <ul>
<li>EXPECTATION_VALUE</li>
<li>INITIAL_STATE</li>
<li>OBSERVABLE</li>
<li>PARAMETERS_ID</li>
</ul>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_preprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate that the preprocess_data have all the required columns.</span>

<span class="sd">    Required columns:</span>
<span class="sd">        - EXPECTATION_VALUE</span>
<span class="sd">        - INITIAL_STATE</span>
<span class="sd">        - OBSERVABLE</span>
<span class="sd">        - PARAMETERS_ID</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">REQUIRED_COLUMNS</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is required but not found in the preprocess_data.&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Validate that the preprocess_data have all expected parameters columns</span>
    <span class="n">required_parameters_columns</span> <span class="o">=</span> <span class="n">flatten_parameter_name_with_prefix</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">_col</span> <span class="ow">in</span> <span class="n">required_parameters_columns</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">_col</span><span class="si">}</span><span class="s2"> is required but not found in the preprocess_data.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.ExperimentData.validate_postprocess_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">validate_postprocess_data</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_postprocess_data</span><span class="p">(</span><span class="n">post_data</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate postprocess dataset, by check the requirements given by <code>PredefinedCol</code> instance of each column
that required in the postprocessed dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>post_data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Postprocessed dataset to be validated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_postprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">post_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate postprocess dataset, by check the requirements given by `PredefinedCol` instance of each column</span>
<span class="sd">    that required in the postprocessed dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        post_data (pd.DataFrame): Postprocessed dataset to be validated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Validating postprocess data&quot;</span><span class="p">)</span>
    <span class="c1"># Validate that the postprocess_data have all the required columns</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">REQUIRED_COLUMNS</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">post_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is required but not found in the postprocess_data.&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Validate the check functions</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">REQUIRED_COLUMNS</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">check</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">post_data</span><span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">]]),</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> failed the check function </span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Validate that the postprocess_data have all expected parameters columns</span>
    <span class="n">required_parameters_columns</span> <span class="o">=</span> <span class="n">flatten_parameter_name_with_prefix</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">_col</span> <span class="ow">in</span> <span class="n">required_parameters_columns</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">_col</span> <span class="ow">in</span> <span class="n">post_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">_col</span><span class="si">}</span><span class="s2"> is required but not found in the postprocess_data.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.ExperimentData.transform_preprocess_data_to_postprocess_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">transform_preprocess_data_to_postprocess_data</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">transform_preprocess_data_to_postprocess_data</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">(</span>
    <span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Internal method to post process the dataset.</p>


<details class="todo" open>
  <summary>Todo</summary>
  <p>Use new experimental implementation from_long to wide dataframe</p>
</details>

<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>There is duplicate entry of the expectation value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Postprocessed experiment dataset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_preprocess_data_to_postprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Internal method to post process the dataset.</span>

<span class="sd">    Todo:</span>
<span class="sd">        Use new experimental implementation from_long to wide dataframe</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: There is duplicate entry of the expectation value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Postprocessed experiment dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Postprocess the data squeezing the data into the expectation values</span>
    <span class="c1"># Required columns: PARAMETERS_ID, OBSERVABLE, INITIAL_STATE, EXPECTATION_VALUE, + experiment_config.parameter_names</span>
    <span class="n">post_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">params_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">sample_size</span><span class="p">):</span>
        <span class="c1"># NOTE: Assume that parameters_id starts from 0 and is continuous to sample_size - 1</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="p">[</span><span class="n">PARAMETERS_ID</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">params_id</span>
        <span class="p">]</span>

        <span class="n">expectation_values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">exp_order</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">expectation_values_order</span>
        <span class="p">):</span>
            <span class="n">expectation_value</span> <span class="o">=</span> <span class="n">rows</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="n">OBSERVABLE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">exp_order</span><span class="o">.</span><span class="n">observable</span><span class="p">)</span>
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="n">INITIAL_STATE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">exp_order</span><span class="o">.</span><span class="n">initial_state</span><span class="p">)</span>
            <span class="p">][</span><span class="n">EXPECTATION_VALUE</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="k">if</span> <span class="n">expectation_value</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Expectation value for params_id </span><span class="si">{</span><span class="n">params_id</span><span class="si">}</span><span class="s2">, initial_state </span><span class="si">{</span><span class="n">exp_order</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">, observable </span><span class="si">{</span><span class="n">exp_order</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2"> is not unique. The length is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">expectation_value</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

            <span class="n">expectation_values</span><span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">EXPECTATION_VALUE</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">exp_order</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">exp_order</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">]</span> <span class="o">=</span> <span class="n">expectation_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">drop_duplicates_row</span> <span class="o">=</span> <span class="n">rows</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
            <span class="n">subset</span><span class="o">=</span><span class="n">flatten_parameter_name_with_prefix</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Assert that only one row is returned</span>
        <span class="k">assert</span> <span class="n">drop_duplicates_row</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="n">pulse_parameters</span> <span class="o">=</span> <span class="n">drop_duplicates_row</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">new_row</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">PARAMETERS_ID</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">params_id</span><span class="p">,</span>
            <span class="o">**</span><span class="n">expectation_values</span><span class="p">,</span>
            <span class="o">**</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pulse_parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
        <span class="p">}</span>

        <span class="n">post_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">post_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.ExperimentData.get_parameters_dataframe" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_parameters_dataframe</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_parameters_dataframe</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get dataframe with only the columns of control parameters.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Dataframe with only the columns of control parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_parameters_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get dataframe with only the columns of control parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Dataframe with only the columns of control parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_columns</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.ExperimentData.get_expectation_values" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_expectation_values</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_expectation_values</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the expectation value of the shape (sample_size, num_expectation_value)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: expectation value of the shape (sample_size, num_expectation_value)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_expectation_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the expectation value of the shape (sample_size, num_expectation_value)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: expectation value of the shape (sample_size, num_expectation_value)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">expectation_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span>
        <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;expectation_value/</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">expectation_values_order</span>
        <span class="p">]</span>
    <span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">expectation_value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.ExperimentData.get_parameters_dict_list" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_parameters_dict_list</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_parameters_dict_list</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span>
    <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the list, where each element is list of dict of the control parameters of the dataset.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[list[ParametersDictType]]: The list of list of dict of parameter.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_parameters_dict_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list, where each element is list of dict of the control parameters of the dataset.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[list[ParametersDictType]]: The list of list of dict of parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_columns</span><span class="p">]</span>

    <span class="n">_params_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">get_parameters_dict_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">parameter_names</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">_temp</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">_params_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.ExperimentData.save_to_folder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">save_to_folder</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_to_folder</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="pathlib.Path">Path</span></span><span class="p">,</span> <span class="n"><span title="str">str</span></span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the experiment data to given folder</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path of the folder for experiment data to be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_to_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the experiment data to given folder</span>

<span class="sd">    Args:</span>
<span class="sd">        path (typing.Union[Path, str]): Path of the folder for experiment data to be saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="c1"># os.makedirs(path, exist_ok=True)</span>
    <span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;preprocess_data.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">postprocessed_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;postprocessed_data.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.data.ExperimentData.from_folder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_folder</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_folder</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="pathlib.Path">Path</span></span><span class="p">,</span> <span class="n"><span title="str">str</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="            ExperimentData


  
      dataclass
   (src.inspeqtor.v1.data.ExperimentData)" href="#src.inspeqtor.v1.data.ExperimentData">ExperimentData</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Read the experiment data from path</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to the folder contain experiment data. Expected to be used with <code>self.save_to_folder</code> method.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ExperimentData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="            ExperimentData


  
      dataclass
   (src.inspeqtor.v1.data.ExperimentData)" href="#src.inspeqtor.v1.data.ExperimentData">ExperimentData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Intance of <code>ExperimentData</code> read from path.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_folder</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExperimentData&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read the experiment data from path</span>

<span class="sd">    Args:</span>
<span class="sd">        path (typing.Union[Path, str]): path to the folder contain experiment data. Expected to be used with `self.save_to_folder` method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ExperimentData: Intance of `ExperimentData` read from path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">experiment_config</span> <span class="o">=</span> <span class="n">ExperimentConfiguration</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">preprocess_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;preprocess_data.csv&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Check if postprocessed_data exists</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;postprocessed_data.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="c1"># if not os.path.exists(path / &quot;postprocessed_data.csv&quot;):</span>
        <span class="n">postprocessed_data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">postprocessed_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;postprocessed_data.csv&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">experiment_config</span><span class="o">=</span><span class="n">experiment_config</span><span class="p">,</span>
        <span class="n">preprocess_data</span><span class="o">=</span><span class="n">preprocess_data</span><span class="p">,</span>
        <span class="n">_postprocessed_data</span><span class="o">=</span><span class="n">postprocessed_data</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.data.add_hilbert_level" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">add_hilbert_level</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_hilbert_level</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add a level to the operator or state</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>op</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The qubit operator or state</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_state</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the operator is a state, False if the operator is an operator</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The qutrit operator or state</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_hilbert_level</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a level to the operator or state</span>

<span class="sd">    Args:</span>
<span class="sd">        op (jnp.ndarray): The qubit operator or state</span>
<span class="sd">        is_state (bool): True if the operator is a state, False if the operator is an operator</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The qutrit operator or state</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">block_diag</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.data.flatten_parameter_name_with_prefix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">flatten_parameter_name_with_prefix</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">flatten_parameter_name_with_prefix</span><span class="p">(</span>
    <span class="n">parameter_names</span><span class="p">:</span> <span class="n"><span title="typing.Sequence">Sequence</span></span><span class="p">[</span><span class="n"><span title="typing.Sequence">Sequence</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a flatten list of parameter names with prefix parameter/{i}/</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parameter_names</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of parameter names from the pulse sequence
                                                     or the experiment configuration</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: The flatten list of parameter names with prefix parameter/{i}/</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">flatten_parameter_name_with_prefix</span><span class="p">(</span>
    <span class="n">parameter_names</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a flatten list of parameter names with prefix parameter/{i}/</span>

<span class="sd">    Args:</span>
<span class="sd">        parameter_names (typing.Sequence[typing.Sequence[str]]): The list of parameter names from the pulse sequence</span>
<span class="sd">                                                                 or the experiment configuration</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: The flatten list of parameter names with prefix parameter/{i}/</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;parameter/</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">names</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parameter_names</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.data.transform_parameter_name" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">transform_parameter_name</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">transform_parameter_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Remove "parameter/{i}/" from provided name</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the control parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name that have "parameter/{i}/" strip.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_parameter_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove &quot;parameter/{i}/&quot; from provided name</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of the control parameters</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Name that have &quot;parameter/{i}/&quot; strip.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;parameter/&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">:])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.data.get_parameters_dict_list" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_parameters_dict_list</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_parameters_dict_list</span><span class="p">(</span>
    <span class="n">parameters_name</span><span class="p">:</span> <span class="n"><span title="typing.Sequence">Sequence</span></span><span class="p">[</span><span class="n"><span title="typing.Sequence">Sequence</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]],</span>
    <span class="n">parameters_row</span><span class="p">:</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the list of dict containing name and value of each control in the sequence.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parameters_name</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parameters_row</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="src.inspeqtor.v1.ctyping.ParametersDictType">ParametersDictType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[ParametersDictType]: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_parameters_dict_list</span><span class="p">(</span>
    <span class="n">parameters_name</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">parameters_row</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the list of dict containing name and value of each control in the sequence.</span>

<span class="sd">    Args:</span>
<span class="sd">        parameters_name (typing.Sequence[typing.Sequence[str]]): _description_</span>
<span class="sd">        parameters_row (pd.Series): _description_</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[ParametersDictType]: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">recovered_parameters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParametersDictType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="c1"># Split to remove the parameter/{i}/</span>
            <span class="n">transform_parameter_name</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">parameters_row</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="c1"># Check if the key is parameter/{i}/ and the value is float</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter/</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parameters_name</span><span class="p">))</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">recovered_parameters</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.data.save_to_json" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">save_to_json</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_to_json</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the dictionary as json to the path</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict to be save to file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_to_json</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the dictionary as json to the path</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict): Dict to be save to file</span>
<span class="sd">        path (typing.Union[str, Path]): Path to save file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.data.read_from_json" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">read_from_json</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">read_from_json</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">],</span>
    <span class="n">dataclass</span><span class="p">:</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.data.DataclassVar">DataclassVar</span></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="dict">dict</span></span><span class="p">,</span> <span class="n"><span title="src.inspeqtor.v1.data.DataclassVar">DataclassVar</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct provided <code>dataclass</code> instance with json file</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to json file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataclass</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="type">type</span>[<span title="src.inspeqtor.v1.data.DataclassVar">DataclassVar</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The constructor of the dataclass. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="dict">dict</span>, <span title="src.inspeqtor.v1.data.DataclassVar">DataclassVar</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Union[dict, DataclassVar]: Dataclass instance, if dataclass is not provideded, return dict instead.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">read_from_json</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="n">dataclass</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">DataclassVar</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">DataclassVar</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct provided `dataclass` instance with json file</span>

<span class="sd">    Args:</span>
<span class="sd">        path (typing.Union[str, Path]): Path to json file</span>
<span class="sd">        dataclass (typing.Union[None, type[DataclassVar]], optional): The constructor of the dataclass. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Union[dict, DataclassVar]: Dataclass instance, if dataclass is not provideded, return dict instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">config_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dataclass</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">config_dict</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dataclass</span><span class="p">(</span><span class="o">**</span><span class="n">config_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.data.load_pytree_from_json" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">load_pytree_from_json</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_pytree_from_json</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">,</span> <span class="n">parse_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.v1.data.default_parse_fn">default_parse_fn</span></span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load pytree from json</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to JSON file containing pytree</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>array_keys</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of key to convert to jnp.numpy. Defaults to [].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Provided path is not point to .json file</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: Pytree loaded from JSON</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_pytree_from_json</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">parse_fn</span><span class="o">=</span><span class="n">default_parse_fn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load pytree from json</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str | Path): Path to JSON file containing pytree</span>
<span class="sd">        array_keys (list[str], optional): list of key to convert to jnp.numpy. Defaults to [].</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Provided path is not point to .json file</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: Pytree loaded from JSON</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Validate that file extension is .json</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">extension</span> <span class="o">!=</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;File extension must be json&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">recursive_parse</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">parse_fn</span><span class="o">=</span><span class="n">parse_fn</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.data.save_pytree_to_json" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">save_pytree_to_json</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_pytree_to_json</span><span class="p">(</span><span class="n">pytree</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Save given pytree to json file, the path must end with extension of .json</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pytree</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pytree to save</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File path to save</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_pytree_to_json</span><span class="p">(</span><span class="n">pytree</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save given pytree to json file, the path must end with extension of .json</span>

<span class="sd">    Args:</span>
<span class="sd">        pytree (typing.Any): The pytree to save</span>
<span class="sd">        path (str | Path): File path to save</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Convert jax.ndarray</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">pytree</span>
    <span class="p">)</span>
    <span class="c1"># Convert ParamShape</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">param_shape_to_dict</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_param_shape</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.data.from_long_to_wide" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">from_long_to_wide</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_long_to_wide</span><span class="p">(</span><span class="n">preprocessed_df</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>An experimental function to transform preprocess dataframe to postprocess dataframe.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>preprocessed_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The preprocess dataframe</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The postprocessed dataframe</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">from_long_to_wide</span><span class="p">(</span><span class="n">preprocessed_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An experimental function to transform preprocess dataframe to postprocess dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        preprocessed_df (pd.DataFrame): The preprocess dataframe</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The postprocessed dataframe</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Handle the expectation value using unstack</span>
    <span class="n">expvals_df</span> <span class="o">=</span> <span class="n">preprocessed_df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="s2">&quot;parameters_id&quot;</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;initial_state&quot;</span><span class="p">,</span> <span class="s2">&quot;observable&quot;</span><span class="p">],</span>
        <span class="n">values</span><span class="o">=</span><span class="s2">&quot;expectation_value&quot;</span><span class="p">,</span>  <span class="c1"># Note: string, not a list</span>
    <span class="p">)</span>

    <span class="c1"># Rename columns using another idiomatic approach</span>
    <span class="n">expvals_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;expectation_value/</span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">obs</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">state</span><span class="p">,</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">expvals_df</span><span class="o">.</span><span class="n">columns</span>
    <span class="p">]</span>

    <span class="c1"># Handle parameters columns</span>
    <span class="n">params_df</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">preprocessed_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;parameters_id&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="o">.</span><span class="n">drop</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;expectation_value&quot;</span><span class="p">,</span> <span class="s2">&quot;initial_state&quot;</span><span class="p">,</span> <span class="s2">&quot;observable&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Combine with join</span>
    <span class="k">return</span> <span class="n">params_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expvals_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.data.from_wide_to_long_simple" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">from_wide_to_long_simple</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_wide_to_long_simple</span><span class="p">(</span><span class="n">wide_df</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A more concise version to convert a wide DataFrame back to the long format.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">from_wide_to_long_simple</span><span class="p">(</span><span class="n">wide_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A more concise version to convert a wide DataFrame back to the long format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Work with the index as a column</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wide_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

    <span class="c1"># 1. Identify all columns that should NOT be melted (the &quot;id&quot; columns)</span>
    <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;expectation_value/&quot;</span><span class="p">)]</span>

    <span class="c1"># 2. Melt the DataFrame. pd.melt automatically uses all columns NOT in id_vars as value_vars.</span>
    <span class="n">long_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
        <span class="n">id_vars</span><span class="o">=</span><span class="n">id_vars</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;descriptor&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;expectation_value&quot;</span>
    <span class="p">)</span>

    <span class="c1"># 3. Split the descriptor and assign new columns in one step</span>
    <span class="n">long_df</span><span class="p">[[</span><span class="s2">&quot;_,&quot;</span><span class="p">,</span> <span class="s2">&quot;initial_state&quot;</span><span class="p">,</span> <span class="s2">&quot;observable&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">long_df</span><span class="p">[</span><span class="s2">&quot;descriptor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
        <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># 4. Clean up the DataFrame by dropping temporary columns and sorting</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">long_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;descriptor&quot;</span><span class="p">,</span> <span class="s2">&quot;_,&quot;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;parameters_id&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="linen">Linen</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.models.linen" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.models.linen</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.linen.loss_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">loss_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">loss_fn</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n"><span title="flax.typing.VariableDict">VariableDict</span></span><span class="p">,</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">expectation_values</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="flax.linen.Module">Module</span></span><span class="p">,</span>
    <span class="n">predictive_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">loss_metric</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.model.LossMetric">LossMetric</span></span><span class="p">,</span>
    <span class="n">calculate_metric_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.model.calculate_metric">calculate_metric</span></span><span class="p">,</span>
    <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This function implement a unified interface for nn.Module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="flax.typing.VariableDict">VariableDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model parameters to be optimized</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control_parameters</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control parameters parametrized Hamiltonian</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unitaries</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Ideal unitary operators corresponding to the control parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expectation_values</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Experimental expectation values to calculate the loss value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flax linen Blackbox part of the graybox model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>predictive_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for calculating expectation value from the model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_metric</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.LossMetric">LossMetric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The choice of loss value to be minimized.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>calculate_metric_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for metrics calculation from prediction and experimental value. Defaults to calculate_metric</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.calculate_metric">calculate_metric</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="jax.numpy.ndarray">ndarray</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="jax.numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[jnp.ndarray, dict[str, jnp.ndarray]]: The loss value and other metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/linen.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;use make_loss_fn instead&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">VariableDict</span><span class="p">,</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">expectation_values</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">predictive_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">loss_metric</span><span class="p">:</span> <span class="n">LossMetric</span><span class="p">,</span>
    <span class="n">calculate_metric_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span> <span class="o">=</span> <span class="n">calculate_metric</span><span class="p">,</span>
    <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function implement a unified interface for nn.Module.</span>

<span class="sd">    Args:</span>
<span class="sd">        params (VariableDict): Model parameters to be optimized</span>
<span class="sd">        control_parameters (jnp.ndarray): Control parameters parametrized Hamiltonian</span>
<span class="sd">        unitaries (jnp.ndarray): The Ideal unitary operators corresponding to the control parameters</span>
<span class="sd">        expectation_values (jnp.ndarray): Experimental expectation values to calculate the loss value</span>
<span class="sd">        model (nn.Module): Flax linen Blackbox part of the graybox model.</span>
<span class="sd">        predictive_fn (typing.Callable): Function for calculating expectation value from the model</span>
<span class="sd">        loss_metric (LossMetric): The choice of loss value to be minimized.</span>
<span class="sd">        calculate_metric_fn (typing.Callable): Function for metrics calculation from prediction and experimental value. Defaults to calculate_metric</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[jnp.ndarray, dict[str, jnp.ndarray]]: The loss value and other metrics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate the metrics</span>
    <span class="n">predicted_expectation_value</span> <span class="o">=</span> <span class="n">predictive_fn</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">model_params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">control_parameters</span><span class="o">=</span><span class="n">control_parameters</span><span class="p">,</span>
        <span class="n">unitaries</span><span class="o">=</span><span class="n">unitaries</span><span class="p">,</span>
        <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">metrics</span> <span class="o">=</span> <span class="n">calculate_metric_fn</span><span class="p">(</span>
        <span class="n">unitaries</span><span class="p">,</span> <span class="n">expectation_values</span><span class="p">,</span> <span class="n">predicted_expectation_value</span>
    <span class="p">)</span>

    <span class="c1"># Take mean of all the metrics</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>

    <span class="c1"># ! Grab the metric in the `metrics`</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="n">loss_metric</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.linen.wo_predictive_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">wo_predictive_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">wo_predictive_fn</span><span class="p">(</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="flax.linen.Module">Module</span></span><span class="p">,</span>
    <span class="n">model_params</span><span class="p">:</span> <span class="n"><span title="flax.typing.VariableDict">VariableDict</span></span><span class="p">,</span>
    <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>To Calculate the metrics of the model
1. MSE Loss between the predicted expectation values and the experimental expectation values
2. Average Gate Fidelity between the Pauli matrices to the Wo_model matrices
3. AGF Loss between the prediction from model and the experimental expectation values</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="sq.model.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to be used for prediction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_params</code>
            </td>
            <td>
                  <code><span title="sq.model.VariableDict">VariableDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control_parameters</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pulse parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unitaries</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ideal unitaries</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expectation_values</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Experimental expectation values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model keyword arguments</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/linen.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wo_predictive_fn</span><span class="p">(</span>
    <span class="c1"># Input data to the model</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="c1"># The model to be used for prediction</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">model_params</span><span class="p">:</span> <span class="n">VariableDict</span><span class="p">,</span>
    <span class="c1"># model keyword arguments</span>
    <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;To Calculate the metrics of the model</span>
<span class="sd">    1. MSE Loss between the predicted expectation values and the experimental expectation values</span>
<span class="sd">    2. Average Gate Fidelity between the Pauli matrices to the Wo_model matrices</span>
<span class="sd">    3. AGF Loss between the prediction from model and the experimental expectation values</span>

<span class="sd">    Args:</span>
<span class="sd">        model (sq.model.nn.Module): The model to be used for prediction</span>
<span class="sd">        model_params (sq.model.VariableDict): The model parameters</span>
<span class="sd">        control_parameters (jnp.ndarray): The pulse parameters</span>
<span class="sd">        unitaries (jnp.ndarray): Ideal unitaries</span>
<span class="sd">        expectation_values (jnp.ndarray): Experimental expectation values</span>
<span class="sd">        model_kwargs (dict): Model keyword arguments</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Calculate Wo_params</span>
    <span class="n">Wo</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">control_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">observable_to_expvals</span><span class="p">(</span><span class="n">Wo</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.linen.noisy_unitary_predictive_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">noisy_unitary_predictive_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">noisy_unitary_predictive_fn</span><span class="p">(</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.models.linen.UnitaryModel">UnitaryModel</span></span><span class="p">,</span>
    <span class="n">model_params</span><span class="p">:</span> <span class="n"><span title="flax.typing.VariableDict">VariableDict</span></span><span class="p">,</span>
    <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Caculate for unitary-based Blackbox model</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="sq.model.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to be used for prediction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_params</code>
            </td>
            <td>
                  <code><span title="sq.model.VariableDict">VariableDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control_parameters</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pulse parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unitaries</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ideal unitaries</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expectation_values</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Experimental expectation values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model keyword arguments</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/linen.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">noisy_unitary_predictive_fn</span><span class="p">(</span>
    <span class="c1"># Input data to the model</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="c1"># The model to be used for prediction</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">UnitaryModel</span><span class="p">,</span>
    <span class="n">model_params</span><span class="p">:</span> <span class="n">VariableDict</span><span class="p">,</span>
    <span class="c1"># model keyword arguments</span>
    <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Caculate for unitary-based Blackbox model</span>

<span class="sd">    Args:</span>
<span class="sd">        model (sq.model.nn.Module): The model to be used for prediction</span>
<span class="sd">        model_params (sq.model.VariableDict): The model parameters</span>
<span class="sd">        control_parameters (jnp.ndarray): The pulse parameters</span>
<span class="sd">        unitaries (jnp.ndarray): Ideal unitaries</span>
<span class="sd">        expectation_values (jnp.ndarray): Experimental expectation values</span>
<span class="sd">        model_kwargs (dict): Model keyword arguments</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Predict Unitary parameters</span>
    <span class="n">unitary_params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">control_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">unitary_to_expvals</span><span class="p">(</span><span class="n">unitary_params</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.linen.toggling_unitary_predictive_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">toggling_unitary_predictive_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toggling_unitary_predictive_fn</span><span class="p">(</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.models.linen.UnitaryModel">UnitaryModel</span></span><span class="p">,</span>
    <span class="n">model_params</span><span class="p">:</span> <span class="n"><span title="flax.typing.VariableDict">VariableDict</span></span><span class="p">,</span>
    <span class="n">ignore_spam</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calcuate for unitary-based Blackbox model</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="sq.model.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to be used for prediction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_params</code>
            </td>
            <td>
                  <code><span title="sq.model.VariableDict">VariableDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control_parameters</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pulse parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unitaries</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ideal unitaries</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expectation_values</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Experimental expectation values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model keyword arguments</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/linen.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">toggling_unitary_predictive_fn</span><span class="p">(</span>
    <span class="c1"># Input data to the model</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="c1"># The model to be used for prediction</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">UnitaryModel</span><span class="p">,</span>
    <span class="n">model_params</span><span class="p">:</span> <span class="n">VariableDict</span><span class="p">,</span>
    <span class="c1"># model keyword arguments</span>
    <span class="n">ignore_spam</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calcuate for unitary-based Blackbox model</span>

<span class="sd">    Args:</span>
<span class="sd">        model (sq.model.nn.Module): The model to be used for prediction</span>
<span class="sd">        model_params (sq.model.VariableDict): The model parameters</span>
<span class="sd">        control_parameters (jnp.ndarray): The pulse parameters</span>
<span class="sd">        unitaries (jnp.ndarray): Ideal unitaries</span>
<span class="sd">        expectation_values (jnp.ndarray): Experimental expectation values</span>
<span class="sd">        model_kwargs (dict): Model keyword arguments</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Predict Unitary parameters</span>
    <span class="n">unitary_params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">control_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_spam</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">toggling_unitary_with_spam_to_expvals</span><span class="p">(</span>
            <span class="n">output</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;model_params&quot;</span><span class="p">:</span> <span class="n">unitary_params</span><span class="p">,</span>
                <span class="s2">&quot;spam_params&quot;</span><span class="p">:</span> <span class="n">model_params</span><span class="p">[</span><span class="s2">&quot;spam&quot;</span><span class="p">],</span>
            <span class="p">},</span>
            <span class="n">unitaries</span><span class="o">=</span><span class="n">unitaries</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">toggling_unitary_to_expvals</span><span class="p">(</span>
            <span class="n">unitary_params</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
            <span class="n">unitaries</span><span class="o">=</span><span class="n">unitaries</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.linen.make_loss_fn_old" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_loss_fn_old</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_loss_fn_old</span><span class="p">(</span>
    <span class="n">predictive_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="flax.linen.Module">Module</span></span><span class="p">,</span>
    <span class="n">calculate_metric_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.model.calculate_metric">calculate_metric</span></span><span class="p">,</span>
    <span class="n">loss_metric</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.model.LossMetric">LossMetric</span></span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.model.LossMetric.MSEE">MSEE</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p><em>summary</em></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predictive_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for calculating expectation value from the model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flax linen Blackbox part of the graybox model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_metric</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.LossMetric">LossMetric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The choice of loss value to be minimized. Defaults to LossMetric.MSEE.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.LossMetric.MSEE">MSEE</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>calculate_metric_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for metrics calculation from prediction and experimental value. Defaults to calculate_metric.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.calculate_metric">calculate_metric</span></code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/linen.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span><span class="o">.</span><span class="n">deprecated</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_loss_fn_old</span><span class="p">(</span>
    <span class="n">predictive_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">calculate_metric_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span> <span class="o">=</span> <span class="n">calculate_metric</span><span class="p">,</span>
    <span class="n">loss_metric</span><span class="p">:</span> <span class="n">LossMetric</span> <span class="o">=</span> <span class="n">LossMetric</span><span class="o">.</span><span class="n">MSEE</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        predictive_fn (typing.Callable): Function for calculating expectation value from the model</span>
<span class="sd">        model (nn.Module): Flax linen Blackbox part of the graybox model.</span>
<span class="sd">        loss_metric (LossMetric): The choice of loss value to be minimized. Defaults to LossMetric.MSEE.</span>
<span class="sd">        calculate_metric_fn (typing.Callable): Function for metrics calculation from prediction and experimental value. Defaults to calculate_metric.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">VariableDict</span><span class="p">,</span>
        <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">expectation_values</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function implement a unified interface for nn.Module.</span>

<span class="sd">        Args:</span>
<span class="sd">            params (VariableDict): Model parameters to be optimized</span>
<span class="sd">            control_parameters (jnp.ndarray): Control parameters parametrized Hamiltonian</span>
<span class="sd">            unitaries (jnp.ndarray): The Ideal unitary operators corresponding to the control parameters</span>
<span class="sd">            expectation_values (jnp.ndarray): Experimental expectation values to calculate the loss value</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[jnp.ndarray, dict[str, jnp.ndarray]]: The loss value and other metrics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the metrics</span>
        <span class="n">predicted_expectation_value</span> <span class="o">=</span> <span class="n">predictive_fn</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">model_params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">control_parameters</span><span class="o">=</span><span class="n">control_parameters</span><span class="p">,</span>
            <span class="n">unitaries</span><span class="o">=</span><span class="n">unitaries</span><span class="p">,</span>
            <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">metrics</span> <span class="o">=</span> <span class="n">calculate_metric_fn</span><span class="p">(</span>
            <span class="n">unitaries</span><span class="p">,</span> <span class="n">expectation_values</span><span class="p">,</span> <span class="n">predicted_expectation_value</span>
        <span class="p">)</span>

        <span class="c1"># Take mean of all the metrics</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>

        <span class="c1"># ! Grab the metric in the `metrics`</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="n">loss_metric</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">loss_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.linen.make_loss_fn_oldv2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_loss_fn_oldv2</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_loss_fn_oldv2</span><span class="p">(</span>
    <span class="n">adapter_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="flax.linen.Module">Module</span></span><span class="p">,</span>
    <span class="n">calculate_metric_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.model.calculate_metric">calculate_metric</span></span><span class="p">,</span>
    <span class="n">loss_metric</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.model.LossMetric">LossMetric</span></span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.model.LossMetric.MSEE">MSEE</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p><em>summary</em></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predictive_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for calculating expectation value from the model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flax linen Blackbox part of the graybox model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_metric</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.LossMetric">LossMetric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The choice of loss value to be minimized. Defaults to LossMetric.MSEE.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.LossMetric.MSEE">MSEE</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>calculate_metric_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for metrics calculation from prediction and experimental value. Defaults to calculate_metric.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.calculate_metric">calculate_metric</span></code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/linen.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_loss_fn_oldv2</span><span class="p">(</span>
    <span class="n">adapter_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">calculate_metric_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span> <span class="o">=</span> <span class="n">calculate_metric</span><span class="p">,</span>
    <span class="n">loss_metric</span><span class="p">:</span> <span class="n">LossMetric</span> <span class="o">=</span> <span class="n">LossMetric</span><span class="o">.</span><span class="n">MSEE</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        predictive_fn (typing.Callable): Function for calculating expectation value from the model</span>
<span class="sd">        model (nn.Module): Flax linen Blackbox part of the graybox model.</span>
<span class="sd">        loss_metric (LossMetric): The choice of loss value to be minimized. Defaults to LossMetric.MSEE.</span>
<span class="sd">        calculate_metric_fn (typing.Callable): Function for metrics calculation from prediction and experimental value. Defaults to calculate_metric.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">VariableDict</span><span class="p">,</span>
        <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">expectation_values</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function implement a unified interface for nn.Module.</span>

<span class="sd">        Args:</span>
<span class="sd">            params (VariableDict): Model parameters to be optimized</span>
<span class="sd">            control_parameters (jnp.ndarray): Control parameters parametrized Hamiltonian</span>
<span class="sd">            unitaries (jnp.ndarray): The Ideal unitary operators corresponding to the control parameters</span>
<span class="sd">            expectation_values (jnp.ndarray): Experimental expectation values to calculate the loss value</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[jnp.ndarray, dict[str, jnp.ndarray]]: The loss value and other metrics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">control_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kwargs</span><span class="p">)</span>
        <span class="n">predicted_expectation_value</span> <span class="o">=</span> <span class="n">adapter_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">unitaries</span><span class="o">=</span><span class="n">unitaries</span><span class="p">)</span>

        <span class="c1"># Calculate the metrics</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="n">calculate_metric_fn</span><span class="p">(</span>
            <span class="n">unitaries</span><span class="p">,</span> <span class="n">expectation_values</span><span class="p">,</span> <span class="n">predicted_expectation_value</span>
        <span class="p">)</span>

        <span class="c1"># Take mean of all the metrics</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>

        <span class="c1"># ! Grab the metric in the `metrics`</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="n">loss_metric</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">loss_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.linen.make_loss_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_loss_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_loss_fn</span><span class="p">(</span>
    <span class="n">adapter_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="flax.linen.Module">Module</span></span><span class="p">,</span>
    <span class="n">evaluate_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
    <span class="p">],</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p><em>summary</em></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predictive_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for calculating expectation value from the model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flax linen Blackbox part of the graybox model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evaluate_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Take in predicted and experimental expectation values and ideal unitary and return loss value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/linen.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_loss_fn</span><span class="p">(</span>
    <span class="n">adapter_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">evaluate_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        predictive_fn (typing.Callable): Function for calculating expectation value from the model</span>
<span class="sd">        model (nn.Module): Flax linen Blackbox part of the graybox model.</span>
<span class="sd">        evaluate_fn ( typing.Callable[[jnp.ndarray, jnp.ndarray], jnp.ndarray, jnp.ndarray]): Take in predicted and experimental expectation values and ideal unitary and return loss value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">VariableDict</span><span class="p">,</span>
        <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">expectation_values</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function implement a unified interface for nn.Module.</span>

<span class="sd">        Args:</span>
<span class="sd">            params (VariableDict): Model parameters to be optimized</span>
<span class="sd">            control_parameters (jnp.ndarray): Control parameters parametrized Hamiltonian</span>
<span class="sd">            unitaries (jnp.ndarray): The Ideal unitary operators corresponding to the control parameters</span>
<span class="sd">            expectation_values (jnp.ndarray): Experimental expectation values to calculate the loss value</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[jnp.ndarray, dict[str, jnp.ndarray]]: The loss value and other metrics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">control_parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kwargs</span><span class="p">)</span>
        <span class="n">predicted_expectation_value</span> <span class="o">=</span> <span class="n">adapter_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">unitaries</span><span class="o">=</span><span class="n">unitaries</span><span class="p">)</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="n">evaluate_fn</span><span class="p">(</span><span class="n">predicted_expectation_value</span><span class="p">,</span> <span class="n">expectation_values</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">loss</span><span class="p">),</span> <span class="p">{}</span>

    <span class="k">return</span> <span class="n">loss_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.linen.create_step" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_step</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_step</span><span class="p">(</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n"><span title="optax.GradientTransformation">GradientTransformation</span></span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]</span>
    <span class="o">|</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="typing.Tuple">Tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]],</span>
    <span class="n">has_aux</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The create_step function creates a training step function and a test step function.</p>
<p>loss_fn should have the following signature:
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">PyTree</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">loss_value</span>
</code></pre></div>
where <code>params</code> is the parameters to be optimized, and <code>args</code> are the inputs for the loss function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
                  <code><span title="optax.GradientTransformation">GradientTransformation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>optax</code> optimizer.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jaxtyping.PyTree">PyTree</span>, ...], <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loss function, which takes in the model parameters, inputs, and targets, and returns the loss value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>has_aux</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the loss function return aux data or not. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>typing.Any</em>: train_step, test_step</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/linen.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_step</span><span class="p">(</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformation</span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="p">(</span>
        <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
        <span class="o">|</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span>
    <span class="p">),</span>
    <span class="n">has_aux</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The create_step function creates a training step function and a test step function.</span>

<span class="sd">    loss_fn should have the following signature:</span>
<span class="sd">    ```py</span>
<span class="sd">    def loss_fn(params: jaxtyping.PyTree, *args) -&gt; jnp.ndarray:</span>
<span class="sd">        ...</span>
<span class="sd">        return loss_value</span>
<span class="sd">    ```</span>
<span class="sd">    where `params` is the parameters to be optimized, and `args` are the inputs for the loss function.</span>

<span class="sd">    Args:</span>
<span class="sd">        optimizer (optax.GradientTransformation): `optax` optimizer.</span>
<span class="sd">        loss_fn (typing.Callable[[jaxtyping.PyTree, ...], jnp.ndarray]): Loss function, which takes in the model parameters, inputs, and targets, and returns the loss value.</span>
<span class="sd">        has_aux (bool, optional): Whether the loss function return aux data or not. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        _typing.Any_: train_step, test_step</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># * Generalized training step</span>
    <span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">train_step</span><span class="p">(</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">PyTree</span><span class="p">,</span>
        <span class="n">optimizer_state</span><span class="p">:</span> <span class="n">optax</span><span class="o">.</span><span class="n">OptState</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">loss_value</span><span class="p">,</span> <span class="n">grads</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">value_and_grad</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">has_aux</span><span class="o">=</span><span class="n">has_aux</span><span class="p">)(</span>
            <span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="n">updates</span><span class="p">,</span> <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">optimizer_state</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">apply_updates</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">updates</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">params</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">loss_value</span>

    <span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_step</span><span class="p">(</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">PyTree</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">train_step</span><span class="p">,</span> <span class="n">test_step</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.linen.train_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">train_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">train_model</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">train_data</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></span><span class="p">,</span>
    <span class="n">val_data</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></span><span class="p">,</span>
    <span class="n">test_data</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="flax.linen.Module">Module</span></span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n"><span title="optax.GradientTransformation">GradientTransformation</span></span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="typing.Callable">Callable</span></span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">NUM_EPOCH</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">model_params</span><span class="p">:</span> <span class="n"><span title="flax.typing.VariableDict">VariableDict</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">opt_state</span><span class="p">:</span> <span class="n"><span title="optax.OptState">OptState</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Train the BlackBox model</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The number of epochs break down</span>
<span class="gp">... </span><span class="n">NUM_EPOCH</span> <span class="o">=</span> <span class="mi">150</span>
<span class="gp">... </span><span class="c1"># Total number of iterations as 90% of data is used for training</span>
<span class="gp">... </span><span class="c1"># 10% of the data is used for testing</span>
<span class="gp">... </span><span class="n">total_iterations</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">NUM_EPOCH</span>
<span class="gp">... </span><span class="c1"># The step for optimizer if set to 8 * NUM_EPOCH (should be less than total_iterations)</span>
<span class="gp">... </span><span class="n">step_for_optimizer</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">NUM_EPOCH</span>
<span class="gp">... </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">get_default_optimizer</span><span class="p">(</span><span class="n">step_for_optimizer</span><span class="p">)</span>
<span class="gp">... </span><span class="c1"># The warmup steps for the optimizer</span>
<span class="gp">... </span><span class="n">warmup_steps</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">step_for_optimizer</span>
<span class="gp">... </span><span class="c1"># The cool down steps for the optimizer</span>
<span class="gp">... </span><span class="n">cool_down_steps</span> <span class="o">=</span> <span class="n">total_iterations</span> <span class="o">-</span> <span class="n">step_for_optimizer</span>
<span class="gp">... </span><span class="n">total_iterations</span><span class="p">,</span> <span class="n">step_for_optimizer</span><span class="p">,</span> <span class="n">warmup_steps</span><span class="p">,</span> <span class="n">cool_down_steps</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to be used for training</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
                  <code><span title="optax.GradientTransformation">GradientTransformation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimizer to be used for training</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loss function to be used for training</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callbacks</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of callback functions. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>NUM_EPOCH</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of epochs. Defaults to 1_000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model parameters, optimizer state, and the histories</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/linen.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train_model</span><span class="p">(</span>
    <span class="c1"># Random key</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="c1"># Data</span>
    <span class="n">train_data</span><span class="p">:</span> <span class="n">DataBundled</span><span class="p">,</span>
    <span class="n">val_data</span><span class="p">:</span> <span class="n">DataBundled</span><span class="p">,</span>
    <span class="n">test_data</span><span class="p">:</span> <span class="n">DataBundled</span><span class="p">,</span>
    <span class="c1"># Model to be used for training</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformation</span><span class="p">,</span>
    <span class="c1"># Loss function to be used</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="c1"># Callbacks to be used</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="c1"># Number of epochs</span>
    <span class="n">NUM_EPOCH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1_000</span><span class="p">,</span>
    <span class="c1"># Optional state</span>
    <span class="n">model_params</span><span class="p">:</span> <span class="n">VariableDict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">opt_state</span><span class="p">:</span> <span class="n">optax</span><span class="o">.</span><span class="n">OptState</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train the BlackBox model</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # The number of epochs break down</span>
<span class="sd">        ... NUM_EPOCH = 150</span>
<span class="sd">        ... # Total number of iterations as 90% of data is used for training</span>
<span class="sd">        ... # 10% of the data is used for testing</span>
<span class="sd">        ... total_iterations = 9 * NUM_EPOCH</span>
<span class="sd">        ... # The step for optimizer if set to 8 * NUM_EPOCH (should be less than total_iterations)</span>
<span class="sd">        ... step_for_optimizer = 8 * NUM_EPOCH</span>
<span class="sd">        ... optimizer = get_default_optimizer(step_for_optimizer)</span>
<span class="sd">        ... # The warmup steps for the optimizer</span>
<span class="sd">        ... warmup_steps = 0.1 * step_for_optimizer</span>
<span class="sd">        ... # The cool down steps for the optimizer</span>
<span class="sd">        ... cool_down_steps = total_iterations - step_for_optimizer</span>
<span class="sd">        ... total_iterations, step_for_optimizer, warmup_steps, cool_down_steps</span>

<span class="sd">    Args:</span>
<span class="sd">        key (jnp.ndarray): Random key</span>
<span class="sd">        model (nn.Module): The model to be used for training</span>
<span class="sd">        optimizer (optax.GradientTransformation): The optimizer to be used for training</span>
<span class="sd">        loss_fn (typing.Callable): The loss function to be used for training</span>
<span class="sd">        callbacks (list[typing.Callable], optional): list of callback functions. Defaults to [].</span>
<span class="sd">        NUM_EPOCH (int, optional): The number of epochs. Defaults to 1_000.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: The model parameters, optimizer state, and the histories</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span><span class="p">,</span> <span class="n">loader_key</span><span class="p">,</span> <span class="n">init_key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">train_p</span><span class="p">,</span> <span class="n">train_u</span><span class="p">,</span> <span class="n">train_ex</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">control_params</span><span class="p">,</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">,</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">observables</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">val_p</span><span class="p">,</span> <span class="n">val_u</span><span class="p">,</span> <span class="n">val_ex</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">val_data</span><span class="o">.</span><span class="n">control_params</span><span class="p">,</span>
        <span class="n">val_data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">,</span>
        <span class="n">val_data</span><span class="o">.</span><span class="n">observables</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">test_p</span><span class="p">,</span> <span class="n">test_u</span><span class="p">,</span> <span class="n">test_ex</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">test_data</span><span class="o">.</span><span class="n">control_params</span><span class="p">,</span>
        <span class="n">test_data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">,</span>
        <span class="n">test_data</span><span class="o">.</span><span class="n">observables</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="n">val_p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">model_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Initialize the model parameters if it is None</span>
        <span class="n">model_params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">init_key</span><span class="p">,</span> <span class="n">train_p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">opt_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Initalize the optimizer state if it is None</span>
        <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">model_params</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="c1"># histories: list[dict[str, typing.Any]] = []</span>
    <span class="n">histories</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HistoryEntryV3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">train_step</span><span class="p">,</span> <span class="n">eval_step</span> <span class="o">=</span> <span class="n">create_step</span><span class="p">(</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">has_aux</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">is_last_batch</span><span class="p">,</span> <span class="n">epoch_idx</span><span class="p">),</span> <span class="p">(</span>
        <span class="n">batch_p</span><span class="p">,</span>
        <span class="n">batch_u</span><span class="p">,</span>
        <span class="n">batch_ex</span><span class="p">,</span>
    <span class="p">)</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">(</span>
        <span class="p">(</span><span class="n">train_p</span><span class="p">,</span> <span class="n">train_u</span><span class="p">,</span> <span class="n">train_ex</span><span class="p">),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
        <span class="n">num_epochs</span><span class="o">=</span><span class="n">NUM_EPOCH</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="n">loader_key</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">model_params</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">aux</span><span class="p">)</span> <span class="o">=</span> <span class="n">train_step</span><span class="p">(</span>
            <span class="n">model_params</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">batch_p</span><span class="p">,</span> <span class="n">batch_u</span><span class="p">,</span> <span class="n">batch_ex</span>
        <span class="p">)</span>

        <span class="n">histories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HistoryEntryV3</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">aux</span><span class="o">=</span><span class="n">aux</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">is_last_batch</span><span class="p">:</span>
            <span class="c1"># Validation</span>
            <span class="p">(</span><span class="n">val_loss</span><span class="p">,</span> <span class="n">aux</span><span class="p">)</span> <span class="o">=</span> <span class="n">eval_step</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">val_p</span><span class="p">,</span> <span class="n">val_u</span><span class="p">,</span> <span class="n">val_ex</span><span class="p">)</span>

            <span class="n">histories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">HistoryEntryV3</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">val_loss</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="s2">&quot;val&quot;</span><span class="p">,</span> <span class="n">aux</span><span class="o">=</span><span class="n">aux</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># Testing</span>
            <span class="p">(</span><span class="n">test_loss</span><span class="p">,</span> <span class="n">aux</span><span class="p">)</span> <span class="o">=</span> <span class="n">eval_step</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">test_p</span><span class="p">,</span> <span class="n">test_u</span><span class="p">,</span> <span class="n">test_ex</span><span class="p">)</span>

            <span class="n">histories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">HistoryEntryV3</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">test_loss</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">aux</span><span class="o">=</span><span class="n">aux</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
                <span class="n">callback</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">histories</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model_params</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">histories</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="nnx">NNX</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.models.nnx" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.models.nnx</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.models.nnx.Blackbox" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Blackbox</span>


</h3>


    <div class="doc doc-contents ">



        <p>The abstract class for interfacing the Blackbox model of the Graybox</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Blackbox</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The abstract class for interfacing the Blackbox model of the Graybox&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.models.nnx.WoModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">WoModel</span>


</h3>


    <div class="doc doc-contents ">



        <p><span class="arithmatex">\(\hat{W}_{O}\)</span> based blackbox model.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">WoModel</span><span class="p">(</span><span class="n">Blackbox</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;$\\hat{W}_{O}$ based blackbox model.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">shared_layers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">pauli_layers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            shared_layers (list[int]): Each integer in the list is a size of the width of each hidden layer in the shared layers.</span>
<span class="sd">            pauli_layers (list[int]): Each integer in the list is a size of the width of each hidden layer in the Pauli layers.</span>
<span class="sd">            rngs (nnx.Rngs): Random number generator of `nnx`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">shared_layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="sa">f</span><span class="s2">&quot;shared/</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                    <span class="n">in_features</span><span class="o">=</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">out_features</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="n">shared_layers</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">shared_layers</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_shared_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">shared_layers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_pauli_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pauli_layers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pauli_layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unitary_layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pauli</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">]:</span>
            <span class="n">layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="sa">f</span><span class="s2">&quot;pauli/</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                        <span class="n">in_features</span><span class="o">=</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">out_features</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                        <span class="nb">zip</span><span class="p">(</span><span class="n">pauli_layers</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">pauli_layers</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                    <span class="p">)</span>
                <span class="p">}</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pauli_layers</span><span class="p">[</span><span class="n">pauli</span><span class="p">]</span> <span class="o">=</span> <span class="n">layers</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">unitary_layers</span><span class="p">[</span><span class="n">pauli</span><span class="p">]</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                <span class="n">in_features</span><span class="o">=</span><span class="n">pauli_layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_layers</span><span class="p">[</span><span class="n">pauli</span><span class="p">]</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                <span class="n">in_features</span><span class="o">=</span><span class="n">pauli_layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_shared_layers</span><span class="p">):</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_layers</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;shared/</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="n">observables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pauli</span><span class="p">,</span> <span class="n">pauli_layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pauli_layers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">_x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_pauli_layers</span><span class="p">):</span>
                <span class="n">layer</span> <span class="o">=</span> <span class="n">pauli_layer</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;pauli/</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
                <span class="n">_x</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">layer</span><span class="p">(</span><span class="n">_x</span><span class="p">))</span>

            <span class="n">unitary_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitary_layers</span><span class="p">[</span><span class="n">pauli</span><span class="p">](</span><span class="n">_x</span><span class="p">)</span>
            <span class="n">diagonal_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_layers</span><span class="p">[</span><span class="n">pauli</span><span class="p">](</span><span class="n">_x</span><span class="p">)</span>

            <span class="n">unitary_param</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">nnx</span><span class="o">.</span><span class="n">hard_sigmoid</span><span class="p">(</span><span class="n">unitary_param</span><span class="p">)</span>
            <span class="n">diagonal_param</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">nnx</span><span class="o">.</span><span class="n">hard_sigmoid</span><span class="p">(</span><span class="n">diagonal_param</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="n">observables</span><span class="p">[</span><span class="n">pauli</span><span class="p">]</span> <span class="o">=</span> <span class="n">hermitian</span><span class="p">(</span><span class="n">unitary_param</span><span class="p">,</span> <span class="n">diagonal_param</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">observables</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.models.nnx.WoModel.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">(</span>
    <span class="n">shared_layers</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">],</span>
    <span class="n">pauli_layers</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">rngs</span><span class="p">:</span> <span class="n"><span title="flax.nnx.Rngs">Rngs</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>shared_layers</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Each integer in the list is a size of the width of each hidden layer in the shared layers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pauli_layers</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Each integer in the list is a size of the width of each hidden layer in the Pauli layers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><span title="flax.nnx.Rngs">Rngs</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generator of <code>nnx</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">shared_layers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">pauli_layers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        shared_layers (list[int]): Each integer in the list is a size of the width of each hidden layer in the shared layers.</span>
<span class="sd">        pauli_layers (list[int]): Each integer in the list is a size of the width of each hidden layer in the Pauli layers.</span>
<span class="sd">        rngs (nnx.Rngs): Random number generator of `nnx`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">shared_layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;shared/</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                <span class="n">in_features</span><span class="o">=</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">out_features</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                <span class="nb">zip</span><span class="p">(</span><span class="n">shared_layers</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">shared_layers</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">num_shared_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">shared_layers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_pauli_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pauli_layers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pauli_layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unitary_layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">pauli</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">]:</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="sa">f</span><span class="s2">&quot;pauli/</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                    <span class="n">in_features</span><span class="o">=</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">out_features</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="n">pauli_layers</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">pauli_layers</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pauli_layers</span><span class="p">[</span><span class="n">pauli</span><span class="p">]</span> <span class="o">=</span> <span class="n">layers</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">unitary_layers</span><span class="p">[</span><span class="n">pauli</span><span class="p">]</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
            <span class="n">in_features</span><span class="o">=</span><span class="n">pauli_layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_layers</span><span class="p">[</span><span class="n">pauli</span><span class="p">]</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
            <span class="n">in_features</span><span class="o">=</span><span class="n">pauli_layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.models.nnx.UnitaryModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">UnitaryModel</span>


</h3>


    <div class="doc doc-contents ">



        <p>Unitary-based model, predicting parameters parametrized unitary operator in range <span class="arithmatex">\([0, 2\pi]\)</span>.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">UnitaryModel</span><span class="p">(</span><span class="n">Blackbox</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unitary-based model, predicting parameters parametrized unitary operator in range $[0, 2\\pi]$.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_sizes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            hidden_sizes (list[int]): Each integer in the list is a size of the width of each hidden layer in the shared layers</span>
<span class="sd">            rngs (nnx.Rngs): Random number generator of `nnx`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_sizes</span> <span class="o">=</span> <span class="n">hidden_sizes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NUM_UNITARY_PARAMS</span> <span class="o">=</span> <span class="mi">4</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="sa">f</span><span class="s2">&quot;hidden_layers/</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                    <span class="n">in_features</span><span class="o">=</span><span class="n">hidden_size</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">hidden_size</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">hidden_size</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_sizes</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># Initialize the final layer for unitary parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layer</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
            <span class="n">in_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_sizes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">out_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NUM_UNITARY_PARAMS</span><span class="p">,</span>
            <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="c1"># Apply the hidden layers with ReLU activation</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="c1"># Apply the final layer and transform the output</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">nnx</span><span class="o">.</span><span class="n">hard_sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.models.nnx.UnitaryModel.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">(</span><span class="n">hidden_sizes</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n"><span title="flax.nnx.Rngs">Rngs</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hidden_sizes</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Each integer in the list is a size of the width of each hidden layer in the shared layers</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><span title="flax.nnx.Rngs">Rngs</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generator of <code>nnx</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_sizes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        hidden_sizes (list[int]): Each integer in the list is a size of the width of each hidden layer in the shared layers</span>
<span class="sd">        rngs (nnx.Rngs): Random number generator of `nnx`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hidden_sizes</span> <span class="o">=</span> <span class="n">hidden_sizes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">NUM_UNITARY_PARAMS</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;hidden_layers/</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                <span class="n">in_features</span><span class="o">=</span><span class="n">hidden_size</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">hidden_size</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">hidden_size</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_sizes</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Initialize the final layer for unitary parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">final_layer</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
        <span class="n">in_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_sizes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">out_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NUM_UNITARY_PARAMS</span><span class="p">,</span>
        <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.models.nnx.UnitarySPAMModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">UnitarySPAMModel</span>


</h3>


    <div class="doc doc-contents ">



        <p>Composite class of unitary-based model and the SPAM model.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">UnitarySPAMModel</span><span class="p">(</span><span class="n">Blackbox</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Composite class of unitary-based model and the SPAM model.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">unitary_model</span><span class="p">:</span> <span class="n">UnitaryModel</span><span class="p">,</span> <span class="n">spam_params</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            unitary_model (UnitaryModel): Unitary-based model that have already initialized.</span>
<span class="sd">            rngs (nnx.Rngs): Random number generator of `nnx`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unitary_model</span> <span class="o">=</span> <span class="n">unitary_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spam_params</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Param</span><span class="p">,</span> <span class="n">spam_params</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;model_params&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitary_model</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;spam_params&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">spam_params</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.models.nnx.UnitarySPAMModel.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">(</span>
    <span class="n">unitary_model</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            UnitaryModel (src.inspeqtor.v1.models.nnx.UnitaryModel)" href="#src.inspeqtor.v1.models.nnx.UnitaryModel">UnitaryModel</a></span><span class="p">,</span> <span class="n">spam_params</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n"><span title="flax.nnx.Rngs">Rngs</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>unitary_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            UnitaryModel (src.inspeqtor.v1.models.nnx.UnitaryModel)" href="#src.inspeqtor.v1.models.nnx.UnitaryModel">UnitaryModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unitary-based model that have already initialized.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><span title="flax.nnx.Rngs">Rngs</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generator of <code>nnx</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">unitary_model</span><span class="p">:</span> <span class="n">UnitaryModel</span><span class="p">,</span> <span class="n">spam_params</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        unitary_model (UnitaryModel): Unitary-based model that have already initialized.</span>
<span class="sd">        rngs (nnx.Rngs): Random number generator of `nnx`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unitary_model</span> <span class="o">=</span> <span class="n">unitary_model</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spam_params</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Param</span><span class="p">,</span> <span class="n">spam_params</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.nnx.wo_predictive_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">wo_predictive_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">wo_predictive_fn</span><span class="p">(</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            WoModel (src.inspeqtor.v1.models.nnx.WoModel)" href="#src.inspeqtor.v1.models.nnx.WoModel">WoModel</a></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adapter function for <span class="arithmatex">\(\hat{W}_{O}\)</span> based model to be used with <code>make_loss_fn</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            WoModel (src.inspeqtor.v1.models.nnx.WoModel)" href="#src.inspeqtor.v1.models.nnx.WoModel">WoModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><span class="arithmatex">\(\hat{W}_{O}\)</span> based model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A bundled of data for the predictive model training.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Predicted expectation values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wo_predictive_fn</span><span class="p">(</span>
    <span class="c1"># Input data to the model</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">WoModel</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adapter function for $\\hat{W}_{O}$ based model to be used with `make_loss_fn`.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (WoModel): $\\hat{W}_{O}$ based model</span>
<span class="sd">        data (DataBundled): A bundled of data for the predictive model training.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Predicted expectation values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">observable_to_expvals</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.nnx.noisy_unitary_predictive_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">noisy_unitary_predictive_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">noisy_unitary_predictive_fn</span><span class="p">(</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            UnitaryModel (src.inspeqtor.v1.models.nnx.UnitaryModel)" href="#src.inspeqtor.v1.models.nnx.UnitaryModel">UnitaryModel</a></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adapter function for unitary-based model to be used with <code>make_loss_fn</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            UnitaryModel (src.inspeqtor.v1.models.nnx.UnitaryModel)" href="#src.inspeqtor.v1.models.nnx.UnitaryModel">UnitaryModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unitary-based model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A bundled of data for the predictive model training.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Predicted expectation values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">noisy_unitary_predictive_fn</span><span class="p">(</span>
    <span class="c1"># Input data to the model</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">UnitaryModel</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adapter function for unitary-based model to be used with `make_loss_fn`</span>

<span class="sd">    Args:</span>
<span class="sd">        model (UnitaryModel): Unitary-based model.</span>
<span class="sd">        data (DataBundled): A bundled of data for the predictive model training.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Predicted expectation values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unitary_params</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">unitary_to_expvals</span><span class="p">(</span><span class="n">unitary_params</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.nnx.toggling_unitary_predictive_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">toggling_unitary_predictive_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toggling_unitary_predictive_fn</span><span class="p">(</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            UnitaryModel (src.inspeqtor.v1.models.nnx.UnitaryModel)" href="#src.inspeqtor.v1.models.nnx.UnitaryModel">UnitaryModel</a></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adapter function for rotating toggling frame unitary based model to be used with <code>make_loss_fn</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            UnitaryModel (src.inspeqtor.v1.models.nnx.UnitaryModel)" href="#src.inspeqtor.v1.models.nnx.UnitaryModel">UnitaryModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unitary-based model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A bundled of data for the predictive model training.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Predicted expectation values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">toggling_unitary_predictive_fn</span><span class="p">(</span>
    <span class="c1"># Input data to the model</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">UnitaryModel</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adapter function for rotating toggling frame unitary based model to be used with `make_loss_fn`</span>

<span class="sd">    Args:</span>
<span class="sd">        model (UnitaryModel): Unitary-based model.</span>
<span class="sd">        data (DataBundled): A bundled of data for the predictive model training.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Predicted expectation values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unitary_params</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">toggling_unitary_to_expvals</span><span class="p">(</span><span class="n">unitary_params</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.nnx.toggling_unitary_with_spam_predictive_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">toggling_unitary_with_spam_predictive_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toggling_unitary_with_spam_predictive_fn</span><span class="p">(</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            UnitarySPAMModel (src.inspeqtor.v1.models.nnx.UnitarySPAMModel)" href="#src.inspeqtor.v1.models.nnx.UnitarySPAMModel">UnitarySPAMModel</a></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adapter function for a composite rotating toggling
frame unitary based model to be used with <code>make_loss_fn</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            UnitaryModel (src.inspeqtor.v1.models.nnx.UnitaryModel)" href="#src.inspeqtor.v1.models.nnx.UnitaryModel">UnitaryModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unitary-based SPAM model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A bundled of data for the predictive model training.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Predicted expectation values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">toggling_unitary_with_spam_predictive_fn</span><span class="p">(</span>
    <span class="c1"># Input data to the model</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">UnitarySPAMModel</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adapter function for a composite rotating toggling</span>
<span class="sd">    frame unitary based model to be used with `make_loss_fn`</span>

<span class="sd">    Args:</span>
<span class="sd">        model (UnitaryModel): Unitary-based SPAM model.</span>
<span class="sd">        data (DataBundled): A bundled of data for the predictive model training.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Predicted expectation values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">toggling_unitary_with_spam_to_expvals</span><span class="p">(</span>
        <span class="c1"># {</span>
        <span class="c1">#     &quot;model_params&quot;: params[&#39;model_params&#39;],</span>
        <span class="c1">#     &quot;spam_params&quot;: model.spam_params,</span>
        <span class="c1"># },</span>
        <span class="n">params</span><span class="p">,</span>
        <span class="n">unitaries</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.nnx.make_loss_fn_old" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_loss_fn_old</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_loss_fn_old</span><span class="p">(</span>
    <span class="n">predictive_fn</span><span class="p">,</span>
    <span class="n">calculate_metric_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.v1.model.calculate_metric">calculate_metric</span></span><span class="p">,</span>
    <span class="n">loss_metric</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.model.LossMetric">LossMetric</span></span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.model.LossMetric.MSEE">MSEE</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A function for preparing loss function to be used for model training.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predictive_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adaptor function specifically for each model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>calculate_metric_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for calculating metrics. Defaults to calculate_metric.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.calculate_metric">calculate_metric</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_metric</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.LossMetric">LossMetric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chosen loss function to be optimized. Defaults to LossMetric.MSEE.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.LossMetric.MSEE">MSEE</span></code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span><span class="o">.</span><span class="n">deprecated</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_loss_fn_old</span><span class="p">(</span>
    <span class="n">predictive_fn</span><span class="p">,</span>
    <span class="n">calculate_metric_fn</span><span class="o">=</span><span class="n">calculate_metric</span><span class="p">,</span>
    <span class="n">loss_metric</span><span class="p">:</span> <span class="n">LossMetric</span> <span class="o">=</span> <span class="n">LossMetric</span><span class="o">.</span><span class="n">MSEE</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A function for preparing loss function to be used for model training.</span>

<span class="sd">    Args:</span>
<span class="sd">        predictive_fn (typing.Any): Adaptor function specifically for each model.</span>
<span class="sd">        calculate_metric_fn (typing.Any, optional): Function for calculating metrics. Defaults to calculate_metric.</span>
<span class="sd">        loss_metric (LossMetric, optional): The chosen loss function to be optimized. Defaults to LossMetric.MSEE.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Blackbox</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">DataBundled</span><span class="p">):</span>
        <span class="n">expval</span> <span class="o">=</span> <span class="n">predictive_fn</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">control_params</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

        <span class="n">metrics</span> <span class="o">=</span> <span class="n">calculate_metric_fn</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">observables</span><span class="p">,</span> <span class="n">expval</span><span class="p">)</span>
        <span class="c1"># Take mean of all the metrics</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="n">loss_metric</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span>

    <span class="k">return</span> <span class="n">loss_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.nnx.make_loss_fn_oldv2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_loss_fn_oldv2</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_loss_fn_oldv2</span><span class="p">(</span>
    <span class="n">adapter_fn</span><span class="p">,</span>
    <span class="n">calculate_metric_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.v1.model.calculate_metric">calculate_metric</span></span><span class="p">,</span>
    <span class="n">loss_metric</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.model.LossMetric">LossMetric</span></span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.model.LossMetric.MSEE">MSEE</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A function for preparing loss function to be used for model training.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predictive_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adaptor function specifically for each model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>calculate_metric_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for calculating metrics. Defaults to calculate_metric.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.calculate_metric">calculate_metric</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_metric</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.LossMetric">LossMetric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chosen loss function to be optimized. Defaults to LossMetric.MSEE.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.model.LossMetric.MSEE">MSEE</span></code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="s2">&quot;Use new `make_loss_fn` instead&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_loss_fn_oldv2</span><span class="p">(</span>
    <span class="n">adapter_fn</span><span class="p">,</span>
    <span class="n">calculate_metric_fn</span><span class="o">=</span><span class="n">calculate_metric</span><span class="p">,</span>
    <span class="n">loss_metric</span><span class="p">:</span> <span class="n">LossMetric</span> <span class="o">=</span> <span class="n">LossMetric</span><span class="o">.</span><span class="n">MSEE</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A function for preparing loss function to be used for model training.</span>

<span class="sd">    Args:</span>
<span class="sd">        predictive_fn (typing.Any): Adaptor function specifically for each model.</span>
<span class="sd">        calculate_metric_fn (typing.Any, optional): Function for calculating metrics. Defaults to calculate_metric.</span>
<span class="sd">        loss_metric (LossMetric, optional): The chosen loss function to be optimized. Defaults to LossMetric.MSEE.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Blackbox</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">DataBundled</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">control_params</span><span class="p">)</span>

        <span class="n">expval</span> <span class="o">=</span> <span class="n">adapter_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">)</span>

        <span class="n">metrics</span> <span class="o">=</span> <span class="n">calculate_metric_fn</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">observables</span><span class="p">,</span> <span class="n">expval</span><span class="p">)</span>
        <span class="c1"># Take mean of all the metrics</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="n">loss_metric</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span>

    <span class="k">return</span> <span class="n">loss_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.nnx.make_loss_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_loss_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_loss_fn</span><span class="p">(</span><span class="n">adapter_fn</span><span class="p">,</span> <span class="n">evaluate_fn</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A function for preparing loss function to be used for model training.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predictive_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adaptor function specifically for each model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evaluate_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Take in predicted and experimental expectation values and ideal unitary and return loss value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_loss_fn</span><span class="p">(</span><span class="n">adapter_fn</span><span class="p">,</span> <span class="n">evaluate_fn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A function for preparing loss function to be used for model training.</span>

<span class="sd">    Args:</span>
<span class="sd">        predictive_fn (typing.Any): Adaptor function specifically for each model.</span>
<span class="sd">        evaluate_fn (typing.Callable[[jnp.ndarray, jnp.ndarray], jnp.ndarray, jnp.ndarray]): Take in predicted and experimental expectation values and ideal unitary and return loss value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Blackbox</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">DataBundled</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">control_params</span><span class="p">)</span>

        <span class="n">expval</span> <span class="o">=</span> <span class="n">adapter_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">)</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="n">evaluate_fn</span><span class="p">(</span><span class="n">expval</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">observables</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">loss</span><span class="p">),</span> <span class="p">{}</span>

    <span class="k">return</span> <span class="n">loss_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.nnx.create_step" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_step</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_step</span><span class="p">(</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            Blackbox (src.inspeqtor.v1.models.nnx.Blackbox)" href="#src.inspeqtor.v1.models.nnx.Blackbox">Blackbox</a></span><span class="p">,</span> <span class="n"><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></span><span class="p">],</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span>
    <span class="p">],</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A function to create the traning and evaluating step for model.
The train step will update the model parameters and optimizer parameters inplace.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="            Blackbox (src.inspeqtor.v1.models.nnx.Blackbox)" href="#src.inspeqtor.v1.models.nnx.Blackbox">Blackbox</a>, <span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span>], <span title="tuple">tuple</span>[<span title="jax.numpy.ndarray">ndarray</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loss function returned from <code>make_loss_fn</code></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: The tuple of training and eval step functions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_step</span><span class="p">(</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Blackbox</span><span class="p">,</span> <span class="n">DataBundled</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A function to create the traning and evaluating step for model.</span>
<span class="sd">    The train step will update the model parameters and optimizer parameters inplace.</span>

<span class="sd">    Args:</span>
<span class="sd">        loss_fn (typing.Callable[[Blackbox, DataBundled], tuple[jnp.ndarray, typing.Any]]): Loss function returned from `make_loss_fn`</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: The tuple of training and eval step functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@nnx</span><span class="o">.</span><span class="n">jit</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">train_step</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">Blackbox</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">,</span>
        <span class="n">metrics</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">MultiMetric</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">DataBundled</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Train for a single step.&quot;&quot;&quot;</span>
        <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>  <span class="c1"># Switch to train mode</span>
        <span class="n">grad_fn</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">value_and_grad</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">has_aux</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">aux</span><span class="p">),</span> <span class="n">grads</span> <span class="o">=</span> <span class="n">grad_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="n">metrics</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>  <span class="c1"># In-place updates.</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">grads</span><span class="p">)</span>  <span class="c1"># In-place updates.</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">aux</span>

    <span class="nd">@nnx</span><span class="o">.</span><span class="n">jit</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eval_step</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Blackbox</span><span class="p">,</span> <span class="n">metrics</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">MultiMetric</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="n">loss</span><span class="p">,</span> <span class="n">aux</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="n">metrics</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>  <span class="c1"># In-place updates.</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">aux</span>

    <span class="k">return</span> <span class="n">train_step</span><span class="p">,</span> <span class="n">eval_step</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.nnx.reconstruct_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">reconstruct_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">reconstruct_model</span><span class="p">(</span>
    <span class="n">model_params</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">Model</span><span class="p">:</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.models.nnx.T">T</span></span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="src.inspeqtor.v1.models.nnx.T">T</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Reconstruct the model from the model parameters, config, and model initializer.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">blackbox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_params</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">to_pure_dict</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>   <span class="s2">&quot;shared_layers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>   <span class="s2">&quot;pauli_layers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_data</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ModelData</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">model_params</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
<span class="go"># save and load to and from disk!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blackbox</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">nnx</span><span class="o">.</span><span class="n">reconstruct_model</span><span class="p">(</span><span class="n">model_data</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">model_data</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">sq</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">nnx</span><span class="o">.</span><span class="n">WoModel</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_params</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pytree containing model parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model configuration for model initialization.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Model</code>
            </td>
            <td>
                  <code><span title="type">type</span>[<span title="src.inspeqtor.v1.models.nnx.T">T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model initializer.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>T</code></td>            <td>
                  <code><span title="src.inspeqtor.v1.models.nnx.T">T</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reconstruct_model</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">Model</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reconstruct the model from the model parameters, config, and model initializer.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; _, state = nnx.split(blackbox)</span>
<span class="sd">        &gt;&gt;&gt; model_params = nnx.to_pure_dict(state)</span>
<span class="sd">        &gt;&gt;&gt; config = {</span>
<span class="sd">        ...    &quot;shared_layers&quot;: [8],</span>
<span class="sd">        ...    &quot;pauli_layers&quot;: [8]</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; model_data = sq.model.ModelData(params=model_params, config=config)</span>
<span class="sd">        # save and load to and from disk!</span>
<span class="sd">        &gt;&gt;&gt; blackbox = sq.models.nnx.reconstruct_model(model_data.params, model_data.config, sq.models.nnx.WoModel)</span>

<span class="sd">    Args:</span>
<span class="sd">        model_params (typing.Any): The pytree containing model parameters.</span>
<span class="sd">        config (typing.Any): The model configuration for model initialization.</span>
<span class="sd">        Model (type[T]): The model initializer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        T: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">abstract_model</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">eval_shape</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">Model</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
    <span class="n">graphdef</span><span class="p">,</span> <span class="n">abstract_state</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">abstract_model</span><span class="p">)</span>
    <span class="n">nnx</span><span class="o">.</span><span class="n">replace_by_pure_dict</span><span class="p">(</span><span class="n">abstract_state</span><span class="p">,</span> <span class="n">model_params</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">nnx</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">graphdef</span><span class="p">,</span> <span class="n">abstract_state</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.models.nnx.train_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">train_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">train_model</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">train_data</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></span><span class="p">,</span>
    <span class="n">val_data</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></span><span class="p">,</span>
    <span class="n">test_data</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.data.DataBundled">DataBundled</span></span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            Blackbox (src.inspeqtor.v1.models.nnx.Blackbox)" href="#src.inspeqtor.v1.models.nnx.Blackbox">Blackbox</a></span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n"><span title="optax.GradientTransformation">GradientTransformation</span></span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="typing.Callable">Callable</span></span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">NUM_EPOCH</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">_optimizer</span><span class="p">:</span> <span class="n"><span title="flax.nnx.Optimizer">Optimizer</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Train the BlackBox model</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The number of epochs break down</span>
<span class="gp">... </span><span class="n">NUM_EPOCH</span> <span class="o">=</span> <span class="mi">150</span>
<span class="gp">... </span><span class="c1"># Total number of iterations as 90% of data is used for training</span>
<span class="gp">... </span><span class="c1"># 10% of the data is used for testing</span>
<span class="gp">... </span><span class="n">total_iterations</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">NUM_EPOCH</span>
<span class="gp">... </span><span class="c1"># The step for optimizer if set to 8 * NUM_EPOCH (should be less than total_iterations)</span>
<span class="gp">... </span><span class="n">step_for_optimizer</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">NUM_EPOCH</span>
<span class="gp">... </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">get_default_optimizer</span><span class="p">(</span><span class="n">step_for_optimizer</span><span class="p">)</span>
<span class="gp">... </span><span class="c1"># The warmup steps for the optimizer</span>
<span class="gp">... </span><span class="n">warmup_steps</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">step_for_optimizer</span>
<span class="gp">... </span><span class="c1"># The cool down steps for the optimizer</span>
<span class="gp">... </span><span class="n">cool_down_steps</span> <span class="o">=</span> <span class="n">total_iterations</span> <span class="o">-</span> <span class="n">step_for_optimizer</span>
<span class="gp">... </span><span class="n">total_iterations</span><span class="p">,</span> <span class="n">step_for_optimizer</span><span class="p">,</span> <span class="n">warmup_steps</span><span class="p">,</span> <span class="n">cool_down_steps</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to be used for training</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
                  <code><span title="optax.GradientTransformation">GradientTransformation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimizer to be used for training</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loss function to be used for training</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callbacks</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of callback functions. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>NUM_EPOCH</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of epochs. Defaults to 1_000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model parameters, optimizer state, and the histories</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/models/nnx.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train_model</span><span class="p">(</span>
    <span class="c1"># Random key</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="c1"># Data</span>
    <span class="n">train_data</span><span class="p">:</span> <span class="n">DataBundled</span><span class="p">,</span>
    <span class="n">val_data</span><span class="p">:</span> <span class="n">DataBundled</span><span class="p">,</span>
    <span class="n">test_data</span><span class="p">:</span> <span class="n">DataBundled</span><span class="p">,</span>
    <span class="c1"># Model to be used for training</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Blackbox</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformation</span><span class="p">,</span>
    <span class="c1"># Loss function to be used</span>
    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="c1"># Callbacks to be used</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="c1"># Number of epochs</span>
    <span class="n">NUM_EPOCH</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1_000</span><span class="p">,</span>
    <span class="n">_optimizer</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Optimizer</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train the BlackBox model</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # The number of epochs break down</span>
<span class="sd">        ... NUM_EPOCH = 150</span>
<span class="sd">        ... # Total number of iterations as 90% of data is used for training</span>
<span class="sd">        ... # 10% of the data is used for testing</span>
<span class="sd">        ... total_iterations = 9 * NUM_EPOCH</span>
<span class="sd">        ... # The step for optimizer if set to 8 * NUM_EPOCH (should be less than total_iterations)</span>
<span class="sd">        ... step_for_optimizer = 8 * NUM_EPOCH</span>
<span class="sd">        ... optimizer = get_default_optimizer(step_for_optimizer)</span>
<span class="sd">        ... # The warmup steps for the optimizer</span>
<span class="sd">        ... warmup_steps = 0.1 * step_for_optimizer</span>
<span class="sd">        ... # The cool down steps for the optimizer</span>
<span class="sd">        ... cool_down_steps = total_iterations - step_for_optimizer</span>
<span class="sd">        ... total_iterations, step_for_optimizer, warmup_steps, cool_down_steps</span>

<span class="sd">    Args:</span>
<span class="sd">        key (jnp.ndarray): Random key</span>
<span class="sd">        model (nn.Module): The model to be used for training</span>
<span class="sd">        optimizer (optax.GradientTransformation): The optimizer to be used for training</span>
<span class="sd">        loss_fn (typing.Callable): The loss function to be used for training</span>
<span class="sd">        callbacks (list[typing.Callable], optional): list of callback functions. Defaults to [].</span>
<span class="sd">        NUM_EPOCH (int, optional): The number of epochs. Defaults to 1_000.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: The model parameters, optimizer state, and the histories</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span><span class="p">,</span> <span class="n">loader_key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="n">val_data</span><span class="o">.</span><span class="n">control_params</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">histories</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HistoryEntryV3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">_optimizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_optimizer</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="n">optimizer</span><span class="p">,</span>
            <span class="n">wrt</span><span class="o">=</span><span class="n">nnx</span><span class="o">.</span><span class="n">Param</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">metrics</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">MultiMetric</span><span class="p">(</span>
        <span class="n">loss</span><span class="o">=</span><span class="n">nnx</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Average</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">train_step</span><span class="p">,</span> <span class="n">eval_step</span> <span class="o">=</span> <span class="n">create_step</span><span class="p">(</span><span class="n">loss_fn</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">is_last_batch</span><span class="p">,</span> <span class="n">epoch_idx</span><span class="p">),</span> <span class="p">(</span>
        <span class="n">batch_p</span><span class="p">,</span>
        <span class="n">batch_u</span><span class="p">,</span>
        <span class="n">batch_ex</span><span class="p">,</span>
    <span class="p">)</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">train_data</span><span class="o">.</span><span class="n">control_params</span><span class="p">,</span>
            <span class="n">train_data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">,</span>
            <span class="n">train_data</span><span class="o">.</span><span class="n">observables</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
        <span class="n">num_epochs</span><span class="o">=</span><span class="n">NUM_EPOCH</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="n">loader_key</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">train_step</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="n">_optimizer</span><span class="p">,</span>
            <span class="n">metrics</span><span class="p">,</span>
            <span class="n">DataBundled</span><span class="p">(</span>
                <span class="n">control_params</span><span class="o">=</span><span class="n">batch_p</span><span class="p">,</span> <span class="n">unitaries</span><span class="o">=</span><span class="n">batch_u</span><span class="p">,</span> <span class="n">observables</span><span class="o">=</span><span class="n">batch_ex</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="n">histories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">HistoryEntryV3</span><span class="p">(</span>
                <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">metrics</span><span class="o">.</span><span class="n">compute</span><span class="p">()[</span><span class="s2">&quot;loss&quot;</span><span class="p">],</span> <span class="n">loop</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">aux</span><span class="o">=</span><span class="p">{}</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">metrics</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Reset the metrics for the train set.</span>

        <span class="k">if</span> <span class="n">is_last_batch</span><span class="p">:</span>
            <span class="c1"># Validation</span>
            <span class="n">eval_step</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">val_data</span><span class="p">)</span>
            <span class="n">histories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">HistoryEntryV3</span><span class="p">(</span>
                    <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">metrics</span><span class="o">.</span><span class="n">compute</span><span class="p">()[</span><span class="s2">&quot;loss&quot;</span><span class="p">],</span> <span class="n">loop</span><span class="o">=</span><span class="s2">&quot;val&quot;</span><span class="p">,</span> <span class="n">aux</span><span class="o">=</span><span class="p">{}</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">metrics</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Reset the metrics for the val set.</span>
            <span class="c1"># Testing</span>
            <span class="n">eval_step</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
            <span class="n">histories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">HistoryEntryV3</span><span class="p">(</span>
                    <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">metrics</span><span class="o">.</span><span class="n">compute</span><span class="p">()[</span><span class="s2">&quot;loss&quot;</span><span class="p">],</span> <span class="n">loop</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">aux</span><span class="o">=</span><span class="p">{}</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">metrics</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Reset the metrics for the test set.</span>

            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
                <span class="n">callback</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">_optimizer</span><span class="p">,</span> <span class="n">histories</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">_optimizer</span><span class="p">,</span> <span class="n">histories</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="optimize">Optimize</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.optimize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.optimize</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.optimize.get_default_optimizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_default_optimizer</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_default_optimizer</span><span class="p">(</span>
    <span class="n">n_iterations</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="optax.GradientTransformation">GradientTransformation</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate present optimizer from number of training iteration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_iterations</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training iteration</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="optax.GradientTransformation">GradientTransformation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optax.GradientTransformation: Optax optimizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/optimize.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_default_optimizer</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate present optimizer from number of training iteration.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_iterations (int): Training iteration</span>

<span class="sd">    Returns:</span>
<span class="sd">        optax.GradientTransformation: Optax optimizer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">optax</span><span class="o">.</span><span class="n">adamw</span><span class="p">(</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="n">optax</span><span class="o">.</span><span class="n">warmup_cosine_decay_schedule</span><span class="p">(</span>
            <span class="n">init_value</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
            <span class="n">peak_value</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
            <span class="n">warmup_steps</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">n_iterations</span><span class="p">),</span>
            <span class="n">decay_steps</span><span class="o">=</span><span class="n">n_iterations</span><span class="p">,</span>
            <span class="n">end_value</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.optimize.minimize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">minimize</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">minimize</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n"><span title="chex.ArrayTree">ArrayTree</span></span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]],</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n"><span title="optax.GradientTransformation">GradientTransformation</span></span><span class="p">,</span>
    <span class="n">lower</span><span class="p">:</span> <span class="n"><span title="chex.ArrayTree">ArrayTree</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">upper</span><span class="p">:</span> <span class="n"><span title="chex.ArrayTree">ArrayTree</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">maxiter</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="typing.Callable">Callable</span></span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="chex.ArrayTree">ArrayTree</span></span><span class="p">,</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="typing.Any">Any</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Optimize the loss function with bounded parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="chex.ArrayTree">ArrayTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Intiial parameters to be optimized</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lower</code>
            </td>
            <td>
                  <code><span title="chex.ArrayTree">ArrayTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bound of the parameters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upper</code>
            </td>
            <td>
                  <code><span title="chex.ArrayTree">ArrayTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bound of the parameters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>], <span title="tuple">tuple</span>[<span title="jax.numpy.ndarray">ndarray</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loss function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
                  <code><span title="optax.GradientTransformation">GradientTransformation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance of optax optimizer</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maxiter</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of optimization step. Defaults to 1000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="chex.ArrayTree">ArrayTree</span>, <span title="list">list</span>[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[chex.ArrayTree, list[typing.Any]]: Tuple of parameters and optimization history</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/optimize.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">minimize</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformation</span><span class="p">,</span>
    <span class="n">lower</span><span class="p">:</span> <span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">upper</span><span class="p">:</span> <span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">maxiter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optimize the loss function with bounded parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        params (chex.ArrayTree): Intiial parameters to be optimized</span>
<span class="sd">        lower (chex.ArrayTree): Lower bound of the parameters</span>
<span class="sd">        upper (chex.ArrayTree): Upper bound of the parameters</span>
<span class="sd">        func (typing.Callable[[jnp.ndarray], tuple[jnp.ndarray, typing.Any]]): Loss function</span>
<span class="sd">        optimizer (optax.GradientTransformation): Instance of optax optimizer</span>
<span class="sd">        maxiter (int, optional): Number of optimization step. Defaults to 1000.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[chex.ArrayTree, list[typing.Any]]: Tuple of parameters and optimization history</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">step_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
        <span class="n">grads</span><span class="p">,</span> <span class="n">aux</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">has_aux</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">params</span><span class="p">)</span>
        <span class="n">updates</span><span class="p">,</span> <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">apply_updates</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">updates</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">lower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">upper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Apply projection</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">projections</span><span class="o">.</span><span class="n">projection_box</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>

        <span class="c1"># Log the history</span>
        <span class="n">aux</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
        <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aux</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
            <span class="n">callback</span><span class="p">(</span><span class="n">step_idx</span><span class="p">,</span> <span class="n">aux</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">params</span><span class="p">,</span> <span class="n">history</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.optimize.stochastic_minimize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">stochastic_minimize</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">stochastic_minimize</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="n"><span title="chex.ArrayTree">ArrayTree</span></span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]],</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n"><span title="optax.GradientTransformation">GradientTransformation</span></span><span class="p">,</span>
    <span class="n">lower</span><span class="p">:</span> <span class="n"><span title="chex.ArrayTree">ArrayTree</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">upper</span><span class="p">:</span> <span class="n"><span title="chex.ArrayTree">ArrayTree</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">maxiter</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="typing.Callable">Callable</span></span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="chex.ArrayTree">ArrayTree</span></span><span class="p">,</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="typing.Any">Any</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Optimize the loss function with bounded parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="chex.ArrayTree">ArrayTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Intiial parameters to be optimized</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lower</code>
            </td>
            <td>
                  <code><span title="chex.ArrayTree">ArrayTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bound of the parameters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upper</code>
            </td>
            <td>
                  <code><span title="chex.ArrayTree">ArrayTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bound of the parameters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>], <span title="tuple">tuple</span>[<span title="jax.numpy.ndarray">ndarray</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loss function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
                  <code><span title="optax.GradientTransformation">GradientTransformation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance of optax optimizer</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maxiter</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of optimization step. Defaults to 1000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="chex.ArrayTree">ArrayTree</span>, <span title="list">list</span>[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[chex.ArrayTree, list[typing.Any]]: Tuple of parameters and optimization history</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/optimize.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stochastic_minimize</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformation</span><span class="p">,</span>
    <span class="n">lower</span><span class="p">:</span> <span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">upper</span><span class="p">:</span> <span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">maxiter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">chex</span><span class="o">.</span><span class="n">ArrayTree</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optimize the loss function with bounded parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        params (chex.ArrayTree): Intiial parameters to be optimized</span>
<span class="sd">        lower (chex.ArrayTree): Lower bound of the parameters</span>
<span class="sd">        upper (chex.ArrayTree): Upper bound of the parameters</span>
<span class="sd">        func (typing.Callable[[jnp.ndarray], tuple[jnp.ndarray, typing.Any]]): Loss function</span>
<span class="sd">        optimizer (optax.GradientTransformation): Instance of optax optimizer</span>
<span class="sd">        maxiter (int, optional): Number of optimization step. Defaults to 1000.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[chex.ArrayTree, list[typing.Any]]: Tuple of parameters and optimization history</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">step_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">grads</span><span class="p">,</span> <span class="n">aux</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">has_aux</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">params</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">updates</span><span class="p">,</span> <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">apply_updates</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">updates</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">lower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">upper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Apply projection</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">projections</span><span class="o">.</span><span class="n">projection_box</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>

        <span class="c1"># Log the history</span>
        <span class="n">aux</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
        <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aux</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
            <span class="n">callback</span><span class="p">(</span><span class="n">step_idx</span><span class="p">,</span> <span class="n">aux</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">params</span><span class="p">,</span> <span class="n">history</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="physics">Physics</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.physics" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.physics</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.normalizer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">normalizer</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">normalizer</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Normalize the given matrix with QR decomposition and return matrix Q
   which is unitary</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>matrix</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrix to normalize to unitary matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The unitary matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">normalizer</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalize the given matrix with QR decomposition and return matrix Q</span>
<span class="sd">       which is unitary</span>

<span class="sd">    Args:</span>
<span class="sd">        matrix (jnp.ndarray): The matrix to normalize to unitary matrix</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The unitary matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">Q</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.solver" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">solver</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">solver</span><span class="p">(</span>
    <span class="n">args</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span>
    <span class="n">t_eval</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
    <span class="p">],</span>
    <span class="n">y0</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">t0</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">t1</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">rtol</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1e-07</span><span class="p">,</span>
    <span class="n">atol</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1e-07</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="int">int</span></span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Solve the Schrodinger equation using the given Hamiltonian</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The arguments for the Hamiltonian</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_eval</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time points to evaluate the solution</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hamiltonian</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Hamiltonian function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y0</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial state, set to jnp.eye(2, dtype=jnp.complex128) for unitary matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial time</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final time</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rtol</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to 1e-7.</p>
              </div>
            </td>
            <td>
                  <code>1e-07</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>atol</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to 1e-7.</p>
              </div>
            </td>
            <td>
                  <code>1e-07</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maxmimum step of evalution of solver. Defaults to int(2**16).</p>
              </div>
            </td>
            <td>
                  <code><span title="int">int</span>(2 ** 16)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The solution of the Schrodinger equation at the given time points</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solver</span><span class="p">(</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">HamiltonianArgs</span><span class="p">,</span>
    <span class="n">t_eval</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">y0</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">t0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">,</span>
    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Solve the Schrodinger equation using the given Hamiltonian</span>

<span class="sd">    Args:</span>
<span class="sd">        args (HamiltonianArgs): The arguments for the Hamiltonian</span>
<span class="sd">        t_eval (jnp.ndarray): The time points to evaluate the solution</span>
<span class="sd">        hamiltonian (typing.Callable[[HamiltonianArgs, jnp.ndarray], jnp.ndarray]): The Hamiltonian function</span>
<span class="sd">        y0 (jnp.ndarray): The initial state, set to jnp.eye(2, dtype=jnp.complex128) for unitary matrix</span>
<span class="sd">        t0 (float): The initial time</span>
<span class="sd">        t1 (float): The final time</span>
<span class="sd">        rtol (float, optional): _description_. Defaults to 1e-7.</span>
<span class="sd">        atol (float, optional): _description_. Defaults to 1e-7.</span>
<span class="sd">        max_steps (int, optional): The maxmimum step of evalution of solver. Defaults to int(2**16).</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The solution of the Schrodinger equation at the given time points</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># * Increase time_step to increase accuracy of solver,</span>
    <span class="c1"># *     then you have to increase the max_steps too.</span>
    <span class="c1"># * Using just a basic solver</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rhs</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">HamiltonianArgs</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">hamiltonian</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">@</span> <span class="n">y</span>

    <span class="n">term</span> <span class="o">=</span> <span class="n">diffrax</span><span class="o">.</span><span class="n">ODETerm</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">diffrax</span><span class="o">.</span><span class="n">Tsit5</span><span class="p">()</span>

    <span class="n">solution</span> <span class="o">=</span> <span class="n">diffrax</span><span class="o">.</span><span class="n">diffeqsolve</span><span class="p">(</span>
        <span class="n">term</span><span class="p">,</span>
        <span class="n">solver</span><span class="p">,</span>
        <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span>
        <span class="n">t1</span><span class="o">=</span><span class="n">t1</span><span class="p">,</span>
        <span class="n">dt0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stepsize_controller</span><span class="o">=</span><span class="n">diffrax</span><span class="o">.</span><span class="n">PIDController</span><span class="p">(</span>
            <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span>
            <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
        <span class="n">saveat</span><span class="o">=</span><span class="n">diffrax</span><span class="o">.</span><span class="n">SaveAt</span><span class="p">(</span><span class="n">ts</span><span class="o">=</span><span class="n">t_eval</span><span class="p">),</span>
        <span class="n">max_steps</span><span class="o">=</span><span class="n">max_steps</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Normailized the solution</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">ys</span>
    <span class="c1"># assert isinstance(ys, jnp.ndarray)</span>

    <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">normalizer</span><span class="p">)(</span><span class="n">ys</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.auto_rotating_frame_hamiltonian" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">auto_rotating_frame_hamiltonian</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">auto_rotating_frame_hamiltonian</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
    <span class="p">],</span>
    <span class="n">frame</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">explicit_deriv</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Implement the Hamiltonian in the rotating frame with
H_I = U(t) @ H @ U^dagger(t) + i * U(t) @ dU^dagger(t)/dt</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hamiltonian</code>
            </td>
            <td>
                  <code><span title="Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The hamiltonian function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frame</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frame matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">auto_rotating_frame_hamiltonian</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">frame</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">explicit_deriv</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement the Hamiltonian in the rotating frame with</span>
<span class="sd">    H_I = U(t) @ H @ U^dagger(t) + i * U(t) @ dU^dagger(t)/dt</span>

<span class="sd">    Args:</span>
<span class="sd">        hamiltonian (Callable): The hamiltonian function</span>
<span class="sd">        frame (jnp.ndarray): The frame matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">is_diagonal</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Check if the frame is diagonal matrix</span>
    <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">frame</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">frame</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">is_diagonal</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Check if the jax_enable_x64 is True</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">jax</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_diagonal</span><span class="p">:</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="c1"># NOTE: This is the same as the below, as we sure that the frame is diagonal</span>
            <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">frame</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">derivative_frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="c1"># NOTE: Assume that the frame is time independent.</span>
        <span class="k">return</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">frame</span> <span class="o">@</span> <span class="n">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rotating_frame_hamiltonian_v0</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">@</span> <span class="n">hamiltonian</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">@</span> <span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
        <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">derivative_frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">@</span> <span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rotating_frame_hamiltonian</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="c1"># NOTE: Assume that the product of derivative and conjugate of frame unitary is identity</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="o">@</span> <span class="n">hamiltonian</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
            <span class="o">@</span> <span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
            <span class="o">-</span> <span class="n">frame</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">rotating_frame_hamiltonian_v0</span> <span class="k">if</span> <span class="n">explicit_deriv</span> <span class="k">else</span> <span class="n">rotating_frame_hamiltonian</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.explicit_auto_rotating_frame_hamiltonian" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">explicit_auto_rotating_frame_hamiltonian</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">explicit_auto_rotating_frame_hamiltonian</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
    <span class="p">],</span>
    <span class="n">frame</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Implement the Hamiltonian in the rotating frame with
H_I = U(t) @ H @ U^dagger(t) + i * U(t) @ dU^dagger(t)/dt</p>


<details class="note" open>
  <summary>Note</summary>
  <p>This is the implementation of <code>auto_rotating_frame_hamiltonian</code>
that perform explicit derivative.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hamiltonian</code>
            </td>
            <td>
                  <code><span title="Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The hamiltonian function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frame</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frame matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">explicit_auto_rotating_frame_hamiltonian</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">frame</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implement the Hamiltonian in the rotating frame with</span>
<span class="sd">    H_I = U(t) @ H @ U^dagger(t) + i * U(t) @ dU^dagger(t)/dt</span>

<span class="sd">    Note:</span>
<span class="sd">        This is the implementation of `auto_rotating_frame_hamiltonian`</span>
<span class="sd">        that perform explicit derivative.</span>

<span class="sd">    Args:</span>
<span class="sd">        hamiltonian (Callable): The hamiltonian function</span>
<span class="sd">        frame (jnp.ndarray): The frame matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">frame</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">derivative_frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="c1"># NOTE: Assume that the frame is time independent.</span>
        <span class="k">return</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">frame</span> <span class="o">@</span> <span class="n">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rotating_frame_hamiltonian_v0</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">@</span> <span class="n">hamiltonian</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">@</span> <span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
        <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">derivative_frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">@</span> <span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">frame_unitary</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">rotating_frame_hamiltonian_v0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.a" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">a</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">a</span><span class="p">(</span><span class="n">dims</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Annihilation operator of given dims</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dims</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of states</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Annihilation operator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="n">dims</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Annihilation operator of given dims</span>

<span class="sd">    Args:</span>
<span class="sd">        dims (int): Number of states</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Annihilation operator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.a_dag" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">a_dag</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">a_dag</span><span class="p">(</span><span class="n">dims</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Creation operator of given dims</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dims</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of states</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Creation operator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">a_dag</span><span class="p">(</span><span class="n">dims</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creation operator of given dims</span>

<span class="sd">    Args:</span>
<span class="sd">        dims (int): Number of states</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Creation operator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.N" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">N</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">N</span><span class="p">(</span><span class="n">dims</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Number operator of given dims</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dims</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of states</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Number operator</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">N</span><span class="p">(</span><span class="n">dims</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Number operator of given dims</span>

<span class="sd">    Args:</span>
<span class="sd">        dims (int): Number of states</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Number operator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dims</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.gen_hamiltonian_from" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">gen_hamiltonian_from</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">gen_hamiltonian_from</span><span class="p">(</span>
    <span class="n">qubit_informations</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></span><span class="p">],</span>
    <span class="n">coupling_constants</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.physics.CouplingInformation">CouplingInformation</span></span><span class="p">],</span>
    <span class="n">dims</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianTerm">HamiltonianTerm</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate dict of Hamiltonian from given qubits and coupling information.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qubit_informations</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qubit information</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coupling_constants</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="src.inspeqtor.v1.physics.CouplingInformation">CouplingInformation</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coupling information</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dims</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The level of the quantum system. Defaults to 2, i.e. qubit system.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="src.inspeqtor.v1.physics.HamiltonianTerm">HamiltonianTerm</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, HamiltonianTerm]: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gen_hamiltonian_from</span><span class="p">(</span>
    <span class="n">qubit_informations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">QubitInformation</span><span class="p">],</span>
    <span class="n">coupling_constants</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CouplingInformation</span><span class="p">],</span>
    <span class="n">dims</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">HamiltonianTerm</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate dict of Hamiltonian from given qubits and coupling information.</span>

<span class="sd">    Args:</span>
<span class="sd">        qubit_informations (list[QubitInformation]): Qubit information</span>
<span class="sd">        coupling_constants (list[CouplingInformation]): Coupling information</span>
<span class="sd">        dims (int, optional): The level of the quantum system. Defaults to 2, i.e. qubit system.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, HamiltonianTerm]: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_qubits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qubit_informations</span><span class="p">)</span>

    <span class="n">operators</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">HamiltonianTerm</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">qubit_informations</span><span class="p">):</span>
        <span class="c1"># The static Hamiltonian terms</span>
        <span class="n">static_i</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">qubit</span><span class="o">.</span><span class="n">frequency</span> <span class="o">*</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">N</span><span class="p">(</span><span class="n">dims</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="n">operators</span><span class="p">[</span><span class="n">ChannelID</span><span class="p">(</span><span class="n">qubit_idx</span><span class="o">=</span><span class="n">qubit</span><span class="o">.</span><span class="n">qubit_idx</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">TermType</span><span class="o">.</span><span class="n">STATIC</span><span class="p">)</span><span class="o">.</span><span class="n">hash</span><span class="p">()]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">HamiltonianTerm</span><span class="p">(</span>
                <span class="n">qubit_idx</span><span class="o">=</span><span class="n">qubit</span><span class="o">.</span><span class="n">qubit_idx</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">TermType</span><span class="o">.</span><span class="n">STATIC</span><span class="p">,</span>
                <span class="n">controlable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">operator</span><span class="o">=</span><span class="n">tensor</span><span class="p">(</span><span class="n">static_i</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">num_qubits</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># The anharmonicity term</span>
        <span class="n">anhar_i</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">qubit</span><span class="o">.</span><span class="n">anharmonicity</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span> <span class="o">@</span> <span class="n">N</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span> <span class="o">-</span> <span class="n">N</span><span class="p">(</span><span class="n">dims</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="n">operators</span><span class="p">[</span>
            <span class="n">ChannelID</span><span class="p">(</span><span class="n">qubit_idx</span><span class="o">=</span><span class="n">qubit</span><span class="o">.</span><span class="n">qubit_idx</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">TermType</span><span class="o">.</span><span class="n">ANHAMONIC</span><span class="p">)</span><span class="o">.</span><span class="n">hash</span><span class="p">()</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">HamiltonianTerm</span><span class="p">(</span>
            <span class="n">qubit_idx</span><span class="o">=</span><span class="n">qubit</span><span class="o">.</span><span class="n">qubit_idx</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">TermType</span><span class="o">.</span><span class="n">ANHAMONIC</span><span class="p">,</span>
            <span class="n">controlable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">operator</span><span class="o">=</span><span class="n">tensor</span><span class="p">(</span><span class="n">anhar_i</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">num_qubits</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># The drive terms</span>
        <span class="n">drive_i</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">qubit</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_dag</span><span class="p">(</span><span class="n">dims</span><span class="p">))</span>

        <span class="n">operators</span><span class="p">[</span><span class="n">ChannelID</span><span class="p">(</span><span class="n">qubit_idx</span><span class="o">=</span><span class="n">qubit</span><span class="o">.</span><span class="n">qubit_idx</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">TermType</span><span class="o">.</span><span class="n">DRIVE</span><span class="p">)</span><span class="o">.</span><span class="n">hash</span><span class="p">()]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">HamiltonianTerm</span><span class="p">(</span>
                <span class="n">qubit_idx</span><span class="o">=</span><span class="n">qubit</span><span class="o">.</span><span class="n">qubit_idx</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">TermType</span><span class="o">.</span><span class="n">DRIVE</span><span class="p">,</span>
                <span class="n">controlable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">operator</span><span class="o">=</span><span class="n">tensor</span><span class="p">(</span><span class="n">drive_i</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">num_qubits</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># The control terms that drive with another qubit frequency</span>
        <span class="n">control_i</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">qubit</span><span class="o">.</span><span class="n">drive_strength</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_dag</span><span class="p">(</span><span class="n">dims</span><span class="p">))</span>

        <span class="n">operators</span><span class="p">[</span>
            <span class="n">ChannelID</span><span class="p">(</span><span class="n">qubit_idx</span><span class="o">=</span><span class="n">qubit</span><span class="o">.</span><span class="n">qubit_idx</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">TermType</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">)</span><span class="o">.</span><span class="n">hash</span><span class="p">()</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">HamiltonianTerm</span><span class="p">(</span>
            <span class="n">qubit_idx</span><span class="o">=</span><span class="n">qubit</span><span class="o">.</span><span class="n">qubit_idx</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">TermType</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">,</span>
            <span class="n">controlable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">operator</span><span class="o">=</span><span class="n">tensor</span><span class="p">(</span><span class="n">control_i</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">num_qubits</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">coupling</span> <span class="ow">in</span> <span class="n">coupling_constants</span><span class="p">:</span>
        <span class="c1"># Add the coupling constant to the Hamiltonian</span>
        <span class="n">c_1</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">dims</span><span class="p">),</span> <span class="n">coupling</span><span class="o">.</span><span class="n">qubit_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_qubits</span><span class="p">)</span> <span class="o">@</span> <span class="n">tensor</span><span class="p">(</span>
            <span class="n">a_dag</span><span class="p">(</span><span class="n">dims</span><span class="p">),</span> <span class="n">coupling</span><span class="o">.</span><span class="n">qubit_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_qubits</span>
        <span class="p">)</span>
        <span class="n">c_2</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">a_dag</span><span class="p">(</span><span class="n">dims</span><span class="p">),</span> <span class="n">coupling</span><span class="o">.</span><span class="n">qubit_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_qubits</span><span class="p">)</span> <span class="o">@</span> <span class="n">tensor</span><span class="p">(</span>
            <span class="n">a</span><span class="p">(</span><span class="n">dims</span><span class="p">),</span> <span class="n">coupling</span><span class="o">.</span><span class="n">qubit_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_qubits</span>
        <span class="p">)</span>
        <span class="n">coupling_ij</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">coupling</span><span class="o">.</span><span class="n">coupling_strength</span> <span class="o">*</span> <span class="p">(</span><span class="n">c_1</span> <span class="o">+</span> <span class="n">c_2</span><span class="p">)</span>

        <span class="n">operators</span><span class="p">[</span>
            <span class="n">ChannelID</span><span class="p">(</span>
                <span class="n">qubit_idx</span><span class="o">=</span><span class="p">(</span><span class="n">coupling</span><span class="o">.</span><span class="n">qubit_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coupling</span><span class="o">.</span><span class="n">qubit_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">TermType</span><span class="o">.</span><span class="n">COUPLING</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">hash</span><span class="p">()</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">HamiltonianTerm</span><span class="p">(</span>
            <span class="n">qubit_idx</span><span class="o">=</span><span class="p">(</span><span class="n">coupling</span><span class="o">.</span><span class="n">qubit_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coupling</span><span class="o">.</span><span class="n">qubit_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">TermType</span><span class="o">.</span><span class="n">COUPLING</span><span class="p">,</span>
            <span class="n">controlable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">operator</span><span class="o">=</span><span class="n">coupling_ij</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">operators</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.hamiltonian_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">hamiltonian_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">hamiltonian_fn</span><span class="p">(</span>
    <span class="n">args</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="src.inspeqtor.v1.physics.SignalParameters">SignalParameters</span></span><span class="p">],</span>
    <span class="n">t</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">signals</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span>
        <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="src.inspeqtor.v1.physics.SignalParameters">SignalParameters</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]</span>
    <span class="p">],</span>
    <span class="n">hamiltonian_terms</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianTerm">HamiltonianTerm</span></span><span class="p">],</span>
    <span class="n">static_terms</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Hamiltonian function to be used whitebox.
Expect to be used in partial form, i.e. making <code>signals</code>, <code>hamiltonian_terms</code>, and <code>static_terms</code> static arguments.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="src.inspeqtor.v1.physics.SignalParameters">SignalParameters</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control parameter</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time to evaluate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>signals</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Callable">Callable</span>[[<span title="src.inspeqtor.v1.physics.SignalParameters">SignalParameters</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Signal function of the control</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hamiltonian_terms</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="src.inspeqtor.v1.physics.HamiltonianTerm">HamiltonianTerm</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of Hamiltonian terms, where key is channel</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>static_terms</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of channel id specifing the static term.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hamiltonian_fn</span><span class="p">(</span>
    <span class="n">args</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SignalParameters</span><span class="p">],</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">signals</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">SignalParameters</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]],</span>
    <span class="n">hamiltonian_terms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">HamiltonianTerm</span><span class="p">],</span>
    <span class="n">static_terms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hamiltonian function to be used whitebox.</span>
<span class="sd">    Expect to be used in partial form, i.e. making `signals`, `hamiltonian_terms`, and `static_terms` static arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (dict[str, SignalParameters]): Control parameter</span>
<span class="sd">        t (jnp.ndarray): Time to evaluate</span>
<span class="sd">        signals (dict[str, typing.Callable[[SignalParameters, jnp.ndarray], jnp.ndarray]]): Signal function of the control</span>
<span class="sd">        hamiltonian_terms (dict[str, HamiltonianTerm]): Dict of Hamiltonian terms, where key is channel</span>
<span class="sd">        static_terms (list[str]): list of channel id specifing the static term.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Match the args with signal</span>
    <span class="n">drives</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">signal</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">channel_id</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">hamiltonian_terms</span><span class="p">[</span><span class="n">channel_id</span><span class="p">]</span><span class="o">.</span><span class="n">operator</span>
            <span class="k">for</span> <span class="n">channel_id</span><span class="p">,</span> <span class="n">signal</span> <span class="ow">in</span> <span class="n">signals</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">statics</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="n">hamiltonian_terms</span><span class="p">[</span><span class="n">static_term</span><span class="p">]</span><span class="o">.</span><span class="n">operator</span> <span class="k">for</span> <span class="n">static_term</span> <span class="ow">in</span> <span class="n">static_terms</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">drives</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">statics</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.signal_func_v3" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">signal_func_v3</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">signal_func_v3</span><span class="p">(</span>
    <span class="n">get_envelope</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">drive_frequency</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make the envelope function into signal with drive frequency</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>get_envelope</code>
            </td>
            <td>
                  <code><span title="Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The envelope function in unit of dt</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drive_frequency</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>drive freuqency in unit of GHz</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dt provived will be used to convert envelope unit to ns,
        set to 1 if the envelope function is already in unit of ns</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">signal_func_v3</span><span class="p">(</span><span class="n">get_envelope</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span> <span class="n">drive_frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make the envelope function into signal with drive frequency</span>

<span class="sd">    Args:</span>
<span class="sd">        get_envelope (Callable): The envelope function in unit of dt</span>
<span class="sd">        drive_frequency (float): drive freuqency in unit of GHz</span>
<span class="sd">        dt (float): The dt provived will be used to convert envelope unit to ns,</span>
<span class="sd">                    set to 1 if the envelope function is already in unit of ns</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">signal</span><span class="p">(</span><span class="n">pulse_parameters</span><span class="p">:</span> <span class="n">SignalParameters</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
            <span class="n">get_envelope</span><span class="p">(</span><span class="n">pulse_parameters</span><span class="o">.</span><span class="n">pulse_params</span><span class="p">)(</span><span class="n">t</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">drive_frequency</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">pulse_parameters</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">signal</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.signal_func_v4" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">signal_func_v4</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">signal_func_v4</span><span class="p">(</span>
    <span class="n">get_envelope</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">drive_frequency</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make the envelope function into signal with drive frequency</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>get_envelope</code>
            </td>
            <td>
                  <code><span title="Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The envelope function in unit of dt</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drive_frequency</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>drive freuqency in unit of GHz</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dt provived will be used to convert envelope unit to ns,
        set to 1 if the envelope function is already in unit of ns</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">signal_func_v4</span><span class="p">(</span><span class="n">get_envelope</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span> <span class="n">drive_frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make the envelope function into signal with drive frequency</span>

<span class="sd">    Args:</span>
<span class="sd">        get_envelope (Callable): The envelope function in unit of dt</span>
<span class="sd">        drive_frequency (float): drive freuqency in unit of GHz</span>
<span class="sd">        dt (float): The dt provived will be used to convert envelope unit to ns,</span>
<span class="sd">                    set to 1 if the envelope function is already in unit of ns</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">signal</span><span class="p">(</span><span class="n">control_param</span><span class="p">:</span> <span class="n">SignalParametersV2</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
            <span class="n">get_envelope</span><span class="p">(</span><span class="n">control_param</span><span class="o">.</span><span class="n">pulse_params</span><span class="p">)(</span><span class="n">t</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">drive_frequency</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">control_param</span><span class="o">.</span><span class="n">phase</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">signal</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.make_signal_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_signal_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_signal_fn</span><span class="p">(</span>
    <span class="n">get_envelope</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.physics.ControlParam">ControlParam</span></span><span class="p">],</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]</span>
    <span class="p">],</span>
    <span class="n">drive_frequency</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make the envelope function into signal with drive frequency</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>get_envelope</code>
            </td>
            <td>
                  <code><span title="Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The envelope function in unit of dt</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drive_frequency</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>drive freuqency in unit of GHz</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dt provived will be used to convert envelope unit to ns,
        set to 1 if the envelope function is already in unit of ns</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_signal_fn</span><span class="p">(</span>
    <span class="n">get_envelope</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span>
        <span class="p">[</span><span class="n">ControlParam</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="n">drive_frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make the envelope function into signal with drive frequency</span>

<span class="sd">    Args:</span>
<span class="sd">        get_envelope (Callable): The envelope function in unit of dt</span>
<span class="sd">        drive_frequency (float): drive freuqency in unit of GHz</span>
<span class="sd">        dt (float): The dt provived will be used to convert envelope unit to ns,</span>
<span class="sd">                    set to 1 if the envelope function is already in unit of ns</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">signal</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">:</span> <span class="n">ControlParam</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
            <span class="n">get_envelope</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">)(</span><span class="n">t</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">drive_frequency</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">signal</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.gate_fidelity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">gate_fidelity</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">gate_fidelity</span><span class="p">(</span><span class="n">U</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">V</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the gate fidelity between U and V</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>U</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unitary operator to be targetted</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>V</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unitary operator to be compared</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Gate fidelity</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gate_fidelity</span><span class="p">(</span><span class="n">U</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">V</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the gate fidelity between U and V</span>

<span class="sd">    Args:</span>
<span class="sd">        U (jnp.ndarray): Unitary operator to be targetted</span>
<span class="sd">        V (jnp.ndarray): Unitary operator to be compared</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Gate fidelity</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">up</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">V</span><span class="p">)</span>
    <span class="n">down</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">U</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">V</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">up</span> <span class="o">/</span> <span class="n">down</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.check_valid_density_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">check_valid_density_matrix</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_valid_density_matrix</span><span class="p">(</span><span class="n">rho</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if the provided matrix is valid density matrix</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rho</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_valid_density_matrix</span><span class="p">(</span><span class="n">rho</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the provided matrix is valid density matrix</span>

<span class="sd">    Args:</span>
<span class="sd">        rho (jnp.ndarray): _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the density matrix is valid</span>
    <span class="k">assert</span> <span class="n">jnp</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;Density matrix is not trace 1&quot;</span>
    <span class="k">assert</span> <span class="n">jnp</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">rho</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="s2">&quot;Density matrix is not Hermitian&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.check_hermitian" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">check_hermitian</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_hermitian</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if the provided matrix is Hermitian</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>op</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix to be assert</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_hermitian</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the provided matrix is Hermitian</span>

<span class="sd">    Args:</span>
<span class="sd">        op (jnp.ndarray): Matrix to be assert</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">jnp</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="s2">&quot;Matrix is not Hermitian&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.direct_AFG_estimation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">direct_AFG_estimation</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">direct_AFG_estimation</span><span class="p">(</span>
    <span class="n">coefficients</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">expectation_values</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate single qubit average gate fidelity from expectation value
This function should be used with <code>direct_AFG_estimation_coefficients</code></p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">direct_AFG_estimation_coefficients</span><span class="p">(</span><span class="n">unitary</span><span class="p">)</span>
<span class="gp">... </span><span class="n">agf</span> <span class="o">=</span> <span class="n">direct_AFG_estimation</span><span class="p">(</span><span class="n">coefficients</span><span class="p">,</span> <span class="n">expectation_value</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coefficients</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The coefficients return from <code>direct_AFG_estimation_coefficients</code></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expectation_values</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The expectation values assume to be shape of (..., 18) with order of <code>sq.constant.default_expectation_values_order</code></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Average Gate Fidelity</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">direct_AFG_estimation</span><span class="p">(</span>
    <span class="n">coefficients</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">expectation_values</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate single qubit average gate fidelity from expectation value</span>
<span class="sd">    This function should be used with `direct_AFG_estimation_coefficients`</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; coefficients = direct_AFG_estimation_coefficients(unitary)</span>
<span class="sd">        ... agf = direct_AFG_estimation(coefficients, expectation_value)</span>

<span class="sd">    Args:</span>
<span class="sd">        coefficients (jnp.ndarray): The coefficients return from `direct_AFG_estimation_coefficients`</span>
<span class="sd">        expectation_values (jnp.ndarray): The expectation values assume to be shape of (..., 18) with order of `sq.constant.default_expectation_values_order`</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Average Gate Fidelity</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coefficients</span><span class="p">,</span> <span class="n">expectation_values</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.direct_AFG_estimation_coefficients" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">direct_AFG_estimation_coefficients</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">direct_AFG_estimation_coefficients</span><span class="p">(</span>
    <span class="n">target_unitary</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the expected coefficients to be used for AGF calculation using <code>direct_AFG_estimation</code>.
The order of coefficients is the same as <code>sq.constant.default_expectation_values_order</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target_unitary</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target unitary to be computed for coefficient</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Coefficients for AGF calculation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">direct_AFG_estimation_coefficients</span><span class="p">(</span><span class="n">target_unitary</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the expected coefficients to be used for AGF calculation using `direct_AFG_estimation`.</span>
<span class="sd">    The order of coefficients is the same as `sq.constant.default_expectation_values_order`</span>

<span class="sd">    Args:</span>
<span class="sd">        target_unitary (jnp.ndarray): Target unitary to be computed for coefficient</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Coefficients for AGF calculation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coefficients</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pauli_i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">pauli_j</span> <span class="ow">in</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">]:</span>
            <span class="n">pauli_coeff</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span>
                <span class="n">pauli_i</span> <span class="o">@</span> <span class="n">target_unitary</span> <span class="o">@</span> <span class="n">pauli_j</span> <span class="o">@</span> <span class="n">target_unitary</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">state_coeff</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">coeff</span> <span class="o">=</span> <span class="n">state_coeff</span> <span class="o">*</span> <span class="n">pauli_coeff</span>
                <span class="n">coefficients</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coefficients</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.calculate_exp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_exp</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_exp</span><span class="p">(</span>
    <span class="n">unitary</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">operator</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">density_matrix</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the expectation value for given unitary, observable (operator), initial state (density_matrix).
Shape of all arguments must be boardcastable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>unitary</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unitary operator</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operator</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Quantum Observable</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>density_matrix</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Intial state in form of density matrix.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Expectation value of quantum observable.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_exp</span><span class="p">(</span>
    <span class="n">unitary</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">operator</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">density_matrix</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the expectation value for given unitary, observable (operator), initial state (density_matrix).</span>
<span class="sd">    Shape of all arguments must be boardcastable.</span>

<span class="sd">    Args:</span>
<span class="sd">        unitary (jnp.ndarray): Unitary operator</span>
<span class="sd">        operator (jnp.ndarray): Quantum Observable</span>
<span class="sd">        density_matrix (jnp.ndarray): Intial state in form of density matrix.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Expectation value of quantum observable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
        <span class="n">unitary</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">density_matrix</span><span class="p">,</span> <span class="n">unitary</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">operator</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">axis1</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis2</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.unitaries_prod" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">unitaries_prod</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">unitaries_prod</span><span class="p">(</span>
    <span class="n">prev_unitary</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">curr_unitary</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Function to be used for trotterization Whitebox</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>prev_unitary</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Product of cummulate Unitary operator.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>curr_unitary</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The next Unitary operator to be multiply.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[jnp.ndarray, jnp.ndarray]: Product of previous unitart and current unitary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unitaries_prod</span><span class="p">(</span>
    <span class="n">prev_unitary</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">curr_unitary</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to be used for trotterization Whitebox</span>

<span class="sd">    Args:</span>
<span class="sd">        prev_unitary (jnp.ndarray): Product of cummulate Unitary operator.</span>
<span class="sd">        curr_unitary (jnp.ndarray): The next Unitary operator to be multiply.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[jnp.ndarray, jnp.ndarray]: Product of previous unitart and current unitary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prod_unitary</span> <span class="o">=</span> <span class="n">prev_unitary</span> <span class="o">@</span> <span class="n">curr_unitary</span>
    <span class="k">return</span> <span class="n">prod_unitary</span><span class="p">,</span> <span class="n">prod_unitary</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.make_trotterization_solver" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_trotterization_solver</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_trotterization_solver</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
    <span class="n">total_dt</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">trotter_steps</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">y0</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retutn whitebox function compute using Trotterization strategy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hamiltonian</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Hamiltonian function of the system</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total_dt</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total duration of control sequence</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The duration of time step in nanosecond.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trotter_steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of trotterization step.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y0</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial unitary state. Defaults to jnp.eye(2, dtype=jnp.complex128)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable[..., jnp.ndarray]: Trotterization Whitebox function</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_trotterization_solver</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">total_dt</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">trotter_steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">y0</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retutn whitebox function compute using Trotterization strategy.</span>

<span class="sd">    Args:</span>
<span class="sd">        hamiltonian (typing.Callable[..., jnp.ndarray]): The Hamiltonian function of the system</span>
<span class="sd">        total_dt (int): The total duration of control sequence</span>
<span class="sd">        dt (float, optional): The duration of time step in nanosecond.</span>
<span class="sd">        trotter_steps (int, optional): The number of trotterization step.</span>
<span class="sd">        y0 (jnp.ndarray): The initial unitary state. Defaults to jnp.eye(2, dtype=jnp.complex128)</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable[..., jnp.ndarray]: Trotterization Whitebox function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">)</span>
    <span class="n">time_step</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_dt</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">whitebox</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">hamiltonians</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">))(</span>
            <span class="n">control_parameters</span><span class="p">,</span> <span class="n">time_step</span>
        <span class="p">)</span>
        <span class="n">unitaries</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">time_step</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time_step</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">hamiltonians</span>
        <span class="p">)</span>
        <span class="c1"># * Nice explanation of scan</span>
        <span class="c1"># * https://www.nelsontang.com/blog/a-friendly-introduction-to-scan-with-jax</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">unitaries</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">unitaries_prod</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unitaries</span>

    <span class="k">return</span> <span class="n">whitebox</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.physics.lindblad_solver" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">lindblad_solver</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lindblad_solver</span><span class="p">(</span>
    <span class="n">args</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span>
    <span class="n">t_eval</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[</span><span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
    <span class="p">],</span>
    <span class="n">lindblad_ops</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
    <span class="n">rho0</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">t0</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">t1</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">rtol</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1e-07</span><span class="p">,</span>
    <span class="n">atol</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1e-07</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="int">int</span></span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Solve the Lindblad Master equation without flattening matrices</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/physics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lindblad_solver</span><span class="p">(</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">HamiltonianArgs</span><span class="p">,</span>
    <span class="n">t_eval</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">lindblad_ops</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">rho0</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">t0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">t1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">rtol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">,</span>
    <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Solve the Lindblad Master equation without flattening matrices&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">commutator</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">A</span> <span class="o">@</span> <span class="n">B</span> <span class="o">-</span> <span class="n">B</span> <span class="o">@</span> <span class="n">A</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">anti_commutator</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">A</span> <span class="o">@</span> <span class="n">B</span> <span class="o">+</span> <span class="n">B</span> <span class="o">@</span> <span class="n">A</span>

    <span class="c1"># Direct matrix RHS function - no reshaping needed</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lindblad_rhs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">HamiltonianArgs</span><span class="p">):</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">hamiltonian</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

        <span class="c1"># Coherent evolution term: -i[H, ρ]</span>
        <span class="n">coherent_term</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">commutator</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span>

        <span class="c1"># Dissipative terms from all Lindblad operators</span>
        <span class="n">dissipative_term</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">lindblad_ops</span><span class="p">:</span>
            <span class="n">L_dag</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="n">term1</span> <span class="o">=</span> <span class="n">L</span> <span class="o">@</span> <span class="n">rho</span> <span class="o">@</span> <span class="n">L_dag</span>
            <span class="n">term2</span> <span class="o">=</span> <span class="n">anti_commutator</span><span class="p">(</span><span class="n">L_dag</span> <span class="o">@</span> <span class="n">L</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span>
            <span class="n">dissipative_term</span> <span class="o">=</span> <span class="n">dissipative_term</span> <span class="o">+</span> <span class="p">(</span><span class="n">term1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">term2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">coherent_term</span> <span class="o">+</span> <span class="n">dissipative_term</span>

    <span class="n">term</span> <span class="o">=</span> <span class="n">diffrax</span><span class="o">.</span><span class="n">ODETerm</span><span class="p">(</span><span class="n">lindblad_rhs</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">diffrax</span><span class="o">.</span><span class="n">Tsit5</span><span class="p">()</span>
    <span class="c1"># solver = diffrax.Dopri5()</span>

    <span class="n">solution</span> <span class="o">=</span> <span class="n">diffrax</span><span class="o">.</span><span class="n">diffeqsolve</span><span class="p">(</span>
        <span class="n">term</span><span class="p">,</span>
        <span class="n">solver</span><span class="p">,</span>
        <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span>
        <span class="n">t1</span><span class="o">=</span><span class="n">t1</span><span class="p">,</span>
        <span class="n">dt0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stepsize_controller</span><span class="o">=</span><span class="n">diffrax</span><span class="o">.</span><span class="n">PIDController</span><span class="p">(</span>
            <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span>
            <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">y0</span><span class="o">=</span><span class="n">rho0</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
        <span class="n">saveat</span><span class="o">=</span><span class="n">diffrax</span><span class="o">.</span><span class="n">SaveAt</span><span class="p">(</span><span class="n">ts</span><span class="o">=</span><span class="n">t_eval</span><span class="p">),</span>
        <span class="n">max_steps</span><span class="o">=</span><span class="n">max_steps</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Process the matrices to ensure hermiticity and unit trace</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_density_matrix</span><span class="p">(</span><span class="n">rho</span><span class="p">):</span>
        <span class="c1"># Ensure Hermiticity</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
        <span class="c1"># Normalize to trace = 1</span>
        <span class="k">return</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>

    <span class="c1"># Process all matrices</span>
    <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">process_density_matrix</span><span class="p">)(</span><span class="n">solution</span><span class="o">.</span><span class="n">ys</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="predefined">Predefined</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.predefined" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.predefined</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.predefined.HamiltonianSpec" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">HamiltonianSpec</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">










              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HamiltonianSpec</span><span class="p">:</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">WhiteboxStrategy</span>
    <span class="n">hamiltonian_enum</span><span class="p">:</span> <span class="n">HamiltonianEnum</span> <span class="o">=</span> <span class="n">HamiltonianEnum</span><span class="o">.</span><span class="n">rotating_transmon_hamiltonian</span>
    <span class="c1"># For Trotterization</span>
    <span class="n">trotter_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="c1"># For ODE sovler</span>
    <span class="n">max_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_hamiltonian_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hamiltonian_enum</span> <span class="o">==</span> <span class="n">HamiltonianEnum</span><span class="o">.</span><span class="n">rotating_transmon_hamiltonian</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">rotating_transmon_hamiltonian</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">hamiltonian_enum</span> <span class="o">==</span> <span class="n">HamiltonianEnum</span><span class="o">.</span><span class="n">transmon_hamiltonian</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">transmon_hamiltonian</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupport Hamiltonian: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hamiltonian_enum</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_solver</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">control_sequence</span><span class="p">:</span> <span class="n">ControlSequence</span><span class="p">,</span>
        <span class="n">qubit_info</span><span class="p">:</span> <span class="n">QubitInformation</span><span class="p">,</span>
        <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">get_envelope_transformer</span><span class="o">=</span><span class="n">get_envelope_transformer</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return Unitary solver from the given specification of the Hamiltonian and solver</span>

<span class="sd">        Args:</span>
<span class="sd">            control_sequence (ControlSequence): The control sequence object</span>
<span class="sd">            qubit_info (QubitInformation): The qubit information object</span>
<span class="sd">            dt (float): The time step size of the device</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Unsupport Solver method</span>

<span class="sd">        Returns:</span>
<span class="sd">            typing.Any: The unitary solver</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">WhiteboxStrategy</span><span class="o">.</span><span class="n">TROTTER</span><span class="p">:</span>
            <span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_hamiltonian_fn</span><span class="p">(),</span>
                <span class="n">qubit_info</span><span class="o">=</span><span class="n">qubit_info</span><span class="p">,</span>
                <span class="n">signal</span><span class="o">=</span><span class="n">make_signal_fn</span><span class="p">(</span>
                    <span class="n">get_envelope</span><span class="o">=</span><span class="n">get_envelope_transformer</span><span class="p">(</span>
                        <span class="n">control_sequence</span><span class="o">=</span><span class="n">control_sequence</span>
                    <span class="p">),</span>
                    <span class="n">drive_frequency</span><span class="o">=</span><span class="n">qubit_info</span><span class="o">.</span><span class="n">frequency</span><span class="p">,</span>
                    <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>

            <span class="n">whitebox</span> <span class="o">=</span> <span class="n">make_trotterization_solver</span><span class="p">(</span>
                <span class="n">hamiltonian</span><span class="o">=</span><span class="n">hamiltonian</span><span class="p">,</span>
                <span class="n">total_dt</span><span class="o">=</span><span class="n">control_sequence</span><span class="o">.</span><span class="n">total_dt</span><span class="p">,</span>
                <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                <span class="n">trotter_steps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trotter_steps</span><span class="p">,</span>
                <span class="n">y0</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">whitebox</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">WhiteboxStrategy</span><span class="o">.</span><span class="n">ODE</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">get_single_qubit_whitebox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_hamiltonian_fn</span><span class="p">(),</span>
                <span class="n">control_sequence</span><span class="p">,</span>
                <span class="n">qubit_info</span><span class="p">,</span>
                <span class="n">dt</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_steps</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupport method&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="src.inspeqtor.v1.predefined.HamiltonianSpec.get_solver" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_solver</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_solver</span><span class="p">(</span>
    <span class="n">control_sequence</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></span><span class="p">,</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">get_envelope_transformer</span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            get_envelope_transformer (src.inspeqtor.v1.control.get_envelope_transformer)" href="#src.inspeqtor.v1.control.get_envelope_transformer">get_envelope_transformer</a></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return Unitary solver from the given specification of the Hamiltonian and solver</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>control_sequence</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The control sequence object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qubit_info</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The qubit information object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time step size of the device</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unsupport Solver method</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: The unitary solver</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_solver</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">control_sequence</span><span class="p">:</span> <span class="n">ControlSequence</span><span class="p">,</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n">QubitInformation</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">get_envelope_transformer</span><span class="o">=</span><span class="n">get_envelope_transformer</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return Unitary solver from the given specification of the Hamiltonian and solver</span>

<span class="sd">    Args:</span>
<span class="sd">        control_sequence (ControlSequence): The control sequence object</span>
<span class="sd">        qubit_info (QubitInformation): The qubit information object</span>
<span class="sd">        dt (float): The time step size of the device</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Unsupport Solver method</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: The unitary solver</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">WhiteboxStrategy</span><span class="o">.</span><span class="n">TROTTER</span><span class="p">:</span>
        <span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_hamiltonian_fn</span><span class="p">(),</span>
            <span class="n">qubit_info</span><span class="o">=</span><span class="n">qubit_info</span><span class="p">,</span>
            <span class="n">signal</span><span class="o">=</span><span class="n">make_signal_fn</span><span class="p">(</span>
                <span class="n">get_envelope</span><span class="o">=</span><span class="n">get_envelope_transformer</span><span class="p">(</span>
                    <span class="n">control_sequence</span><span class="o">=</span><span class="n">control_sequence</span>
                <span class="p">),</span>
                <span class="n">drive_frequency</span><span class="o">=</span><span class="n">qubit_info</span><span class="o">.</span><span class="n">frequency</span><span class="p">,</span>
                <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="n">whitebox</span> <span class="o">=</span> <span class="n">make_trotterization_solver</span><span class="p">(</span>
            <span class="n">hamiltonian</span><span class="o">=</span><span class="n">hamiltonian</span><span class="p">,</span>
            <span class="n">total_dt</span><span class="o">=</span><span class="n">control_sequence</span><span class="o">.</span><span class="n">total_dt</span><span class="p">,</span>
            <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
            <span class="n">trotter_steps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trotter_steps</span><span class="p">,</span>
            <span class="n">y0</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">whitebox</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">WhiteboxStrategy</span><span class="o">.</span><span class="n">ODE</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_single_qubit_whitebox</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_hamiltonian_fn</span><span class="p">(),</span>
            <span class="n">control_sequence</span><span class="p">,</span>
            <span class="n">qubit_info</span><span class="p">,</span>
            <span class="n">dt</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_steps</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupport method&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.predefined.rotating_transmon_hamiltonian" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">rotating_transmon_hamiltonian</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rotating_transmon_hamiltonian</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span>
    <span class="n">t</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></span><span class="p">,</span>
    <span class="n">signal</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Rotating frame hamiltonian of the transmon model</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="HamiltonianParameters">HamiltonianParameters</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The parameter of the pulse for hamiltonian</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time to evaluate the Hamiltonian</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qubit_info</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The information of qubit</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>signal</code>
            </td>
            <td>
                  <code><span title="Callable">Callable</span>[..., <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pulse signal</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The Hamiltonian</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rotating_transmon_hamiltonian</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">HamiltonianArgs</span><span class="p">,</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n">QubitInformation</span><span class="p">,</span>
    <span class="n">signal</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotating frame hamiltonian of the transmon model</span>

<span class="sd">    Args:</span>
<span class="sd">        params (HamiltonianParameters): The parameter of the pulse for hamiltonian</span>
<span class="sd">        t (jnp.ndarray): The time to evaluate the Hamiltonian</span>
<span class="sd">        qubit_info (QubitInformation): The information of qubit</span>
<span class="sd">        signal (Callable[..., jnp.ndarray]): The pulse signal</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The Hamiltonian</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">qubit_info</span><span class="o">.</span><span class="n">frequency</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">qubit_info</span><span class="o">.</span><span class="n">drive_strength</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">f3</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">signal</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">f_sigma_x</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f3</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">f_sigma_y</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f3</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">f_sigma_x</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span> <span class="o">-</span> <span class="n">f_sigma_y</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">Y</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.predefined.transmon_hamiltonian" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">transmon_hamiltonian</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">transmon_hamiltonian</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span>
    <span class="n">t</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></span><span class="p">,</span>
    <span class="n">signal</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="src.inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Lab frame hamiltonian of the transmon model</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="HamiltonianParameters">HamiltonianParameters</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The parameter of the pulse for hamiltonian</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time to evaluate the Hamiltonian</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qubit_info</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The information of qubit</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>signal</code>
            </td>
            <td>
                  <code><span title="Callable">Callable</span>[..., <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pulse signal</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The Hamiltonian</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transmon_hamiltonian</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">HamiltonianArgs</span><span class="p">,</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n">QubitInformation</span><span class="p">,</span>
    <span class="n">signal</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lab frame hamiltonian of the transmon model</span>

<span class="sd">    Args:</span>
<span class="sd">        params (HamiltonianParameters): The parameter of the pulse for hamiltonian</span>
<span class="sd">        t (jnp.ndarray): The time to evaluate the Hamiltonian</span>
<span class="sd">        qubit_info (QubitInformation): The information of qubit</span>
<span class="sd">        signal (Callable[..., jnp.ndarray]): The pulse signal</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The Hamiltonian</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">a0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">qubit_info</span><span class="o">.</span><span class="n">frequency</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">qubit_info</span><span class="o">.</span><span class="n">drive_strength</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">a0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">a1</span> <span class="o">*</span> <span class="n">signal</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.predefined.get_gaussian_control_sequence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_gaussian_control_sequence</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_gaussian_control_sequence</span><span class="p">(</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></span><span class="p">,</span> <span class="n">max_amp</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get predefined Gaussian control sequence with single Gaussian pulse.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qubit_info</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qubit information</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_amp</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum amplitude. Defaults to 0.5.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ControlSequence</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control sequence instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_gaussian_control_sequence</span><span class="p">(</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n">QubitInformation</span><span class="p">,</span>
    <span class="n">max_amp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># NOTE: Choice of maximum amplitude is arbitrary</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get predefined Gaussian control sequence with single Gaussian pulse.</span>

<span class="sd">    Args:</span>
<span class="sd">        qubit_info (QubitInformation): Qubit information</span>
<span class="sd">        max_amp (float, optional): The maximum amplitude. Defaults to 0.5.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ControlSequence: Control sequence instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_length</span> <span class="o">=</span> <span class="mi">320</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">9</span>

    <span class="n">control_sequence</span> <span class="o">=</span> <span class="n">ControlSequence</span><span class="p">(</span>
        <span class="n">controls</span><span class="o">=</span><span class="p">[</span>
            <span class="n">GaussianPulse</span><span class="p">(</span>
                <span class="n">duration</span><span class="o">=</span><span class="n">total_length</span><span class="p">,</span>
                <span class="n">qubit_drive_strength</span><span class="o">=</span><span class="n">qubit_info</span><span class="o">.</span><span class="n">drive_strength</span><span class="p">,</span>
                <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                <span class="n">max_amp</span><span class="o">=</span><span class="n">max_amp</span><span class="p">,</span>
                <span class="n">min_theta</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">max_theta</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
        <span class="n">total_dt</span><span class="o">=</span><span class="n">total_length</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">control_sequence</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.predefined.get_two_axis_gaussian_control_sequence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_two_axis_gaussian_control_sequence</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_two_axis_gaussian_control_sequence</span><span class="p">(</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></span><span class="p">,</span> <span class="n">max_amp</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get predefined two-axis Gaussian control sequence.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qubit_info</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qubit information</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_amp</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum amplitude. Defaults to 0.5.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ControlSequence</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control sequence instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_two_axis_gaussian_control_sequence</span><span class="p">(</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n">QubitInformation</span><span class="p">,</span>
    <span class="n">max_amp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get predefined two-axis Gaussian control sequence.</span>

<span class="sd">    Args:</span>
<span class="sd">        qubit_info (QubitInformation): Qubit information</span>
<span class="sd">        max_amp (float, optional): The maximum amplitude. Defaults to 0.5.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ControlSequence: Control sequence instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_length</span> <span class="o">=</span> <span class="mi">320</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">9</span>

    <span class="n">control_sequence</span> <span class="o">=</span> <span class="n">ControlSequence</span><span class="p">(</span>
        <span class="n">controls</span><span class="o">=</span><span class="p">[</span>
            <span class="n">TwoAxisGaussianPulse</span><span class="p">(</span>
                <span class="n">duration</span><span class="o">=</span><span class="n">total_length</span><span class="p">,</span>
                <span class="n">qubit_drive_strength</span><span class="o">=</span><span class="n">qubit_info</span><span class="o">.</span><span class="n">drive_strength</span><span class="p">,</span>
                <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                <span class="n">max_amp</span><span class="o">=</span><span class="n">max_amp</span><span class="p">,</span>
                <span class="n">min_theta_x</span><span class="o">=-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
                <span class="n">max_theta_x</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
                <span class="n">min_theta_y</span><span class="o">=-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
                <span class="n">max_theta_y</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
        <span class="n">total_dt</span><span class="o">=</span><span class="n">total_length</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">control_sequence</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.predefined.get_drag_pulse_v2_sequence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_drag_pulse_v2_sequence</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_drag_pulse_v2_sequence</span><span class="p">(</span>
    <span class="n">qubit_info_drive_strength</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">max_amp</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">min_theta</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_theta</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n"><span title="jax.numpy.pi">pi</span></span><span class="p">,</span>
    <span class="n">min_beta</span><span class="o">=-</span><span class="mf">2.0</span><span class="p">,</span>
    <span class="n">max_beta</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">9</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get predefined DRAG control sequence with single DRAG pulse.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qubit_info</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qubit information</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_amp</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum amplitude. Defaults to 0.5.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ControlSequence</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control sequence instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_drag_pulse_v2_sequence</span><span class="p">(</span>
    <span class="n">qubit_info_drive_strength</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">max_amp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># NOTE: Choice of maximum amplitude is arbitrary</span>
    <span class="n">min_theta</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">max_theta</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
    <span class="n">min_beta</span><span class="o">=-</span><span class="mf">2.0</span><span class="p">,</span>
    <span class="n">max_beta</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">9</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get predefined DRAG control sequence with single DRAG pulse.</span>

<span class="sd">    Args:</span>
<span class="sd">        qubit_info (QubitInformation): Qubit information</span>
<span class="sd">        max_amp (float, optional): The maximum amplitude. Defaults to 0.5.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ControlSequence: Control sequence instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_length</span> <span class="o">=</span> <span class="mi">320</span>
    <span class="n">control_sequence</span> <span class="o">=</span> <span class="n">ControlSequence</span><span class="p">(</span>
        <span class="n">controls</span><span class="o">=</span><span class="p">[</span>
            <span class="n">DragPulseV2</span><span class="p">(</span>
                <span class="n">duration</span><span class="o">=</span><span class="n">total_length</span><span class="p">,</span>
                <span class="n">qubit_drive_strength</span><span class="o">=</span><span class="n">qubit_info_drive_strength</span><span class="p">,</span>
                <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                <span class="n">max_amp</span><span class="o">=</span><span class="n">max_amp</span><span class="p">,</span>
                <span class="n">min_theta</span><span class="o">=</span><span class="n">min_theta</span><span class="p">,</span>
                <span class="n">max_theta</span><span class="o">=</span><span class="n">max_theta</span><span class="p">,</span>
                <span class="n">min_beta</span><span class="o">=</span><span class="n">min_beta</span><span class="p">,</span>
                <span class="n">max_beta</span><span class="o">=</span><span class="n">max_beta</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
        <span class="n">total_dt</span><span class="o">=</span><span class="n">total_length</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">control_sequence</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.predefined.generate_experimental_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">generate_experimental_data</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate_experimental_data</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
    <span class="n">sample_size</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">shots</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.predefined.SimulationStrategy">SimulationStrategy</span></span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.predefined.SimulationStrategy.RANDOM">RANDOM</span></span><span class="p">,</span>
    <span class="n">get_qubit_information_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[],</span> <span class="n"><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></span>
    <span class="p">]</span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.predefined.get_mock_qubit_information">get_mock_qubit_information</span></span><span class="p">,</span>
    <span class="n">get_control_sequence_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[],</span> <span class="n"><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></span>
    <span class="p">]</span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.predefined.get_multi_drag_control_sequence_v3">get_multi_drag_control_sequence_v3</span></span><span class="p">,</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="int">int</span></span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">method</span><span class="p">:</span> <span class="n"><span title="src.inspeqtor.v1.predefined.WhiteboxStrategy">WhiteboxStrategy</span></span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.predefined.WhiteboxStrategy.ODE">ODE</span></span><span class="p">,</span>
    <span class="n">trotter_steps</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">expectation_value_receipt</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span>
        <span class="n"><a class="autorefs autorefs-internal" title="            ExpectationValue


  
      dataclass
   (src.inspeqtor.v1.data.ExpectationValue)" href="#src.inspeqtor.v1.data.ExpectationValue">ExpectationValue</a></span>
    <span class="p">]</span> <span class="o">=</span> <span class="n"><span title="src.inspeqtor.v1.constant.default_expectation_values_order">default_expectation_values_order</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span>
    <span class="n"><a class="autorefs autorefs-internal" title="            ExperimentData


  
      dataclass
   (src.inspeqtor.v1.data.ExperimentData)" href="#src.inspeqtor.v1.data.ExperimentData">ExperimentData</a></span><span class="p">,</span>
    <span class="n"><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></span><span class="p">,</span>
    <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate simulated dataset</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hamiltonian</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total Hamiltonian of the device</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample size of the control parameters. Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shots</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of shots used to estimate expectation value, will be used if <code>SimulationStrategy</code> is <code>SHOT</code>, otherwise ignored. Defaults to 1000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategy</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.predefined.SimulationStrategy">SimulationStrategy</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Simulation strategy. Defaults to SimulationStrategy.RANDOM.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.predefined.SimulationStrategy.RANDOM">RANDOM</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>get_qubit_information_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[], <a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function that return qubit information. Defaults to get_mock_qubit_information.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.predefined.get_mock_qubit_information">get_mock_qubit_information</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>get_control_sequence_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[], <a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function that return control sequence. Defaults to get_multi_drag_control_sequence_v3.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.predefined.get_multi_drag_control_sequence_v3">get_multi_drag_control_sequence_v3</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum step of solver. Defaults to int(2**16).</p>
              </div>
            </td>
            <td>
                  <code><span title="int">int</span>(2 ** 16)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.predefined.WhiteboxStrategy">WhiteboxStrategy</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unitary solver method. Defaults to WhiteboxStrategy.ODE.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.predefined.WhiteboxStrategy.ODE">ODE</span></code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not support strategy</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<a class="autorefs autorefs-internal" title="            ExperimentData


  
      dataclass
   (src.inspeqtor.v1.data.ExperimentData)" href="#src.inspeqtor.v1.data.ExperimentData">ExperimentData</a>, <a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a>, <span title="jax.numpy.ndarray">ndarray</span>, <span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[ExperimentData, ControlSequence, jnp.ndarray, typing.Callable[[jnp.ndarray], jnp.ndarray]]: tuple of (1) Experiment data, (2) Pulse sequence, (3) Noisy unitary, (4) Noisy solver</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_experimental_data</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="n">SimulationStrategy</span> <span class="o">=</span> <span class="n">SimulationStrategy</span><span class="o">.</span><span class="n">RANDOM</span><span class="p">,</span>
    <span class="n">get_qubit_information_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span>
        <span class="p">[],</span> <span class="n">QubitInformation</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">get_mock_qubit_information</span><span class="p">,</span>
    <span class="n">get_control_sequence_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span>
        <span class="p">[],</span> <span class="n">ControlSequence</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">get_multi_drag_control_sequence_v3</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">WhiteboxStrategy</span> <span class="o">=</span> <span class="n">WhiteboxStrategy</span><span class="o">.</span><span class="n">ODE</span><span class="p">,</span>
    <span class="n">trotter_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">expectation_value_receipt</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span>
        <span class="n">ExpectationValue</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">default_expectation_values_order</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span>
    <span class="n">ExperimentData</span><span class="p">,</span>
    <span class="n">ControlSequence</span><span class="p">,</span>
    <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate simulated dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        key (jnp.ndarray): Random key</span>
<span class="sd">        hamiltonian (typing.Callable[..., jnp.ndarray]): Total Hamiltonian of the device</span>
<span class="sd">        sample_size (int, optional): Sample size of the control parameters. Defaults to 10.</span>
<span class="sd">        shots (int, optional): Number of shots used to estimate expectation value, will be used if `SimulationStrategy` is `SHOT`, otherwise ignored. Defaults to 1000.</span>
<span class="sd">        strategy (SimulationStrategy, optional): Simulation strategy. Defaults to SimulationStrategy.RANDOM.</span>
<span class="sd">        get_qubit_information_fn (typing.Callable[ [], QubitInformation ], optional): Function that return qubit information. Defaults to get_mock_qubit_information.</span>
<span class="sd">        get_control_sequence_fn (typing.Callable[ [], ControlSequence ], optional): Function that return control sequence. Defaults to get_multi_drag_control_sequence_v3.</span>
<span class="sd">        max_steps (int, optional): Maximum step of solver. Defaults to int(2**16).</span>
<span class="sd">        method (WhiteboxStrategy, optional): Unitary solver method. Defaults to WhiteboxStrategy.ODE.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Not support strategy</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[ExperimentData, ControlSequence, jnp.ndarray, typing.Callable[[jnp.ndarray], jnp.ndarray]]: tuple of (1) Experiment data, (2) Pulse sequence, (3) Noisy unitary, (4) Noisy solver</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">qubit_info</span><span class="p">,</span> <span class="n">control_sequence</span><span class="p">,</span> <span class="n">config</span> <span class="o">=</span> <span class="n">get_mock_prefined_exp_v1</span><span class="p">(</span>
        <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
        <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span>
        <span class="n">get_control_sequence_fn</span><span class="o">=</span><span class="n">get_control_sequence_fn</span><span class="p">,</span>
        <span class="n">get_qubit_information_fn</span><span class="o">=</span><span class="n">get_qubit_information_fn</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Generate mock expectation value</span>
    <span class="n">key</span><span class="p">,</span> <span class="n">exp_key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="n">dt</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">device_cycle_time_ns</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="n">WhiteboxStrategy</span><span class="o">.</span><span class="n">TROTTER</span><span class="p">:</span>
        <span class="n">noisy_simulator</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span>
            <span class="n">make_trotterization_solver</span><span class="p">(</span>
                <span class="n">hamiltonian</span><span class="o">=</span><span class="n">hamiltonian</span><span class="p">,</span>
                <span class="n">total_dt</span><span class="o">=</span><span class="n">control_sequence</span><span class="o">.</span><span class="n">total_dt</span><span class="p">,</span>
                <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                <span class="n">trotter_steps</span><span class="o">=</span><span class="n">trotter_steps</span><span class="p">,</span>
                <span class="n">y0</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex128</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t_eval</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="n">control_sequence</span><span class="o">.</span><span class="n">total_dt</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span> <span class="n">control_sequence</span><span class="o">.</span><span class="n">total_dt</span>
        <span class="p">)</span>
        <span class="n">noisy_simulator</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span>
            <span class="n">partial</span><span class="p">(</span>
                <span class="n">solver</span><span class="p">,</span>
                <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span>
                <span class="n">hamiltonian</span><span class="o">=</span><span class="n">hamiltonian</span><span class="p">,</span>
                <span class="n">y0</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex64</span><span class="p">),</span>
                <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">t1</span><span class="o">=</span><span class="n">control_sequence</span><span class="o">.</span><span class="n">total_dt</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span>
                <span class="n">max_steps</span><span class="o">=</span><span class="n">max_steps</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">control_params_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">parameter_structure</span> <span class="o">=</span> <span class="n">control_sequence</span><span class="o">.</span><span class="n">get_parameter_names</span><span class="p">()</span>
    <span class="n">num_parameters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">parameter_structure</span><span class="p">)))</span>
    <span class="c1"># control_params: list[jnp.ndarray] = []</span>
    <span class="n">control_params</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">num_parameters</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">control_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">sample_size</span><span class="p">):</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">pulse_params</span> <span class="o">=</span> <span class="n">control_sequence</span><span class="o">.</span><span class="n">sample_params</span><span class="p">(</span><span class="n">subkey</span><span class="p">)</span>
        <span class="n">control_params_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pulse_params</span><span class="p">)</span>

        <span class="n">control_params</span> <span class="o">=</span> <span class="n">control_params</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">control_idx</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="n">list_of_params_to_array</span><span class="p">(</span><span class="n">pulse_params</span><span class="p">,</span> <span class="n">parameter_structure</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">unitaries</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">noisy_simulator</span><span class="p">)(</span><span class="n">control_params</span><span class="p">)</span>
    <span class="n">SHOTS</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">shots</span>

    <span class="c1"># Calculate the expectation values depending on the strategy</span>
    <span class="n">unitaries_f</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">unitaries</span><span class="p">)[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>

    <span class="k">assert</span> <span class="n">unitaries_f</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span>
        <span class="n">sample_size</span><span class="p">,</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="mi">2</span><span class="p">,</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Final unitaries shape is </span><span class="si">{</span><span class="n">unitaries_f</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="n">SimulationStrategy</span><span class="o">.</span><span class="n">RANDOM</span><span class="p">:</span>
        <span class="c1"># Just random expectation values with key</span>
        <span class="n">expectation_values</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">exp_key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">sample_size</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="n">SimulationStrategy</span><span class="o">.</span><span class="n">IDEAL</span><span class="p">:</span>
        <span class="n">expectation_values</span> <span class="o">=</span> <span class="n">calculate_expectation_values</span><span class="p">(</span><span class="n">unitaries_f</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="n">SimulationStrategy</span><span class="o">.</span><span class="n">SHOT</span><span class="p">:</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">sample_key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="c1"># The `shot_quantum_device` function will re-calculate the unitary</span>
        <span class="n">expectation_values</span> <span class="o">=</span> <span class="n">shot_quantum_device</span><span class="p">(</span>
            <span class="n">sample_key</span><span class="p">,</span>
            <span class="n">control_params</span><span class="p">,</span>
            <span class="n">noisy_simulator</span><span class="p">,</span>
            <span class="n">SHOTS</span><span class="p">,</span>
            <span class="n">expectation_value_receipt</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">assert</span> <span class="n">expectation_values</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span>
        <span class="n">sample_size</span><span class="p">,</span>
        <span class="mi">18</span><span class="p">,</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Expectation values shape is </span><span class="si">{</span><span class="n">expectation_values</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sample_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">sample_size</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">exp_idx</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">expectation_value_receipt</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">make_row</span><span class="p">(</span>
                <span class="n">expectation_value</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">expectation_values</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">,</span> <span class="n">exp_idx</span><span class="p">]),</span>
                <span class="n">initial_state</span><span class="o">=</span><span class="n">exp</span><span class="o">.</span><span class="n">initial_state</span><span class="p">,</span>
                <span class="n">observable</span><span class="o">=</span><span class="n">exp</span><span class="o">.</span><span class="n">observable</span><span class="p">,</span>
                <span class="n">parameters_list</span><span class="o">=</span><span class="n">control_params_list</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">],</span>
                <span class="n">parameters_id</span><span class="o">=</span><span class="n">sample_idx</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

    <span class="n">exp_data</span> <span class="o">=</span> <span class="n">ExperimentData</span><span class="p">(</span><span class="n">experiment_config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">preprocess_data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">exp_data</span><span class="p">,</span>
        <span class="n">control_sequence</span><span class="p">,</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">unitaries</span><span class="p">),</span>
        <span class="n">noisy_simulator</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.predefined.get_single_qubit_whitebox" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_single_qubit_whitebox</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_single_qubit_whitebox</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
    <span class="n">control_sequence</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></span><span class="p">,</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="int">int</span></span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">get_envelope_transformer</span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            get_envelope_transformer (src.inspeqtor.v1.control.get_envelope_transformer)" href="#src.inspeqtor.v1.control.get_envelope_transformer">get_envelope_transformer</a></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate single qubit whitebox</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hamiltonian</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hamiltonian</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control_sequence</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control sequence instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qubit_info</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            QubitInformation


  
      dataclass
   (src.inspeqtor.v1.data.QubitInformation)" href="#src.inspeqtor.v1.data.QubitInformation">QubitInformation</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qubit information</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Duration of 1 timestep in nanosecond</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum steps of solver. Defaults to int(2**16).</p>
              </div>
            </td>
            <td>
                  <code><span title="int">int</span>(2 ** 16)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable[[jnp.ndarray], jnp.ndarray]: Whitebox with ODE solver</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_single_qubit_whitebox</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">control_sequence</span><span class="p">:</span> <span class="n">ControlSequence</span><span class="p">,</span>
    <span class="n">qubit_info</span><span class="p">:</span> <span class="n">QubitInformation</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">get_envelope_transformer</span><span class="o">=</span><span class="n">get_envelope_transformer</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate single qubit whitebox</span>

<span class="sd">    Args:</span>
<span class="sd">        hamiltonian (typing.Callable[..., jnp.ndarray]): Hamiltonian</span>
<span class="sd">        control_sequence (ControlSequence): Control sequence instance</span>
<span class="sd">        qubit_info (QubitInformation): Qubit information</span>
<span class="sd">        dt (float): Duration of 1 timestep in nanosecond</span>
<span class="sd">        max_steps (int, optional): Maximum steps of solver. Defaults to int(2**16).</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable[[jnp.ndarray], jnp.ndarray]: Whitebox with ODE solver</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t_eval</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">control_sequence</span><span class="o">.</span><span class="n">total_dt</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span> <span class="n">control_sequence</span><span class="o">.</span><span class="n">total_dt</span><span class="p">)</span>

    <span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
        <span class="n">hamiltonian</span><span class="p">,</span>
        <span class="n">qubit_info</span><span class="o">=</span><span class="n">qubit_info</span><span class="p">,</span>
        <span class="n">signal</span><span class="o">=</span><span class="n">make_signal_fn</span><span class="p">(</span>
            <span class="n">get_envelope_transformer</span><span class="p">(</span><span class="n">control_sequence</span><span class="p">),</span>
            <span class="n">qubit_info</span><span class="o">.</span><span class="n">frequency</span><span class="p">,</span>
            <span class="n">dt</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">whitebox</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
        <span class="n">solver</span><span class="p">,</span>
        <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span>
        <span class="n">hamiltonian</span><span class="o">=</span><span class="n">hamiltonian</span><span class="p">,</span>
        <span class="n">y0</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">complex_</span><span class="p">),</span>
        <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">t1</span><span class="o">=</span><span class="n">control_sequence</span><span class="o">.</span><span class="n">total_dt</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span>
        <span class="n">max_steps</span><span class="o">=</span><span class="n">max_steps</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">whitebox</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.predefined.load_data_from_path" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">load_data_from_path</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_data_from_path</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">,</span>
    <span class="n">hamiltonian_spec</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            HamiltonianSpec


  
      dataclass
   (src.inspeqtor.v1.predefined.HamiltonianSpec)" href="#src.inspeqtor.v1.predefined.HamiltonianSpec">HamiltonianSpec</a></span><span class="p">,</span>
    <span class="n">pulse_reader</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.v1.predefined.default_pulse_reader">default_pulse_reader</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="src.inspeqtor.v1.utils.LoadedData">LoadedData</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load and prepare the experimental data from given path and hamiltonian spec.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the folder that contain experimental data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hamiltonian_spec</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            HamiltonianSpec


  
      dataclass
   (src.inspeqtor.v1.predefined.HamiltonianSpec)" href="#src.inspeqtor.v1.predefined.HamiltonianSpec">HamiltonianSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The specification of the Hamiltonian</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pulse_reader</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to default_pulse_reader.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.inspeqtor.v1.predefined.default_pulse_reader">default_pulse_reader</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>LoadedData</code></td>            <td>
                  <code><span title="src.inspeqtor.v1.utils.LoadedData">LoadedData</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object contatin necessary information for device characterization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_data_from_path</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">hamiltonian_spec</span><span class="p">:</span> <span class="n">HamiltonianSpec</span><span class="p">,</span>
    <span class="n">pulse_reader</span><span class="o">=</span><span class="n">default_pulse_reader</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoadedData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load and prepare the experimental data from given path and hamiltonian spec.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str | pathlib.Path): The path to the folder that contain experimental data.</span>
<span class="sd">        hamiltonian_spec (HamiltonianSpec): The specification of the Hamiltonian</span>
<span class="sd">        pulse_reader (typing.Any, optional): _description_. Defaults to default_pulse_reader.</span>

<span class="sd">    Returns:</span>
<span class="sd">        LoadedData: The object contatin necessary information for device characterization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">exp_data</span> <span class="o">=</span> <span class="n">ExperimentData</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">control_sequence</span> <span class="o">=</span> <span class="n">pulse_reader</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">qubit_info</span> <span class="o">=</span> <span class="n">exp_data</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">exp_data</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">device_cycle_time_ns</span>

    <span class="n">whitebox</span> <span class="o">=</span> <span class="n">hamiltonian_spec</span><span class="o">.</span><span class="n">get_solver</span><span class="p">(</span><span class="n">control_sequence</span><span class="p">,</span> <span class="n">qubit_info</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">prepare_data</span><span class="p">(</span><span class="n">exp_data</span><span class="p">,</span> <span class="n">control_sequence</span><span class="p">,</span> <span class="n">whitebox</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.predefined.save_data_to_path" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">save_data_to_path</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_data_to_path</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">,</span>
    <span class="n">experiment_data</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ExperimentData


  
      dataclass
   (src.inspeqtor.v1.data.ExperimentData)" href="#src.inspeqtor.v1.data.ExperimentData">ExperimentData</a></span><span class="p">,</span>
    <span class="n">control_sequence</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Save the experimental data to the path</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to folder to save the experimental data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>experiment_data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ExperimentData


  
      dataclass
   (src.inspeqtor.v1.data.ExperimentData)" href="#src.inspeqtor.v1.data.ExperimentData">ExperimentData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The experimental data object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control_sequence</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ControlSequence


  
      dataclass
   (src.inspeqtor.v1.control.ControlSequence)" href="#src.inspeqtor.v1.control.ControlSequence">ControlSequence</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The control sequence that used to create the experimental data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/predefined.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_data_to_path</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">experiment_data</span><span class="p">:</span> <span class="n">ExperimentData</span><span class="p">,</span>
    <span class="n">control_sequence</span><span class="p">:</span> <span class="n">ControlSequence</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the experimental data to the path</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str | pathlib.Path): The path to folder to save the experimental data</span>
<span class="sd">        experiment_data (ExperimentData): The experimental data object</span>
<span class="sd">        control_sequence (ControlSequence): The control sequence that used to create the experimental data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">experiment_data</span><span class="o">.</span><span class="n">save_to_folder</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">control_sequence</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="probabilistic">Probabilistic</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.probabilistic" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.probabilistic</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="src.inspeqtor.v1.probabilistic.LearningModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">LearningModel</span>


</h3>


    <div class="doc doc-contents ">



        <p>The learning model.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LearningModel</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The learning model.&quot;&quot;&quot;</span>

    <span class="n">TruncatedNormal</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">BernoulliProbs</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_probabilistic_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_probabilistic_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">predictive_model</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
    <span class="n">shots</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">block_graybox</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">separate_observables</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">log_expectation_values</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make probabilistic model from the Statistical model with priors</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>base_model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The statistical based model, currently only support flax.linen module</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_prediction_to_expvals_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to convert output from model to expectation values array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bnn_prior</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="numpyro.distributions.Distribution">Distribution</span>] | <span title="numpyro.distributions.Distribution">Distribution</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The priors of BNN. Defaults to dist.Normal(0.0, 1.0).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shots</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shots forcing PGM to sample. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>block_graybox</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, the latent variables in Graybox model will be hidden, i.e. not traced by <code>numpyro</code>. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enable_bnn</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, the statistical model will be convert to probabilistic model. Defaults to True.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>separate_observables</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, the observable will be separate into dict form. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable: Probabilistic Graybox Model</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">predictive_model</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">block_graybox</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">separate_observables</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">log_expectation_values</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make probabilistic model from the Statistical model with priors</span>

<span class="sd">    Args:</span>
<span class="sd">        base_model (nn.Module): The statistical based model, currently only support flax.linen module</span>
<span class="sd">        model_prediction_to_expvals_fn (typing.Callable[..., jnp.ndarray]): Function to convert output from model to expectation values array</span>
<span class="sd">        bnn_prior (dict[str, dist.Distribution] | dist.Distribution, optional): The priors of BNN. Defaults to dist.Normal(0.0, 1.0).</span>
<span class="sd">        shots (int, optional): The number of shots forcing PGM to sample. Defaults to 1.</span>
<span class="sd">        block_graybox (bool, optional): If true, the latent variables in Graybox model will be hidden, i.e. not traced by `numpyro`. Defaults to False.</span>
<span class="sd">        enable_bnn (bool, optional): If true, the statistical model will be convert to probabilistic model. Defaults to True.</span>
<span class="sd">        separate_observables (bool, optional): If true, the observable will be separate into dict form. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable: Probabilistic Graybox Model</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">block_graybox_fn</span><span class="p">(</span>
        <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">prng_key</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">handlers</span><span class="o">.</span><span class="n">block</span><span class="p">(),</span> <span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rng_seed</span><span class="o">=</span><span class="n">key</span><span class="p">):</span>
            <span class="n">expvals</span> <span class="o">=</span> <span class="n">predictive_model</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">expvals</span>

    <span class="n">graybox_fn</span> <span class="o">=</span> <span class="n">block_graybox_fn</span> <span class="k">if</span> <span class="n">block_graybox</span> <span class="k">else</span> <span class="n">predictive_model</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bernoulli_model</span><span class="p">(</span>
        <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">observables</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">expvals</span> <span class="o">=</span> <span class="n">graybox_fn</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">log_expectation_values</span><span class="p">:</span>
            <span class="n">numpyro</span><span class="o">.</span><span class="n">deterministic</span><span class="p">(</span><span class="s2">&quot;expectation_values&quot;</span><span class="p">,</span> <span class="n">expvals</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">observables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sizes</span> <span class="o">=</span> <span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">18</span><span class="p">,)</span>
            <span class="k">if</span> <span class="n">shots</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sizes</span> <span class="o">=</span> <span class="p">(</span><span class="n">shots</span><span class="p">,)</span> <span class="o">+</span> <span class="n">sizes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sizes</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">shape</span>

        <span class="c1"># The plate is for the shots prediction to work properly</span>
        <span class="k">with</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">optional</span><span class="p">(</span>
            <span class="n">shots</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">plate_stack</span><span class="p">(</span><span class="s2">&quot;plate&quot;</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">sizes</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">separate_observables</span><span class="p">:</span>
                <span class="n">expvals_samples</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">default_expectation_values_order</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;obs/</span><span class="si">{</span><span class="n">exp</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">exp</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">dist</span><span class="o">.</span><span class="n">BernoulliProbs</span><span class="p">(</span>
                            <span class="n">probs</span><span class="o">=</span><span class="n">expectation_value_to_prob_minus</span><span class="p">(</span>
                                <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">expvals</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
                            <span class="p">)</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">to_event</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                        <span class="n">obs</span><span class="o">=</span><span class="p">(</span>
                            <span class="n">observables</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="k">if</span> <span class="n">observables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
                        <span class="p">),</span>
                    <span class="p">)</span>

                    <span class="n">expvals_samples</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;obs/</span><span class="si">{</span><span class="n">exp</span><span class="o">.</span><span class="n">initial_state</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">exp</span><span class="o">.</span><span class="n">observable</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">expvals_samples</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                    <span class="s2">&quot;obs&quot;</span><span class="p">,</span>
                    <span class="n">dist</span><span class="o">.</span><span class="n">BernoulliProbs</span><span class="p">(</span>
                        <span class="n">probs</span><span class="o">=</span><span class="n">expectation_value_to_prob_minus</span><span class="p">(</span><span class="n">expvals</span><span class="p">)</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">to_event</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                    <span class="n">obs</span><span class="o">=</span><span class="n">observables</span><span class="p">,</span>
                    <span class="n">infer</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;enumerate&quot;</span><span class="p">:</span> <span class="s2">&quot;parallel&quot;</span><span class="p">},</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">expvals_samples</span>

    <span class="k">return</span> <span class="n">bernoulli_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.get_args_of_distribution" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_args_of_distribution</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_args_of_distribution</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the arguments used to construct Distribution, if the provided parameter is not Distribution, return it.
So that the function can be used with <code>jax.tree.map</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maybe Distribution</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: Argument of Distribution if Distribution is provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_args_of_distribution</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the arguments used to construct Distribution, if the provided parameter is not Distribution, return it.</span>
<span class="sd">    So that the function can be used with `jax.tree.map`.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (typing.Any): Maybe Distribution</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: Argument of Distribution if Distribution is provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">get_args</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.construct_normal_priors" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">construct_normal_priors</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">construct_normal_priors</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct a dict of Normal Distributions with posterior</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>posterior</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of Normal distribution arguments</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: dict of Normal distributions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span>
<span class="k">def</span><span class="w"> </span><span class="nf">construct_normal_priors</span><span class="p">(</span><span class="n">posterior</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a dict of Normal Distributions with posterior</span>

<span class="sd">    Args:</span>
<span class="sd">        posterior (typing.Any): Dict of Normal distribution arguments</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: dict of Normal distributions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">posterior_distributions</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posterior</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">posterior</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="n">posterior_distributions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
    <span class="k">return</span> <span class="n">posterior_distributions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.construct_normal_prior_from_samples" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">construct_normal_prior_from_samples</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">construct_normal_prior_from_samples</span><span class="p">(</span>
    <span class="n">posterior_samples</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="numpyro.distributions.Distribution">Distribution</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct a dict of Normal Distributions with posterior sample</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>posterior_samples</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Posterior sample</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="numpyro.distributions.Distribution">Distribution</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, dist.Distribution]: dict of Normal Distributions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">construct_normal_prior_from_samples</span><span class="p">(</span>
    <span class="n">posterior_samples</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a dict of Normal Distributions with posterior sample</span>

<span class="sd">    Args:</span>
<span class="sd">        posterior_samples (dict[str, jnp.ndarray]): Posterior sample</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, dist.Distribution]: dict of Normal Distributions</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">posterior_mean</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">posterior_samples</span><span class="p">)</span>
    <span class="n">posterior_std</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">posterior_samples</span><span class="p">)</span>

    <span class="n">prior</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">mean</span> <span class="ow">in</span> <span class="n">posterior_mean</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">prior</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">posterior_std</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">prior</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_normal_posterior_dist_fn_from_svi_result" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_normal_posterior_dist_fn_from_svi_result</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_normal_posterior_dist_fn_from_svi_result</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">guide</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
    <span class="n">num_samples</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">prefix</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n"><span title="numpyro.distributions.Distribution">Distribution</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This function create a get posterior function to be used with <code>numpyro.contrib.module</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>guide</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The guide (variational distribution)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The variational parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_samples</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of sample for approxiatation the posterior distributions</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;graybox&quot;</span>
<span class="n">prior_fn</span> <span class="o">=</span> <span class="n">make_normal_posterior_dist_fn_from_svi_result</span><span class="p">(</span>
    <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">guide</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">,</span> <span class="n">prefix</span>
<span class="p">)</span>
<span class="n">graybox_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_flax_probabilistic_graybox_model</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
    <span class="n">base_model</span><span class="o">=</span><span class="n">base_model</span><span class="p">,</span>
    <span class="n">adapter_fn</span><span class="o">=</span><span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">observable_to_expvals</span><span class="p">,</span>
    <span class="n">prior</span><span class="o">=</span><span class="n">prior_fn</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">posterior_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">predictive_model</span><span class="o">=</span><span class="n">graybox_model</span><span class="p">,</span> <span class="n">log_expectation_values</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="int">int</span>, ...]], <span title="numpyro.distributions.Distribution">Distribution</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable[[str, tuple[int, ...]], dist.Distribution]: The function that return posterior distribution</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_normal_posterior_dist_fn_from_svi_result</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">guide</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function create a get posterior function to be used with `numpyro.contrib.module`.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (jnp.ndarray): The random key</span>
<span class="sd">        guide (typing.Callable): The guide (variational distribution)</span>
<span class="sd">        params (dict[str, jnp.ndarray]): The variational parameters</span>
<span class="sd">        num_samples (int): The number of sample for approxiatation the posterior distributions</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        prefix = &quot;graybox&quot;</span>
<span class="sd">        prior_fn = make_normal_posterior_dist_fn_from_svi_result(</span>
<span class="sd">            jax.random.key(0), guide, result.params, 10_000, prefix</span>
<span class="sd">        )</span>
<span class="sd">        graybox_model = sq.probabilistic.make_flax_probabilistic_graybox_model(</span>
<span class="sd">            name=prefix,</span>
<span class="sd">            base_model=base_model,</span>
<span class="sd">            adapter_fn=sq.probabilistic.observable_to_expvals,</span>
<span class="sd">            prior=prior_fn,</span>
<span class="sd">        )</span>
<span class="sd">        posterior_model = sq.probabilistic.make_probabilistic_model(</span>
<span class="sd">            predictive_model=graybox_model, log_expectation_values=True</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable[[str, tuple[int, ...]], dist.Distribution]: The function that return posterior distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">posterior_samples</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">)(</span>
        <span class="n">key</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_dist_fn</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span><span class="p">:</span>
        <span class="n">site_name</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">name</span>
        <span class="k">return</span> <span class="n">construct_normal_prior_from_samples</span><span class="p">(</span><span class="n">posterior_samples</span><span class="p">)[</span><span class="n">site_name</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">posterior_dist_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_predictive_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_predictive_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_predictive_fn</span><span class="p">(</span>
    <span class="n">posterior_model</span><span class="p">,</span> <span class="n">learning_model</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            LearningModel (src.inspeqtor.v1.probabilistic.LearningModel)" href="#src.inspeqtor.v1.probabilistic.LearningModel">LearningModel</a></span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct predictive model from the probabilsitic model.
This function does not relied on guide and the variational parameters</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="n">characterized_result</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">SVIResult</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span>
    <span class="n">PGM_model_path</span> <span class="o">/</span> <span class="s2">&quot;model.json&quot;</span>
<span class="p">)</span>

<span class="n">base_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">linen</span><span class="o">.</span><span class="n">WoModel</span><span class="p">(</span>
    <span class="n">shared_layers</span><span class="o">=</span><span class="n">characterized_result</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;model_config&quot;</span><span class="p">][</span><span class="s2">&quot;hidden_sizes&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">pauli_layers</span><span class="o">=</span><span class="n">characterized_result</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;model_config&quot;</span><span class="p">][</span><span class="s2">&quot;hidden_sizes&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">graybox_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_flax_probabilistic_graybox_model</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;graybox&quot;</span><span class="p">,</span>
    <span class="n">base_model</span><span class="o">=</span><span class="n">base_model</span><span class="p">,</span>
    <span class="n">adapter_fn</span><span class="o">=</span><span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">observable_to_expvals</span><span class="p">,</span>
    <span class="n">prior</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">graybox_probabilistic_model</span><span class="o">=</span><span class="n">graybox_model</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># initialize guide</span>
<span class="n">guide</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">auto_diagonal_normal_guide</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">ml</span><span class="o">.</span><span class="n">custom_feature_map</span><span class="p">(</span><span class="n">loaded_data</span><span class="o">.</span><span class="n">control_parameters</span><span class="p">),</span>
    <span class="n">loaded_data</span><span class="o">.</span><span class="n">unitaries</span><span class="p">,</span>
    <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">shots</span><span class="p">,</span> <span class="n">loaded_data</span><span class="o">.</span><span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">18</span><span class="p">)),</span>
<span class="p">)</span>
<span class="n">priors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">k</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;graybox/&quot;</span><span class="p">):</span> <span class="n">v</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">make_prior_from_params</span><span class="p">(</span><span class="n">guide</span><span class="p">,</span> <span class="n">characterized_result</span><span class="o">.</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="p">}</span>
<span class="n">graybox_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_flax_probabilistic_graybox_model</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;graybox&quot;</span><span class="p">,</span>
    <span class="n">base_model</span><span class="o">=</span><span class="n">base_model</span><span class="p">,</span>
    <span class="n">adapter_fn</span><span class="o">=</span><span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">observable_to_expvals</span><span class="p">,</span>
    <span class="n">prior</span><span class="o">=</span><span class="n">priors</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">posterior_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">graybox_probabilistic_model</span><span class="o">=</span><span class="n">graybox_model</span><span class="p">,</span>
    <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span>
    <span class="n">block_graybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">log_expectation_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">predicetive_fn</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_predictive_fn</span><span class="p">(</span>
    <span class="n">posterior_model</span><span class="p">,</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">LearningModel</span><span class="o">.</span><span class="n">BernoulliProbs</span>
<span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>posterior_model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>probabilsitic model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>learning_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            LearningModel (src.inspeqtor.v1.probabilistic.LearningModel)" href="#src.inspeqtor.v1.probabilistic.LearningModel">LearningModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_predictive_fn</span><span class="p">(</span>
    <span class="n">posterior_model</span><span class="p">,</span>
    <span class="n">learning_model</span><span class="p">:</span> <span class="n">LearningModel</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct predictive model from the probabilsitic model.</span>
<span class="sd">    This function does not relied on guide and the variational parameters</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        characterized_result = sq.probabilistic.SVIResult.from_file(</span>
<span class="sd">            PGM_model_path / &quot;model.json&quot;</span>
<span class="sd">        )</span>

<span class="sd">        base_model = sq.models.library.linen.WoModel(</span>
<span class="sd">            shared_layers=characterized_result.config[&quot;model_config&quot;][&quot;hidden_sizes&quot;][0],</span>
<span class="sd">            pauli_layers=characterized_result.config[&quot;model_config&quot;][&quot;hidden_sizes&quot;][1],</span>
<span class="sd">        )</span>
<span class="sd">        graybox_model = sq.probabilistic.make_flax_probabilistic_graybox_model(</span>
<span class="sd">            name=&quot;graybox&quot;,</span>
<span class="sd">            base_model=base_model,</span>
<span class="sd">            adapter_fn=sq.probabilistic.observable_to_expvals,</span>
<span class="sd">            prior=dist.Normal(0, 1),</span>
<span class="sd">        )</span>
<span class="sd">        model = sq.probabilistic.make_probabilistic_model(</span>
<span class="sd">            graybox_probabilistic_model=graybox_model,</span>
<span class="sd">        )</span>
<span class="sd">        # initialize guide</span>
<span class="sd">        guide = sq.probabilistic.auto_diagonal_normal_guide(</span>
<span class="sd">            model,</span>
<span class="sd">            ml.custom_feature_map(loaded_data.control_parameters),</span>
<span class="sd">            loaded_data.unitaries,</span>
<span class="sd">            jnp.zeros(shape=(shots, loaded_data.control_parameters.shape[0], 18)),</span>
<span class="sd">        )</span>
<span class="sd">        priors = {</span>
<span class="sd">            k.strip(&quot;graybox/&quot;): v</span>
<span class="sd">            for k, v in make_prior_from_params(guide, characterized_result.params).items()</span>
<span class="sd">        }</span>
<span class="sd">        graybox_model = sq.probabilistic.make_flax_probabilistic_graybox_model(</span>
<span class="sd">            name=&quot;graybox&quot;,</span>
<span class="sd">            base_model=base_model,</span>
<span class="sd">            adapter_fn=sq.probabilistic.observable_to_expvals,</span>
<span class="sd">            prior=priors,</span>
<span class="sd">        )</span>
<span class="sd">        posterior_model = sq.probabilistic.make_probabilistic_model(</span>
<span class="sd">            graybox_probabilistic_model=graybox_model,</span>
<span class="sd">            shots=shots,</span>
<span class="sd">            block_graybox=True,</span>
<span class="sd">            log_expectation_values=True,</span>
<span class="sd">        )</span>
<span class="sd">        predicetive_fn = sq.probabilistic.make_predictive_fn(</span>
<span class="sd">            posterior_model, sq.probabilistic.LearningModel.BernoulliProbs</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        posterior_model (typing.Any): probabilsitic model</span>
<span class="sd">        learning_model (LearningModel): _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">binary_predict_expectation_values</span><span class="p">(</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">control_params</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitary</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
            <span class="n">binary_to_eigenvalue</span><span class="p">(</span>
                <span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">posterior_model</span><span class="p">,</span> <span class="n">key</span><span class="p">)(</span>  <span class="c1"># type: ignore</span>
                    <span class="n">control_params</span><span class="p">,</span> <span class="n">unitary</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">normal_predict_expectation_values</span><span class="p">(</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">control_params</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">unitary</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">posterior_model</span><span class="p">,</span> <span class="n">key</span><span class="p">)(</span>  <span class="c1"># type: ignore</span>
            <span class="n">control_params</span><span class="p">,</span> <span class="n">unitary</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">binary_predict_expectation_values</span>
        <span class="k">if</span> <span class="n">learning_model</span> <span class="o">==</span> <span class="n">LearningModel</span><span class="o">.</span><span class="n">BernoulliProbs</span>
        <span class="k">else</span> <span class="n">normal_predict_expectation_values</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_pdf" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_pdf</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_pdf</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">bins</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make the numberical PDF from given sample using histogram method</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sample</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample to make PDF.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bins</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of interval bin.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>srange</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The range of the pdf. Defaults to (-1, 1).</p>
              </div>
            </td>
            <td>
                  <code>(-1, 1)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: The approximated numerical PDF</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_pdf</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">bins</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make the numberical PDF from given sample using histogram method</span>

<span class="sd">    Args:</span>
<span class="sd">        sample (jnp.ndarray): Sample to make PDF.</span>
<span class="sd">        bins (int): The number of interval bin.</span>
<span class="sd">        srange (tuple, optional): The range of the pdf. Defaults to (-1, 1).</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: The approximated numerical PDF</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">density</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">srange</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">density</span> <span class="o">*</span> <span class="n">dx</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.safe_kl_divergence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">safe_kl_divergence</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">safe_kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the KL divergence where the infinity is converted to zero.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The left PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The right PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The KL divergence</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">safe_kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the KL divergence where the infinity is converted to zero.</span>

<span class="sd">    Args:</span>
<span class="sd">        p (jnp.ndarray): The left PDF</span>
<span class="sd">        q (jnp.ndarray): The right PDF</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The KL divergence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">rel_entr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="n">posinf</span><span class="o">=</span><span class="mf">0.0</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.kl_divergence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">kl_divergence</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the KL divergence</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The left PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The right PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray:  The KL divergence</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the KL divergence</span>

<span class="sd">    Args:</span>
<span class="sd">        p (jnp.ndarray): The left PDF</span>
<span class="sd">        q (jnp.ndarray): The right PDF</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray:  The KL divergence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">rel_entr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.safe_jensenshannon_divergence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">safe_jensenshannon_divergence</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">safe_jensenshannon_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate Jensen-Shannon Divergnece using KL divergence.
Implement following: https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.jensenshannon.html</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The left PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The right PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">safe_jensenshannon_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate Jensen-Shannon Divergnece using KL divergence.</span>
<span class="sd">    Implement following: https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.jensenshannon.html</span>

<span class="sd">    Args:</span>
<span class="sd">        p (jnp.ndarray): The left PDF</span>
<span class="sd">        q (jnp.ndarray): The right PDF</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute pointwise mean of p and q</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">safe_kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">safe_kl_divergence</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.jensenshannon_divergence_from_pmf" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">jensenshannon_divergence_from_pmf</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">jensenshannon_divergence_from_pmf</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the Jensen-Shannon Divergence from PMF</p>
<p>Example
<div class="highlight"><pre><span></span><code><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">key_1</span><span class="p">,</span> <span class="n">key_2</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="n">sample_1</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key_1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="p">))</span>
<span class="n">sample_2</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key_2</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="p">))</span>

<span class="c1"># Determine srange from sample</span>
<span class="n">merged_sample</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">sample_2</span><span class="p">])</span>
<span class="n">srange</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">merged_sample</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">merged_sample</span><span class="p">)</span>

<span class="c1"># https://stats.stackexchange.com/questions/510699/discrete-kl-divergence-with-decreasing-bin-width</span>
<span class="c1"># Recommend this book: https://catalog.lib.uchicago.edu/vufind/Record/6093380/TOC</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sample_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="c1"># bins = 10</span>
<span class="n">dis_1</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_pdf</span><span class="p">(</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="n">srange</span><span class="p">)</span>
<span class="n">dis_2</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_pdf</span><span class="p">(</span><span class="n">sample_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="n">srange</span><span class="p">)</span>

<span class="n">jsd</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">jensenshannon_divergence_from_pdf</span><span class="p">(</span><span class="n">dis_1</span><span class="p">,</span> <span class="n">dis_2</span><span class="p">)</span>
</code></pre></div></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 1st probability mass function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 1st probability mass function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The Jensen-Shannon Divergence of p and q</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">jensenshannon_divergence_from_pmf</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the Jensen-Shannon Divergence from PMF</span>

<span class="sd">    Example</span>
<span class="sd">    ```python</span>
<span class="sd">    key = jax.random.key(0)</span>
<span class="sd">    key_1, key_2 = jax.random.split(key)</span>
<span class="sd">    sample_1 = jax.random.normal(key_1, shape=(10000, ))</span>
<span class="sd">    sample_2 = jax.random.normal(key_2, shape=(10000, ))</span>

<span class="sd">    # Determine srange from sample</span>
<span class="sd">    merged_sample = jnp.concat([sample_1, sample_2])</span>
<span class="sd">    srange = jnp.min(merged_sample), jnp.max(merged_sample)</span>

<span class="sd">    # https://stats.stackexchange.com/questions/510699/discrete-kl-divergence-with-decreasing-bin-width</span>
<span class="sd">    # Recommend this book: https://catalog.lib.uchicago.edu/vufind/Record/6093380/TOC</span>
<span class="sd">    bins = int(2 * (sample_2.shape[0]) ** (1/3))</span>
<span class="sd">    # bins = 10</span>
<span class="sd">    dis_1 = sq.probabilistic.make_pdf(sample_1, bins=bins, srange=srange)</span>
<span class="sd">    dis_2 = sq.probabilistic.make_pdf(sample_2, bins=bins, srange=srange)</span>

<span class="sd">    jsd = sq.probabilistic.jensenshannon_divergence_from_pdf(dis_1, dis_2)</span>

<span class="sd">    ```</span>

<span class="sd">    Args:</span>
<span class="sd">        p (jnp.ndarray): The 1st probability mass function</span>
<span class="sd">        q (jnp.ndarray): The 1st probability mass function</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The Jensen-Shannon Divergence of p and q</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Note for JSD: https://medium.com/data-science/how-to-understand-and-use-jensen-shannon-divergence-b10e11b03fd6</span>
    <span class="c1"># Implement following: https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.jensenshannon.html</span>
    <span class="c1"># Compute pointwise mean of p and q</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">kl_divergence</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.jensenshannon_divergence_from_sample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">jensenshannon_divergence_from_sample</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">jensenshannon_divergence_from_sample</span><span class="p">(</span>
    <span class="n">sample_1</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">sample_2</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the Jensen-Shannon Divergence from sample</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sample_1</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The left PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_2</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The right PDF</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The Jensen-Shannon Divergence of p and q</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">jensenshannon_divergence_from_sample</span><span class="p">(</span>
    <span class="n">sample_1</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">sample_2</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the Jensen-Shannon Divergence from sample</span>

<span class="sd">    Args:</span>
<span class="sd">        sample_1 (jnp.ndarray): The left PDF</span>
<span class="sd">        sample_2 (jnp.ndarray): The right PDF</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The Jensen-Shannon Divergence of p and q</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">merged_sample</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">sample_2</span><span class="p">])</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sample_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">srange</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">merged_sample</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">merged_sample</span><span class="p">)</span>

    <span class="n">dis_1</span> <span class="o">=</span> <span class="n">make_pdf</span><span class="p">(</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="n">srange</span><span class="p">)</span>
    <span class="n">dis_2</span> <span class="o">=</span> <span class="n">make_pdf</span><span class="p">(</span><span class="n">sample_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">srange</span><span class="o">=</span><span class="n">srange</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jensenshannon_divergence_from_pmf</span><span class="p">(</span><span class="n">dis_1</span><span class="p">,</span> <span class="n">dis_2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.batched_matmul" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">batched_matmul</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">batched_matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A specialized batched matrix multiplication of weight and input x, then add the bias.
This function is intended to be used in <code>dense_layer</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input x</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weight to multiply to x</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The bias</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Output of the operations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">batched_matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A specialized batched matrix multiplication of weight and input x, then add the bias.</span>
<span class="sd">    This function is intended to be used in `dense_layer`</span>

<span class="sd">    Args:</span>
<span class="sd">        x (jnp.ndarray): The input x</span>
<span class="sd">        w (jnp.ndarray): The weight to multiply to x</span>
<span class="sd">        b (jnp.ndarray): The bias</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Output of the operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">w</span><span class="p">,</span> <span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">b</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.get_trace" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_trace</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_trace</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n"><span title="jax.random.key">key</span></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convinent function to get a trace of the probabilistic model in numpyro.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fn</code>
            </td>
            <td>
                  <code><span title="function">function</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probabilistic model in numpyro.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random key. Defaults to jax.random.key(0).</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.random.key">key</span>(0)</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_trace</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convinent function to get a trace of the probabilistic model in numpyro.</span>

<span class="sd">    Args:</span>
<span class="sd">        fn (function): The probabilistic model in numpyro.</span>
<span class="sd">        key (jnp.ndarray, optional): The random key. Defaults to jax.random.key(0).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">inner</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.default_priors_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">default_priors_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">default_priors_fn</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpyro.distributions.Distribution">Distribution</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This is a default prior function for the <code>dense_layer</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The site name of the parameters, if end with <code>sigma</code> will return Log Normal distribution,
              otherwise, return Normal distribution</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpyro.distributions.Distribution">Distribution</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">default_priors_fn</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is a default prior function for the `dense_layer`</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): The site name of the parameters, if end with `sigma` will return Log Normal distribution,</span>
<span class="sd">                          otherwise, return Normal distribution</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;bias&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.dense_layer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">dense_layer</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">dense_layer</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span>
    <span class="n">in_features</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">out_features</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">priors_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n"><span title="numpyro.distributions.Distribution">Distribution</span></span>
    <span class="p">]</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            default_priors_fn (src.inspeqtor.v1.probabilistic.default_priors_fn)" href="#src.inspeqtor.v1.probabilistic.default_priors_fn">default_priors_fn</a></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>A custom probabilistic dense layer for neural network model.
This function intended to be used with <code>numpyro</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input x</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Site name of the layer</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>in_features</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the feature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out_features</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired size of the output feature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>priors_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="str">str</span>], <span title="numpyro.distributions.Distribution">Distribution</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prior function to be used for initializing prior distribution. Defaults to default_priors_fn.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            default_priors_fn (src.inspeqtor.v1.probabilistic.default_priors_fn)" href="#src.inspeqtor.v1.probabilistic.default_priors_fn">default_priors_fn</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: Output of the layer given x.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dense_layer</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">in_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">out_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">priors_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span>
        <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n">dist</span><span class="o">.</span><span class="n">Distribution</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">default_priors_fn</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A custom probabilistic dense layer for neural network model.</span>
<span class="sd">    This function intended to be used with `numpyro`</span>

<span class="sd">    Args:</span>
<span class="sd">        x (jnp.ndarray): The input x</span>
<span class="sd">        name (str): Site name of the layer</span>
<span class="sd">        in_features (int): The size of the feature.</span>
<span class="sd">        out_features (int): The desired size of the output feature.</span>
<span class="sd">        priors_fn (typing.Callable[[str], dist.Distribution], optional): The prior function to be used for initializing prior distribution. Defaults to default_priors_fn.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: Output of the layer given x.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">w_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.kernel&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="n">w_name</span><span class="p">,</span>
        <span class="n">priors_fn</span><span class="p">(</span><span class="n">w_name</span><span class="p">,</span> <span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">))</span><span class="o">.</span><span class="n">to_event</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
    <span class="p">)</span>
    <span class="n">b_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.bias&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="n">b_name</span><span class="p">,</span>
        <span class="n">priors_fn</span><span class="p">(</span><span class="n">b_name</span><span class="p">,</span> <span class="p">(</span><span class="n">out_features</span><span class="p">,))</span><span class="o">.</span><span class="n">to_event</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">batched_matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.init_default" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">init_default</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">init_default</span><span class="p">(</span><span class="n">params_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The initialization function for deterministic dense layer</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The site name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unsupport site name</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: The function to be used for parameters init given site name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">init_default</span><span class="p">(</span><span class="n">params_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The initialization function for deterministic dense layer</span>

<span class="sd">    Args:</span>
<span class="sd">        params_name (str): The site name</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Unsupport site name</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: The function to be used for parameters init given site name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">params_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;kernel&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span>
    <span class="k">elif</span> <span class="n">params_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;bias&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupport param name&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.dense_deterministic_layer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">dense_deterministic_layer</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">dense_deterministic_layer</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span>
    <span class="n">in_features</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">out_features</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">batch_shape</span><span class="p">:</span> <span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">init_fn</span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            init_default (src.inspeqtor.v1.probabilistic.init_default)" href="#src.inspeqtor.v1.probabilistic.init_default">init_default</a></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The deterministic dense layer, to be used with SVI optimizer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input feature</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The site name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>in_features</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the input features</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out_features</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired size of the output features.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The batch size of the x. Defaults to ().</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initilization function of the model parameters. Defaults to init_default.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            init_default (src.inspeqtor.v1.probabilistic.init_default)" href="#src.inspeqtor.v1.probabilistic.init_default">init_default</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: The output of the layer given x.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dense_deterministic_layer</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">in_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">out_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">batch_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">init_fn</span><span class="o">=</span><span class="n">init_default</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The deterministic dense layer, to be used with SVI optimizer.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (typing.Any): The input feature</span>
<span class="sd">        name (str): The site name</span>
<span class="sd">        in_features (int): The size of the input features</span>
<span class="sd">        out_features (int): The desired size of the output features.</span>
<span class="sd">        batch_shape (tuple[int, ...], optional): The batch size of the x. Defaults to ().</span>
<span class="sd">        init_fn (typing.Any, optional): Initilization function of the model parameters. Defaults to init_default.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: The output of the layer given x.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Sample weights - shape (in_features, out_features)</span>
    <span class="n">weight_shape</span> <span class="o">=</span> <span class="n">batch_shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">)</span>
    <span class="n">W_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.kernel&quot;</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
        <span class="n">W_name</span><span class="p">,</span>
        <span class="n">init_fn</span><span class="p">(</span><span class="n">W_name</span><span class="p">)(</span><span class="n">shape</span><span class="o">=</span><span class="n">weight_shape</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
    <span class="p">)</span>

    <span class="c1"># Sample bias - shape (out_features,)</span>
    <span class="n">bias_shape</span> <span class="o">=</span> <span class="n">batch_shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">out_features</span><span class="p">,)</span>
    <span class="n">b_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.bias&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">b_name</span><span class="p">,</span> <span class="n">init_fn</span><span class="p">(</span><span class="n">b_name</span><span class="p">)(</span><span class="n">shape</span><span class="o">=</span><span class="n">bias_shape</span><span class="p">))</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">batched_matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_posteriors_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_posteriors_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_posteriors_fn</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10000</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make the posterior distribution function that will
return the posterior of parameter of the given name, from guide and parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>guide</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The guide function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The parameters of the guide</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_samples</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sample size. Defaults to 10000.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: A function of parameter name that return the sample from the posterior distribution of the parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_posteriors_fn</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make the posterior distribution function that will</span>
<span class="sd">    return the posterior of parameter of the given name, from guide and parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        guide (typing.Any): The guide function</span>
<span class="sd">        params (typing.Any): The parameters of the guide</span>
<span class="sd">        num_samples (int, optional): The sample size. Defaults to 10000.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: A function of parameter name that return the sample from the posterior distribution of the parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">posterior_distribution</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span>
    <span class="p">)(</span><span class="n">key</span><span class="p">)</span>

    <span class="n">posterior_dict</span> <span class="o">=</span> <span class="n">construct_normal_prior_from_samples</span><span class="p">(</span><span class="n">posterior_distribution</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posteriors_fn</span><span class="p">(</span><span class="n">param_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">posterior_dict</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">posteriors_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.auto_diagonal_normal_guide" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">auto_diagonal_normal_guide</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">auto_diagonal_normal_guide</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">block_sample</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">init_loc_fn</span><span class="o">=</span><span class="n"><span title="jax.numpy.zeros">zeros</span></span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="n"><span title="jax.random.key">key</span></span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Automatically generate guide from given model. Expected to be initialized with the example input of the model.
The given input should also including the observed site.
The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.
This is the avoid site name duplication, while allows for model to use newly sample from the guide.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probabilistic model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>block_sample</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to block the sample site. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_loc_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initialization of guide parameters function. Defaults to jnp.zeros.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.zeros">zeros</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">auto_diagonal_normal_guide</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">block_sample</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">init_loc_fn</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatically generate guide from given model. Expected to be initialized with the example input of the model.</span>
<span class="sd">    The given input should also including the observed site.</span>
<span class="sd">    The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.</span>
<span class="sd">    This is the avoid site name duplication, while allows for model to use newly sample from the guide.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Any): The probabilistic model.</span>
<span class="sd">        block_sample (bool, optional): Flag to block the sample site. Defaults to False.</span>
<span class="sd">        init_loc_fn (typing.Any, optional): Initialization of guide parameters function. Defaults to jnp.zeros.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="c1"># get the trace of the model</span>
    <span class="c1"># Then get only the sample site with observed equal to false</span>
    <span class="n">sample_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model_trace</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sample&quot;</span><span class="p">]</span>
    <span class="n">non_observed_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sample_sites</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;is_observed&quot;</span><span class="p">]]</span>
    <span class="n">params_sites</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">}</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">non_observed_sites</span>
    <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">guide</span><span class="p">(</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">params_loc</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_loc&quot;</span><span class="p">,</span> <span class="n">init_loc_fn</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="n">params_scale</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_scale&quot;</span><span class="p">,</span>
                <span class="mf">0.1</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">]),</span>
                <span class="n">constraint</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">softplus_positive</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="n">samples</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">block_sample</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">handlers</span><span class="o">.</span><span class="n">block</span><span class="p">():</span>
                <span class="c1"># Sample from Normal distribution</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">k_loc</span><span class="p">,</span> <span class="n">v_loc</span><span class="p">),</span> <span class="p">(</span><span class="n">k_scale</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">params_loc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">params_scale</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">):</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                        <span class="n">k_loc</span><span class="p">,</span>
                        <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">v_loc</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span><span class="o">.</span><span class="n">to_event</span><span class="p">(),</span>  <span class="c1"># type: ignore</span>
                    <span class="p">)</span>
                    <span class="n">samples</span><span class="p">[</span><span class="n">k_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Sample from Normal distribution</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">k_loc</span><span class="p">,</span> <span class="n">v_loc</span><span class="p">),</span> <span class="p">(</span><span class="n">k_scale</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">params_loc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">params_scale</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">):</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                    <span class="n">k_loc</span><span class="p">,</span>
                    <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">v_loc</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span><span class="o">.</span><span class="n">to_event</span><span class="p">(),</span>  <span class="c1"># type: ignore</span>
                <span class="p">)</span>
                <span class="n">samples</span><span class="p">[</span><span class="n">k_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">return</span> <span class="n">guide</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.auto_diagonal_normal_guide_v2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">auto_diagonal_normal_guide_v2</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">auto_diagonal_normal_guide_v2</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">init_dist_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.v1.probabilistic.init_normal_dist_fn">init_normal_dist_fn</span></span><span class="p">,</span>
    <span class="n">init_params_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.v1.probabilistic.init_params_fn">init_params_fn</span></span><span class="p">,</span>
    <span class="n">block_sample</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="n"><span title="jax.random.key">key</span></span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Automatically generate guide from given model. Expected to be initialized with the example input of the model.
The given input should also including the observed site.
The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.
This is the avoid site name duplication, while allows for model to use newly sample from the guide.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probabilistic model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>block_sample</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to block the sample site. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_loc_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initialization of guide parameters function. Defaults to jnp.zeros.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">auto_diagonal_normal_guide_v2</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">init_dist_fn</span><span class="o">=</span><span class="n">init_normal_dist_fn</span><span class="p">,</span>
    <span class="n">init_params_fn</span><span class="o">=</span><span class="n">init_params_fn</span><span class="p">,</span>
    <span class="n">block_sample</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatically generate guide from given model. Expected to be initialized with the example input of the model.</span>
<span class="sd">    The given input should also including the observed site.</span>
<span class="sd">    The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.</span>
<span class="sd">    This is the avoid site name duplication, while allows for model to use newly sample from the guide.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Any): The probabilistic model.</span>
<span class="sd">        block_sample (bool, optional): Flag to block the sample site. Defaults to False.</span>
<span class="sd">        init_loc_fn (typing.Any, optional): Initialization of guide parameters function. Defaults to jnp.zeros.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the trace of the model</span>
    <span class="n">model_trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="c1"># Then get only the sample site with observed equal to false</span>
    <span class="n">sample_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model_trace</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sample&quot;</span><span class="p">]</span>
    <span class="n">non_observed_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sample_sites</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;is_observed&quot;</span><span class="p">]]</span>
    <span class="n">params_sites</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">}</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">non_observed_sites</span>
    <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_fn</span><span class="p">(</span>
        <span class="n">params_loc</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">params_scale</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Sample from Normal distribution</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k_loc</span><span class="p">,</span> <span class="n">v_loc</span><span class="p">),</span> <span class="p">(</span><span class="n">k_scale</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">params_loc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">params_scale</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                <span class="n">k_loc</span><span class="p">,</span>
                <span class="n">init_dist_fn</span><span class="p">(</span><span class="n">k_loc</span><span class="p">)(</span><span class="n">v_loc</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span><span class="o">.</span><span class="n">to_event</span><span class="p">(),</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
            <span class="n">samples</span><span class="p">[</span><span class="n">k_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">guide</span><span class="p">(</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">params_loc</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">init_params_fn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_loc&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="n">params_scale</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">init_params_fn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_scale&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">block_sample</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">handlers</span><span class="o">.</span><span class="n">block</span><span class="p">():</span>
                <span class="n">samples</span> <span class="o">=</span> <span class="n">sample_fn</span><span class="p">(</span><span class="n">params_loc</span><span class="p">,</span> <span class="n">params_scale</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="n">sample_fn</span><span class="p">(</span><span class="n">params_loc</span><span class="p">,</span> <span class="n">params_scale</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">return</span> <span class="n">guide</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_predictive_fn_v2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_predictive_fn_v2</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_predictive_fn_v2</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">shots</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make a postirior predictive model function from model, guide, SVI parameters, and the number of shots.
This version relied explicitly on the guide and variational parameters. It might be slow than the first version.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Probabilistic model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>guide</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Gudie corresponded to the model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SVI parameters of the guide</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shots</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shots</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: The posterior predictive model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_predictive_fn_v2</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">guide</span><span class="p">,</span>
    <span class="n">params</span><span class="p">,</span>
    <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a postirior predictive model function from model, guide, SVI parameters, and the number of shots.</span>
<span class="sd">    This version relied explicitly on the guide and variational parameters. It might be slow than the first version.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Any): Probabilistic model.</span>
<span class="sd">        guide (typing.Any): Gudie corresponded to the model</span>
<span class="sd">        params (typing.Any): SVI parameters of the guide</span>
<span class="sd">        shots (int): The number of shots</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: The posterior predictive model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">predictive</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">guide</span><span class="o">=</span><span class="n">guide</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">return_sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predictive_fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">predictive</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s2">&quot;obs&quot;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">predictive_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_predictive_SGM_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_predictive_SGM_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_predictive_SGM_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n"><span title="flax.linen.Module">Module</span></span><span class="p">,</span>
    <span class="n">model_params</span><span class="p">,</span>
    <span class="n">output_to_expectation_values_fn</span><span class="p">,</span>
    <span class="n">shots</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make a predictive model from given SGM model, the model parameters, and number of shots.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flax model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_params</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shots</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shots.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_predictive_SGM_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">model_params</span><span class="p">,</span> <span class="n">output_to_expectation_values_fn</span><span class="p">,</span> <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a predictive model from given SGM model, the model parameters, and number of shots.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (nn.Module): Flax model</span>
<span class="sd">        model_params (typing.Any): The model parameters.</span>
<span class="sd">        shots (int): The number of shots.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predictive_model</span><span class="p">(</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">control_param</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">control_param</span><span class="p">)</span>
        <span class="n">predicted_expvals</span> <span class="o">=</span> <span class="n">output_to_expectation_values_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">binary_to_eigenvalue</span><span class="p">(</span>
            <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))(</span>
                <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shots</span><span class="p">),</span>
                <span class="n">expectation_value_to_prob_minus</span><span class="p">(</span><span class="n">predicted_expvals</span><span class="p">),</span>
            <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictive_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_predictive_MCDGM_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_predictive_MCDGM_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_predictive_MCDGM_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n"><span title="flax.linen.Module">Module</span></span><span class="p">,</span> <span class="n">model_params</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make a predictive model from given Monte-Carlo Dropout Graybox model, and the model parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="flax.linen.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Monte-Carlo Dropout Graybox model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_params</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_predictive_MCDGM_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">model_params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a predictive model from given Monte-Carlo Dropout Graybox model, and the model parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (nn.Module): Monte-Carlo Dropout Graybox model</span>
<span class="sd">        model_params (typing.Any): The model parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predictive_model</span><span class="p">(</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">control_param</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">):</span>
        <span class="n">wo_params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="n">model_params</span><span class="p">,</span>
            <span class="n">control_param</span><span class="p">,</span>
            <span class="n">rngs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;dropout&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">},</span>
        <span class="p">)</span>

        <span class="n">predicted_expvals</span> <span class="o">=</span> <span class="n">get_predict_expectation_value</span><span class="p">(</span>
            <span class="n">wo_params</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
            <span class="n">unitaries</span><span class="p">,</span>
            <span class="n">default_expectation_values_order</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">predicted_expvals</span>

    <span class="k">return</span> <span class="n">predictive_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_predictive_resampling_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_predictive_resampling_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_predictive_resampling_model</span><span class="p">(</span>
    <span class="n">predictive_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
    <span class="n">shots</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make a binary predictive model from given SGM model, the model parameters, and number of shots.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predictive_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The predictive_fn embeded with the SGM model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shots</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shots.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable[[jnp.ndarray, jnp.ndarray, jnp.ndarray], jnp.ndarray]: Binary predictive model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_predictive_resampling_model</span><span class="p">(</span>
    <span class="n">predictive_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a binary predictive model from given SGM model, the model parameters, and number of shots.</span>

<span class="sd">    Args:</span>
<span class="sd">        predictive_fn (typing.Callable[[jnp.ndarray, jnp.ndarray], jnp.ndarray]): The predictive_fn embeded with the SGM model.</span>
<span class="sd">        shots (int): The number of shots.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable[[jnp.ndarray, jnp.ndarray, jnp.ndarray], jnp.ndarray]: Binary predictive model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predictive_model</span><span class="p">(</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">):</span>
        <span class="n">predicted_expvals</span> <span class="o">=</span> <span class="n">predictive_fn</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">binary_to_eigenvalue</span><span class="p">(</span>
            <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))(</span>
                <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shots</span><span class="p">),</span>
                <span class="n">expectation_value_to_prob_minus</span><span class="p">(</span><span class="n">predicted_expvals</span><span class="p">),</span>
            <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictive_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_probabilistic_graybox_model" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_probabilistic_graybox_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_probabilistic_graybox_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">adapter_fn</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This function make a probabilistic graybox model using custom numpyro BNN model</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="_type_">_type_</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>adapter_fn</code>
            </td>
            <td>
                  <code><span title="_type_">_type_</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_probabilistic_graybox_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">adapter_fn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function make a probabilistic graybox model using custom numpyro BNN model</span>

<span class="sd">    Args:</span>
<span class="sd">        model (_type_): _description_</span>
<span class="sd">        adapter_fn (_type_): _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">probabilistic_graybox_model</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">):</span>
        <span class="n">samples_shape</span> <span class="o">=</span> <span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">unitaries</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">unitaries</span><span class="p">,</span> <span class="n">samples_shape</span> <span class="o">+</span> <span class="n">unitaries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span>

        <span class="c1"># Predict from control parameters</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">control_parameters</span><span class="p">)</span>

        <span class="n">numpyro</span><span class="o">.</span><span class="n">deterministic</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

        <span class="c1"># With unitary and Wo, calculate expectation values</span>
        <span class="n">expvals</span> <span class="o">=</span> <span class="n">adapter_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">unitaries</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">expvals</span>

    <span class="k">return</span> <span class="n">probabilistic_graybox_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.auto_diagonal_normal_guide_v3" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">auto_diagonal_normal_guide_v3</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">auto_diagonal_normal_guide_v3</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">init_dist_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.v1.probabilistic.bnn_init_dist_fn">bnn_init_dist_fn</span></span><span class="p">,</span>
    <span class="n">init_params_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.v1.probabilistic.bnn_init_params_fn">bnn_init_params_fn</span></span><span class="p">,</span>
    <span class="n">dist_transform_fn</span><span class="o">=</span><span class="n"><span title="src.inspeqtor.v1.probabilistic.default_transform_dist_fn">default_transform_dist_fn</span></span><span class="p">,</span>
    <span class="n">block_sample</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="n"><span title="jax.random.key">key</span></span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Automatically generate guide from given model. Expected to be initialized with the example input of the model.
The given input should also including the observed site.
The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.
This is the avoid site name duplication, while allows for model to use newly sample from the guide.</p>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This version enable even more flexible initialization strategy.
This function intended to be able to be compatible with auto marginal guide.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probabilistic model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>block_sample</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to block the sample site. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_loc_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initialization of guide parameters function. Defaults to jnp.zeros.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">auto_diagonal_normal_guide_v3</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">init_dist_fn</span><span class="o">=</span><span class="n">bnn_init_dist_fn</span><span class="p">,</span>
    <span class="n">init_params_fn</span><span class="o">=</span><span class="n">bnn_init_params_fn</span><span class="p">,</span>
    <span class="n">dist_transform_fn</span><span class="o">=</span><span class="n">default_transform_dist_fn</span><span class="p">,</span>
    <span class="n">block_sample</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatically generate guide from given model. Expected to be initialized with the example input of the model.</span>
<span class="sd">    The given input should also including the observed site.</span>
<span class="sd">    The blocking capability is intended to be used in the when the guide will be used with its corresponding model in anothe model.</span>
<span class="sd">    This is the avoid site name duplication, while allows for model to use newly sample from the guide.</span>

<span class="sd">    Notes:</span>
<span class="sd">        This version enable even more flexible initialization strategy.</span>
<span class="sd">        This function intended to be able to be compatible with auto marginal guide.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (typing.Any): The probabilistic model.</span>
<span class="sd">        block_sample (bool, optional): Flag to block the sample site. Defaults to False.</span>
<span class="sd">        init_loc_fn (typing.Any, optional): Initialization of guide parameters function. Defaults to jnp.zeros.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the trace of the model</span>
    <span class="n">model_trace</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="c1"># Then get only the sample site with observed equal to false</span>
    <span class="n">sample_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model_trace</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sample&quot;</span><span class="p">]</span>
    <span class="n">non_observed_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sample_sites</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;is_observed&quot;</span><span class="p">]]</span>
    <span class="n">params_sites</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">}</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">non_observed_sites</span>
    <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_fn</span><span class="p">(</span>
        <span class="n">params_loc</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">params_scale</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Sample from Normal distribution</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k_loc</span><span class="p">,</span> <span class="n">v_loc</span><span class="p">),</span> <span class="p">(</span><span class="n">k_scale</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">params_loc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">params_scale</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                <span class="n">k_loc</span><span class="p">,</span>
                <span class="n">dist_transform_fn</span><span class="p">(</span><span class="n">k_loc</span><span class="p">,</span> <span class="n">init_dist_fn</span><span class="p">(</span><span class="n">k_loc</span><span class="p">)(</span><span class="n">v_loc</span><span class="p">,</span> <span class="n">v_scale</span><span class="p">)),</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
            <span class="n">samples</span><span class="p">[</span><span class="n">k_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">guide</span><span class="p">(</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">params_loc</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">init_params_fn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_loc&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="n">params_scale</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">init_params_fn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_scale&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_sites</span>
        <span class="p">}</span>

        <span class="k">with</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">optional</span><span class="p">(</span><span class="n">block_sample</span><span class="p">,</span> <span class="n">handlers</span><span class="o">.</span><span class="n">block</span><span class="p">()):</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="n">sample_fn</span><span class="p">(</span><span class="n">params_loc</span><span class="p">,</span> <span class="n">params_scale</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">return</span> <span class="n">guide</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.probabilistic.make_posterior_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">make_posterior_fn</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_posterior_fn</span><span class="p">(</span>
    <span class="n">params</span><span class="p">,</span> <span class="n">get_dist_fn</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="str">str</span></span><span class="p">],</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This function create a posterior function to make a posterior predictive model</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="n">posterior_model</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">probabilistic</span><span class="o">.</span><span class="n">make_probabilistic_model</span><span class="p">(</span>
    <span class="n">predictive_model</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span>
            <span class="n">probabilistic_graybox_model</span><span class="p">,</span>
            <span class="n">priors_fn</span><span class="o">=</span><span class="n">make_posterior_fn</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">init_bnn_dist_fn</span><span class="p">),</span>
        <span class="p">),</span>
    <span class="n">log_expectation_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="_type_">_type_</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The variational parameters from SVI</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>get_dist_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="str">str</span>], <span title="numpyro.distributions.Distribution">Distribution</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function that return function given name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/probabilistic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_posterior_fn</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">get_dist_fn</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function create a posterior function to make a posterior predictive model</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        posterior_model = sq.probabilistic.make_probabilistic_model(</span>
<span class="sd">            predictive_model=partial(</span>
<span class="sd">                    probabilistic_graybox_model,</span>
<span class="sd">                    priors_fn=make_posterior_fn(result.params, init_bnn_dist_fn),</span>
<span class="sd">                ),</span>
<span class="sd">            log_expectation_values=True,</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        params (_type_): The variational parameters from SVI</span>
<span class="sd">        get_dist_fn (typing.Callable[[str], dist.Distribution]): The function that return function given name</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">posterior_fn</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]):</span>
        <span class="k">return</span> <span class="n">get_dist_fn</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">params</span><span class="p">[</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_loc&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_scale&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">posterior_fn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="utilities">Utilities</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.utils" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.utils</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.center_location" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">center_location</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">center_location</span><span class="p">(</span>
    <span class="n">num_of_pulse</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="n">total_time_dt</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="n"><span title="float">float</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create an array of location equally that centered each pulse.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num_of_pulse</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of the pulse in the sequence to be equally center.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total_time_dt</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total bins of the sequence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The array of location equally that centered each pulse.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">center_location</span><span class="p">(</span><span class="n">num_of_pulse</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">total_time_dt</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an array of location equally that centered each pulse.</span>

<span class="sd">    Args:</span>
<span class="sd">        num_of_pulse (int): The number of the pulse in the sequence to be equally center.</span>
<span class="sd">        total_time_dt (int | float): The total bins of the sequence.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The array of location equally that centered each pulse.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">center_locations</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">k</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_of_pulse</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_of_pulse</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
        <span class="o">*</span> <span class="n">total_time_dt</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">center_locations</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.drag_envelope_v2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">drag_envelope_v2</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">drag_envelope_v2</span><span class="p">(</span>
    <span class="n">amp</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">sigma</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">beta</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">center</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">final_amp</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Drag pulse following: https://docs.quantum.ibm.com/api/qiskit/qiskit.pulse.library.Drag_class.rst#drag</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>amp</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The amplitude of the pulse</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sigma</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The standard deviation of the pulse</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beta</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DRAG coefficient.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Center location of the pulse</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>final_amp</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Final amplitude of the control. Defaults to 1.0.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable: DRAG envelope function</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">drag_envelope_v2</span><span class="p">(</span>
    <span class="n">amp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">center</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">final_amp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Drag pulse following: https://docs.quantum.ibm.com/api/qiskit/qiskit.pulse.library.Drag_class.rst#drag</span>

<span class="sd">    Args:</span>
<span class="sd">        amp (float | jnp.ndarray): The amplitude of the pulse</span>
<span class="sd">        sigma (float | jnp.ndarray): The standard deviation of the pulse</span>
<span class="sd">        beta (float | jnp.ndarray): DRAG coefficient.</span>
<span class="sd">        center (float | jnp.ndarray): Center location of the pulse</span>
<span class="sd">        final_amp (float | jnp.ndarray, optional): Final amplitude of the control. Defaults to 1.0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable: DRAG envelope function</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">g</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">g_prime</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">amp</span> <span class="o">*</span> <span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">g</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">g</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">envelop</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">final_amp</span> <span class="o">*</span> <span class="n">g_prime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">envelop</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.detune_hamiltonian" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">detune_hamiltonian</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">detune_hamiltonian</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[</span>
        <span class="p">[</span><span class="n"><span title="inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
    <span class="p">],</span>
    <span class="n">detune</span><span class="p">:</span> <span class="n"><span title="float">float</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Detune the Hamiltonian in Z-axis with detuning coefficient</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hamiltonian</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hamiltonian function to be detuned</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>detune</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Detuning coefficient</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="inspeqtor.v1.physics.HamiltonianArgs">HamiltonianArgs</span>, <span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Callable: Detuned Hamiltonian.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@warn_not_tested_function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">detune_hamiltonian</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">detune</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">HamiltonianArgs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Detune the Hamiltonian in Z-axis with detuning coefficient</span>

<span class="sd">    Args:</span>
<span class="sd">        hamiltonian (typing.Callable[[HamiltonianArgs, jnp.ndarray], jnp.ndarray]): Hamiltonian function to be detuned</span>
<span class="sd">        detune (float): Detuning coefficient</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Callable: Detuned Hamiltonian.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detuned_hamiltonian</span><span class="p">(</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">HamiltonianArgs</span><span class="p">,</span>
        <span class="n">t</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hamiltonian</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">+</span> <span class="n">detune</span> <span class="o">*</span> <span class="n">Z</span>

    <span class="k">return</span> <span class="n">detuned_hamiltonian</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.prepare_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">prepare_data</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prepare_data</span><span class="p">(</span>
    <span class="n">exp_data</span><span class="p">:</span> <span class="n"><span title="inspeqtor.v1.data.ExperimentData">ExperimentData</span></span><span class="p">,</span>
    <span class="n">control_sequence</span><span class="p">:</span> <span class="n"><span title="inspeqtor.v1.control.ControlSequence">ControlSequence</span></span><span class="p">,</span>
    <span class="n">whitebox</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="src.inspeqtor.v1.utils.LoadedData">LoadedData</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prepare the data for easy accessing from experiment data, control sequence, and Whitebox.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exp_data</code>
            </td>
            <td>
                  <code><span title="inspeqtor.v1.data.ExperimentData">ExperimentData</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>ExperimentData</code> instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control_sequence</code>
            </td>
            <td>
                  <code><span title="inspeqtor.v1.control.ControlSequence">ControlSequence</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control sequence of the experiment</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>whitebox</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ideal unitary solver.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>LoadedData</code></td>            <td>
                  <code><span title="src.inspeqtor.v1.utils.LoadedData">LoadedData</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>LoadedData</code> instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_data</span><span class="p">(</span>
    <span class="n">exp_data</span><span class="p">:</span> <span class="n">ExperimentData</span><span class="p">,</span>
    <span class="n">control_sequence</span><span class="p">:</span> <span class="n">ControlSequence</span><span class="p">,</span>
    <span class="n">whitebox</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoadedData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare the data for easy accessing from experiment data, control sequence, and Whitebox.</span>

<span class="sd">    Args:</span>
<span class="sd">        exp_data (ExperimentData): `ExperimentData` instance</span>
<span class="sd">        control_sequence (ControlSequence): Control sequence of the experiment</span>
<span class="sd">        whitebox (typing.Callable): Ideal unitary solver.</span>

<span class="sd">    Returns:</span>
<span class="sd">        LoadedData: `LoadedData` instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded data from </span><span class="si">{</span><span class="n">exp_data</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">EXPERIMENT_IDENTIFIER</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">control_parameters</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp_data</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
    <span class="c1"># * Attempt to reshape the control_parameters to (size, features)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">control_parameters</span> <span class="o">=</span> <span class="n">control_parameters</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="n">expectation_values</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp_data</span><span class="o">.</span><span class="n">get_expectation_values</span><span class="p">())</span>
    <span class="n">unitaries</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">whitebox</span><span class="p">)(</span><span class="n">control_parameters</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Finished preparing the data for the experiment </span><span class="si">{</span><span class="n">exp_data</span><span class="o">.</span><span class="n">experiment_config</span><span class="o">.</span><span class="n">EXPERIMENT_IDENTIFIER</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">LoadedData</span><span class="p">(</span>
        <span class="n">experiment_data</span><span class="o">=</span><span class="n">exp_data</span><span class="p">,</span>
        <span class="n">control_parameters</span><span class="o">=</span><span class="n">control_parameters</span><span class="p">,</span>
        <span class="n">unitaries</span><span class="o">=</span><span class="n">unitaries</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
        <span class="n">observed_values</span><span class="o">=</span><span class="n">expectation_values</span><span class="p">,</span>
        <span class="n">control_sequence</span><span class="o">=</span><span class="n">control_sequence</span><span class="p">,</span>
        <span class="n">whitebox</span><span class="o">=</span><span class="n">whitebox</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.random_split" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">random_split</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">random_split</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">test_size</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span> <span class="o">*</span><span class="n">data_arrays</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The random_split function splits the data into training and testing sets.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">random_split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">x_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the test set. Must be less than the size of the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Sequence[jnp.ndarray]: The training and testing sets in the same order.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">random_split</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">test_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="n">data_arrays</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The random_split function splits the data into training and testing sets.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; key = jax.random.key(0)</span>
<span class="sd">        &gt;&gt;&gt; x = jnp.arange(10)</span>
<span class="sd">        &gt;&gt;&gt; y = jnp.arange(10)</span>
<span class="sd">        &gt;&gt;&gt; x_train, y_train, x_test, y_test = random_split(key, 2, x, y)</span>
<span class="sd">        &gt;&gt;&gt; assert x_train.shape[0] == 8 and y_train.shape[0] == 8</span>
<span class="sd">        &gt;&gt;&gt; assert x_test.shape[0] == 2 and y_test.shape[0] == 2</span>

<span class="sd">    Args:</span>
<span class="sd">        key (jnp.ndarray): Random key.</span>
<span class="sd">        test_size (int): The size of the test set. Must be less than the size of the data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Sequence[jnp.ndarray]: The training and testing sets in the same order.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># * General random split</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data_arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_arrays</span><span class="p">:</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">test_size</span><span class="p">:])</span>
        <span class="n">test_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">][:</span><span class="n">test_size</span><span class="p">])</span>

    <span class="k">return</span> <span class="p">(</span><span class="o">*</span><span class="n">train_data</span><span class="p">,</span> <span class="o">*</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.dataloader" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">dataloader</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">dataloader</span><span class="p">(</span>
    <span class="n">arrays</span><span class="p">:</span> <span class="n"><span title="typing.Sequence">Sequence</span></span><span class="p">[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The dataloader function creates a generator that yields batches of data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>arrays</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list or tuple of arrays to be batched.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the batch.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_epochs</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of epochs. If set to -1, the generator will run indefinitely.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>stop the generator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: (step, batch_idx, is_last_batch, epoch_idx), (array_batch, ...)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dataloader</span><span class="p">(</span>
    <span class="n">arrays</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The dataloader function creates a generator that yields batches of data.</span>

<span class="sd">    Args:</span>
<span class="sd">        arrays (typing.Sequence[jnp.ndarray]): The list or tuple of arrays to be batched.</span>
<span class="sd">        batch_size (int): The size of the batch.</span>
<span class="sd">        num_epochs (int): The number of epochs. If set to -1, the generator will run indefinitely.</span>
<span class="sd">        key (jnp.ndarray): The random key.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: stop the generator.</span>

<span class="sd">    Yields:</span>
<span class="sd">        typing.Any: (step, batch_idx, is_last_batch, epoch_idx), (array_batch, ...)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># * General dataloader</span>
    <span class="c1"># Check that all arrays have the same size in the first dimension</span>
    <span class="n">dataset_size</span> <span class="o">=</span> <span class="n">arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># assert all(array.shape[0] == dataset_size for array in arrays)</span>
    <span class="c1"># Generate random indices</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dataset_size</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">epoch_idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">epoch_idx</span> <span class="o">==</span> <span class="n">num_epochs</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
        <span class="p">(</span><span class="n">key</span><span class="p">,)</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">batch_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="n">is_last_batch</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">is_last_batch</span><span class="p">:</span>
            <span class="n">batch_perm</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
            <span class="c1"># Check if this is the last batch</span>
            <span class="n">is_last_batch</span> <span class="o">=</span> <span class="n">end</span> <span class="o">&gt;=</span> <span class="n">dataset_size</span>
            <span class="k">yield</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">is_last_batch</span><span class="p">,</span> <span class="n">epoch_idx</span><span class="p">),</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">batch_perm</span><span class="p">]</span> <span class="k">for</span> <span class="n">array</span> <span class="ow">in</span> <span class="n">arrays</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">end</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">batch_size</span>
            <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">batch_idx</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">epoch_idx</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.expectation_value_to_prob_plus" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">expectation_value_to_prob_plus</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">expectation_value_to_prob_plus</span><span class="p">(</span>
    <span class="n">expectation_value</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the probability of -1 and 1 for the given expectation value
E[O] = -1 * P[O = -1] + 1 * P[O = 1], where P[O = -1] + P[O = 1] = 1
Thus, E[O] = -1 * (1 - P[O = 1]) + 1 * P[O = 1]
E[O] = 2 * P[O = 1] - 1 -&gt; P[O = 1] = (E[O] + 1) / 2
Args:
    expectation_value (jnp.ndarray): Expectation value of quantum observable</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Probability of measuring plus eigenvector</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">expectation_value_to_prob_plus</span><span class="p">(</span><span class="n">expectation_value</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the probability of -1 and 1 for the given expectation value</span>
<span class="sd">    E[O] = -1 * P[O = -1] + 1 * P[O = 1], where P[O = -1] + P[O = 1] = 1</span>
<span class="sd">    Thus, E[O] = -1 * (1 - P[O = 1]) + 1 * P[O = 1]</span>
<span class="sd">    E[O] = 2 * P[O = 1] - 1 -&gt; P[O = 1] = (E[O] + 1) / 2</span>
<span class="sd">    Args:</span>
<span class="sd">        expectation_value (jnp.ndarray): Expectation value of quantum observable</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Probability of measuring plus eigenvector</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">expectation_value</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.expectation_value_to_prob_minus" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">expectation_value_to_prob_minus</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">expectation_value_to_prob_minus</span><span class="p">(</span>
    <span class="n">expectation_value</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert quantum observable expectation value to probability of measuring -1.</p>
<p>For a binary quantum observable <span class="arithmatex">\(\hat{O}\)</span> with eigenvalues <span class="arithmatex">\(b = \{-1, 1\}\)</span>, this function
calculates the probability of measuring the eigenvalue -1 given its expectation value.</p>
<p>Derivation:
$$
    \langle \hat{O} \rangle = -1 \cdot \Pr(b=-1) + 1 \cdot \Pr(b = 1)
$$
    With the constraint <span class="arithmatex">\(\Pr(b = -1) + \Pr(b = 1) = 1\)</span>:</p>
<div class="arithmatex">\[
    \langle \hat{O} \rangle = -1 \cdot \Pr(b=-1) + 1 \cdot (1 - \Pr(b=-1)) \
    \langle \hat{O} \rangle = -\Pr(b=-1) + 1 - \Pr(b=-1) \
    \langle \hat{O} \rangle = 1 - 2\Pr(b=-1) \
    \Pr(b=-1) = \frac{1 - \langle \hat{O} \rangle}{2}
\]</div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>expectation_value</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expectation value of the quantum observable,
must be in range [-1, 1].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Probability of measuring the -1 eigenvalue.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">expectation_value_to_prob_minus</span><span class="p">(</span><span class="n">expectation_value</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert quantum observable expectation value to probability of measuring -1.</span>

<span class="sd">    For a binary quantum observable $\\hat{O}$ with eigenvalues $b = \\{-1, 1\\}$, this function</span>
<span class="sd">    calculates the probability of measuring the eigenvalue -1 given its expectation value.</span>

<span class="sd">    Derivation:</span>
<span class="sd">    $$</span>
<span class="sd">        \\langle \\hat{O} \\rangle = -1 \\cdot \\Pr(b=-1) + 1 \\cdot \\Pr(b = 1)</span>
<span class="sd">    $$</span>
<span class="sd">        With the constraint $\\Pr(b = -1) + \\Pr(b = 1) = 1$:</span>

<span class="sd">    $$</span>
<span class="sd">        \\langle \\hat{O} \\rangle = -1 \\cdot \\Pr(b=-1) + 1 \\cdot (1 - \\Pr(b=-1)) \\</span>
<span class="sd">        \\langle \\hat{O} \\rangle = -\\Pr(b=-1) + 1 - \\Pr(b=-1) \\</span>
<span class="sd">        \\langle \\hat{O} \\rangle = 1 - 2\\Pr(b=-1) \\</span>
<span class="sd">        \\Pr(b=-1) = \\frac{1 - \\langle \\hat{O} \\rangle}{2}</span>
<span class="sd">    $$</span>

<span class="sd">    Args:</span>
<span class="sd">        expectation_value (jnp.ndarray): Expectation value of the quantum observable,</span>
<span class="sd">            must be in range [-1, 1].</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Probability of measuring the -1 eigenvalue.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">expectation_value</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.expectation_value_to_eigenvalue" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">expectation_value_to_eigenvalue</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">expectation_value_to_eigenvalue</span><span class="p">(</span>
    <span class="n">expectation_value</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="n">SHOTS</span><span class="p">:</span> <span class="n"><span title="int">int</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert expectation value to eigenvalue</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>expectation_value</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expectation value of quantum observable</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>SHOTS</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shots used to produce expectation value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Array of eigenvalues</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">expectation_value_to_eigenvalue</span><span class="p">(</span>
    <span class="n">expectation_value</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">SHOTS</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert expectation value to eigenvalue</span>

<span class="sd">    Args:</span>
<span class="sd">        expectation_value (jnp.ndarray): Expectation value of quantum observable</span>
<span class="sd">        SHOTS (int): The number of shots used to produce expectation value</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Array of eigenvalues</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">SHOTS</span><span class="p">),</span> <span class="n">expectation_value</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">SHOTS</span><span class="p">,))</span>
        <span class="o">&lt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">around</span><span class="p">(</span>
            <span class="n">expectation_value_to_prob_plus</span><span class="p">(</span>
                <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">expectation_value</span><span class="p">,</span> <span class="n">expectation_value</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">SHOTS</span>
        <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.eigenvalue_to_binary" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">eigenvalue_to_binary</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">eigenvalue_to_binary</span><span class="p">(</span><span class="n">eigenvalue</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert -1 to 1, and 0 to 1
This implementation should be differentiable</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>eigenvalue</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Eigenvalue to convert to bit value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Binary array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">eigenvalue_to_binary</span><span class="p">(</span><span class="n">eigenvalue</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert -1 to 1, and 0 to 1</span>
<span class="sd">    This implementation should be differentiable</span>

<span class="sd">    Args:</span>
<span class="sd">        eigenvalue (jnp.ndarray): Eigenvalue to convert to bit value</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Binary array</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">eigenvalue</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.binary_to_eigenvalue" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">binary_to_eigenvalue</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">binary_to_eigenvalue</span><span class="p">(</span><span class="n">binary</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert 1 to -1, and 0 to 1
This implementation should be differentiable</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>binary</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bit value to convert to eigenvalue</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Eigenvalue array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">binary_to_eigenvalue</span><span class="p">(</span><span class="n">binary</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert 1 to -1, and 0 to 1</span>
<span class="sd">    This implementation should be differentiable</span>

<span class="sd">    Args:</span>
<span class="sd">        binary (jnp.ndarray): Bit value to convert to eigenvalue</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Eigenvalue array</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">binary</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.recursive_vmap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">recursive_vmap</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">recursive_vmap</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">in_axes</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Perform recursive vmap on the given axis</p>


<details class="note" open>
  <summary>Note</summary>
  <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,)</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">x_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">recursive_vmap</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))(</span><span class="n">x_test</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</code></pre></div>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_test</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,)</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">recursive_vmap</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))(</span><span class="n">x_test</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">((2, 3, 4, 10), (2, 3, 4, 10))</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function for vmap</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>in_axes</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The axes for vmap</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>typing.Any: <em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">recursive_vmap</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">in_axes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform recursive vmap on the given axis</span>

<span class="sd">    Note:</span>
<span class="sd">        ```python</span>
<span class="sd">        def func(x):</span>
<span class="sd">            assert x.ndim == 1</span>
<span class="sd">            return x ** 2</span>
<span class="sd">        x = jnp.arange(10)</span>
<span class="sd">        x_test = jnp.broadcast_to(x, (2, 3, 4,) + x.shape)</span>
<span class="sd">        x_test.shape, recursive_vmap(func, (0,) * (x_test.ndim - 1))(x_test).shape</span>
<span class="sd">        ((2, 3, 4, 10), (2, 3, 4, 10))</span>
<span class="sd">        ```</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; def func(x):</span>
<span class="sd">        ...     assert x.ndim == 1</span>
<span class="sd">        ...     return x ** 2</span>
<span class="sd">        &gt;&gt;&gt; x = jnp.arange(10)</span>
<span class="sd">        &gt;&gt;&gt; x_test = jnp.broadcast_to(x, (2, 3, 4,) + x.shape)</span>
<span class="sd">        &gt;&gt;&gt; x_test.shape, recursive_vmap(func, (0,) * (x_test.ndim - 1))(x_test).shape</span>
<span class="sd">        ((2, 3, 4, 10), (2, 3, 4, 10))</span>

<span class="sd">    Args:</span>
<span class="sd">        func (typing.Any): The function for vmap</span>
<span class="sd">        in_axes (typing.Any): The axes for vmap</span>

<span class="sd">    Returns:</span>
<span class="sd">        typing.Any: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">in_axes</span><span class="p">:</span>
        <span class="c1"># Base case: no more axes to vectorize over</span>
        <span class="k">return</span> <span class="n">func</span>

    <span class="c1"># Apply vmap over the first axis specified in in_axes</span>
    <span class="n">vmap_func</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="n">in_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Recursively apply vmap over the remaining axes</span>
    <span class="k">return</span> <span class="n">recursive_vmap</span><span class="p">(</span><span class="n">vmap_func</span><span class="p">,</span> <span class="n">in_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.calculate_shots_expectation_value" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calculate_shots_expectation_value</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_shots_expectation_value</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">unitary</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">operator</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">shots</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate finite-shots estimate of expectation value</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_state</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Inital state</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unitary</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unitary operator</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plus_projector</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The eigenvector corresponded to +1 eigenvalue of Pauli observable.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shots</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of shot to be used in estimation of expectation value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: Finite-shot estimate expectation value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_shots_expectation_value</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">unitary</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">operator</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">shots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate finite-shots estimate of expectation value</span>

<span class="sd">    Args:</span>
<span class="sd">        key (jnp.ndarray): Random key</span>
<span class="sd">        initial_state (jnp.ndarray): Inital state</span>
<span class="sd">        unitary (jnp.ndarray): Unitary operator</span>
<span class="sd">        plus_projector (jnp.ndarray): The eigenvector corresponded to +1 eigenvalue of Pauli observable.</span>
<span class="sd">        shots (int): Number of shot to be used in estimation of expectation value</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Finite-shot estimate expectation value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">expval</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">unitary</span> <span class="o">@</span> <span class="n">initial_state</span> <span class="o">@</span> <span class="n">unitary</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">operator</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">expectation_value_to_prob_plus</span><span class="p">(</span><span class="n">expval</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">shots</span><span class="p">,),</span> <span class="n">p</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">prob</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">prob</span><span class="p">])</span>
    <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.utils.shot_quantum_device" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">shot_quantum_device</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">shot_quantum_device</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n"><span title="typing.Callable">Callable</span></span><span class="p">[[</span><span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">],</span>
    <span class="n">SHOTS</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">,</span>
    <span class="n">expectation_value_receipt</span><span class="p">:</span> <span class="n"><span title="typing.Sequence">Sequence</span></span><span class="p">[</span>
        <span class="n"><span title="inspeqtor.v1.data.ExpectationValue">ExpectationValue</span></span>
    <span class="p">]</span> <span class="o">=</span> <span class="n"><span title="inspeqtor.v1.constant.default_expectation_values_order">default_expectation_values_order</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This is the shot estimate expectation value quantum device</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>control_parameters</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The control parameter to be feed to simlulator</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="jax.numpy.ndarray">ndarray</span>], <span title="jax.numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ODE solver for propagator</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>SHOTS</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shots used to estimate expectation values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>jnp.ndarray: The expectation value of shape (control_parameters.shape[0], 18)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">shot_quantum_device</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">control_parameters</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">SHOTS</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">expectation_value_receipt</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span>
        <span class="n">ExpectationValue</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">default_expectation_values_order</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is the shot estimate expectation value quantum device</span>

<span class="sd">    Args:</span>
<span class="sd">        control_parameters (jnp.ndarray): The control parameter to be feed to simlulator</span>
<span class="sd">        key (jnp.ndarray): Random key</span>
<span class="sd">        solver (typing.Callable[[jnp.ndarray], jnp.ndarray]): The ODE solver for propagator</span>
<span class="sd">        SHOTS (int): The number of shots used to estimate expectation values</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: The expectation value of shape (control_parameters.shape[0], 18)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">expectation_values</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">control_parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">18</span><span class="p">))</span>
    <span class="n">unitaries</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">solver</span><span class="p">)(</span><span class="n">control_parameters</span><span class="p">)[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">expectation_value_receipt</span><span class="p">):</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">sample_key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">sample_keys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sample_key</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">unitaries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">expectation_value</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span>
            <span class="n">calculate_shots_expectation_value</span><span class="p">,</span>
            <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">)(</span>
            <span class="n">sample_keys</span><span class="p">,</span>
            <span class="n">exp</span><span class="o">.</span><span class="n">initial_density_matrix</span><span class="p">,</span>
            <span class="n">unitaries</span><span class="p">,</span>
            <span class="n">exp</span><span class="o">.</span><span class="n">observable_matrix</span><span class="p">,</span>
            <span class="n">SHOTS</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">expectation_values</span> <span class="o">=</span> <span class="n">expectation_values</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">expectation_value</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">expectation_values</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="visualization">Visualization</h2>


<div class="doc doc-object doc-module">



<h2 id="src.inspeqtor.v1.visualization" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">src.inspeqtor.v1.visualization</span>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.visualization.format_expectation_values" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">format_expectation_values</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">format_expectation_values</span><span class="p">(</span>
    <span class="n">expvals</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This function formats expectation values of shape (18, N) to a dictionary
with the initial state as outer key and the observable as inner key.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>expvals</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expectation values of shape (18, N). Assumes that order is as in default_expectation_values_order.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="jax.numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, dict[str, jnp.ndarray]]: A dictionary with the initial state as outer key and the observable as inner key.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/visualization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">format_expectation_values</span><span class="p">(</span>
    <span class="n">expvals</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function formats expectation values of shape (18, N) to a dictionary</span>
<span class="sd">    with the initial state as outer key and the observable as inner key.</span>

<span class="sd">    Args:</span>
<span class="sd">        expvals (jnp.ndarray): Expectation values of shape (18, N). Assumes that order is as in default_expectation_values_order.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, dict[str, jnp.ndarray]]: A dictionary with the initial state as outer key and the observable as inner key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">expvals_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">default_expectation_values_order</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">initial_state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">expvals_dict</span><span class="p">:</span>
            <span class="n">expvals_dict</span><span class="p">[</span><span class="n">exp</span><span class="o">.</span><span class="n">initial_state</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">expvals_dict</span><span class="p">[</span><span class="n">exp</span><span class="o">.</span><span class="n">initial_state</span><span class="p">][</span><span class="n">exp</span><span class="o">.</span><span class="n">observable</span><span class="p">]</span> <span class="o">=</span> <span class="n">expvals</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">expvals_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.visualization.plot_loss_with_moving_average" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">plot_loss_with_moving_average</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_loss_with_moving_average</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n"><span title="matplotlib.axes.Axes">Axes</span></span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">annotate_at</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="matplotlib.axes.Axes">Axes</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot the moving average of the given argument y</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The horizontal axis</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="jax.numpy.ndarray">ndarray</span> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vertical axis</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Axes object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The moving average window. Defaults to 50.</p>
              </div>
            </td>
            <td>
                  <code>50</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annotate_at</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of x positions to annotate the y value. Defaults to [2000, 4000, 6000, 8000, 10000].</p>
              </div>
            </td>
            <td>
                  <code>[0.2, 0.4, 0.6, 0.8, 1.0]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Axes</code></td>            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Axes object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/visualization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_loss_with_moving_average</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">annotate_at</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the moving average of the given argument y</span>

<span class="sd">    Args:</span>
<span class="sd">        x (jnp.ndarray | np.ndarray): The horizontal axis</span>
<span class="sd">        y (jnp.ndarray | np.ndarray): The vertical axis</span>
<span class="sd">        ax (Axes): Axes object</span>
<span class="sd">        window (int, optional): The moving average window. Defaults to 50.</span>
<span class="sd">        annotate_at (list[int], optional): The list of x positions to annotate the y value. Defaults to [2000, 4000, 6000, 8000, 10000].</span>

<span class="sd">    Returns:</span>
<span class="sd">        Axes: Axes object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">moving_average</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">moving_average</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">percentile</span> <span class="ow">in</span> <span class="n">annotate_at</span><span class="p">:</span>
        <span class="c1"># Calculate the data index that corresponds to the percentile</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">percentile</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">loss_value</span> <span class="o">=</span> <span class="n">moving_average</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="c1"># Skip annotation if the moving average value is not available (e.g., at the beginning)</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">loss_value</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">loss_value</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()),</span> <span class="nb">float</span><span class="p">(</span><span class="n">loss_value</span><span class="p">)),</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>  <span class="c1"># Offset the text for better readability</span>
            <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.visualization.assert_list_of_axes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">assert_list_of_axes</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">assert_list_of_axes</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="matplotlib.axes.Axes">Axes</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Assert the provide object that they are a list of Axes</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>axes</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expected to be numpy array of Axes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="matplotlib.axes.Axes">Axes</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[Axes]: The list of Axes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/visualization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">assert_list_of_axes</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Axes</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assert the provide object that they are a list of Axes</span>

<span class="sd">    Args:</span>
<span class="sd">        axes (typing.Any): Expected to be numpy array of Axes</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[Axes]: The list of Axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">Axes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axes</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.inspeqtor.v1.visualization.set_fontsize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">set_fontsize</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_fontsize</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n"><span title="matplotlib.axes.Axes">Axes</span></span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="n"><span title="int">int</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set all fontsize of the Axes object</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Axes object which fontsize to be changed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fontsize</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fontsize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/inspeqtor/v1/visualization.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_fontsize</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set all fontsize of the Axes object</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (Axes): The Axes object which fontsize to be changed.</span>
<span class="sd">        fontsize (float | int): The fontsize.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="p">]</span>
        <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span>
        <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()</span>
    <span class="p">):</span>
        <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="n">legend</span><span class="p">,</span> <span class="n">handles</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="n">handles</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>